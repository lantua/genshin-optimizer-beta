{"version":3,"sources":["ReactHooks/useWeapon.tsx","Components/Character/LocationName.tsx","Components/ToggleButton/WeaponToggle.tsx","Util/SortByFilters.ts","Components/SortByButton.tsx","Stat.tsx","Data/Characters/SheetUtil.tsx","PageArtifact/RollProbability.ts","PageArtifact/PercentBadge.tsx","Components/Weapon/WeaponSelectionModal.tsx","PageArtifact/ArtifactCard.tsx","ReactHooks/useArtifact.tsx","Components/Character/CharacterDropdownButton_WR.tsx","PageWeapon/WeaponCard.tsx","Util/CharacterSort.ts","PageWeapon/WeaponDisplayCard.tsx","Components/Character/CharacterSelectionModal.tsx","ReactHooks/useCharUIData.tsx","Components/SolidColoredToggleButton.tsx","Components/ToggleButton/ElementToggle.tsx","Components/FormulaCalcCard.tsx","PageCharacter/CharacterDisplay/CharacterArtifactPane.tsx","PageCharacter/CharacterDisplay/CharacterTeamBuffsPane.tsx","PageCharacter/CharacterDisplay/CharacterOverviewPane.tsx","PageCharacter/CharacterDisplay/CharacterTalentPane.tsx","PageCharacter/CharacterDisplayCard.tsx"],"names":["useWeapon","weaponID","database","useContext","DatabaseContext","useState","_getWeapon","weapon","setWeapon","useEffect","followWeapon","undefined","LocationName","location","t","useTranslation","characterSheet","usePromise","CharacterSheet","get","component","name","nameWIthIcon","sx","verticalAlign","WeaponToggle","value","onChange","props","cb","useCallback","e","newVal","exclusive","allWeaponTypeKeys","map","wt","src","Assets","weaponTypes","size","sortFunction","sortby","ascending","configs","Sort","a","b","config","aV","getValue","bV","localeCompare","filterOption","diff","tieBreaker","filterFunction","filterOptions","filterConfigs","obj","Object","entries","every","optionKey","optionVal","SortByButton","sortKeys","onChangeAsc","title","i18nKey","key","selected","disabled","onClick","startIcon","icon","faSortAmountDownAlt","faSortAmountUp","className","Stat","this","Error","printStat","statKey","stats","sgt","strKey","Translate","ns","key18","allWeights","fWeight","hp","atk","def","hp_","atk_","def_","eleMas","enerRech_","critRate_","critDMG_","pFillerSeq","populatePFillerSeq","prefix","prob","sumProb","current","length","i","layeredAssignment","cnr","Array","fill","_","n","result","r","push","pNExtra","last","next","forEach","x","array","accu","reduce","probability","artifact","_target","rarity","NaN","level","substats","target","required","Set","keys","numFillerSlots","mainStatKey","maxLevel","ArtifactMainStatsData","delete","has","numUpgradeRolls","Artifact","rollsRemaining","Math","max","ceil","maxSubstatValues","minTotalUpgrades","targetEntries","filler","minUpgrade","reverse","additionalUpgradeRolls","targetIndex","m","M","rolls","extra","pExtra","_remaining","remaining","parseInt","pRolls","pow","index","mainStat","mainStatRatio","pFillerRolls","numUnusedSubstats","pSuffixFillerSeq","ratio","requiredCount","total","crawlObject","path","currentCount","sum","calculatePFillerRolls","values","PercentBadge","valid","clamp","floor","toFixed","badgeColor","text","color","WeaponSelectionModal","show","onHide","onSelect","filter","propWeaponFilter","weaponFilter","weaponSheets","WeaponSheet","getAll","setWeaponfilter","weaponIdList","allWeaponKeys","wKey","weaponType","sort","open","onClose","py","container","item","flexGrow","spacing","weaponKey","weaponSheet","lg","md","height","display","img","width","px","variant","stars","colored","large","allSubstatFilter","allSubstats","ArtifactCard","artifactId","artifactObj","onEdit","onDelete","mainStatAssumptionLevel","effFilter","probabilityFilter","databaseArtifact","artifactID","_getArt","setArtifact","followArt","useArtifact","sheet","ArtifactSheet","setKey","editable","localDatabase","art","id","lock","slotKey","exclude","mainStatLevel","min","levelVariant","mainStatVal","valueStringWithUnit","mainStatValue","KeyMap","unit","getArtifactEfficiency","currentEfficiency","maxEfficiency","artifactValid","slotName","getSlotName","slotDesc","getSlotDesc","slotDescTooltip","BootstrapTooltip","placement","Typography","faInfoCircle","setEffects","setDescTooltip","setNumKey","SqBadge","setNum","setEffectDesc","fallback","Skeleton","minHeight","CardLight","flexDirection","CardContent","pt","pb","pr","Box","alignItems","Chip","label","pl","IconButton","updateArt","Lock","LockOpen","Grid","flexWrap","maxWidth","mt","mb","alignSelf","CardMedia","image","slotIcons","stat","numRolls","rollColor","efficiency","effOpacity","statName","mr","opacity","my","CardActions","xs","flexShrink","CharacterDropdownButton","inventory","charKey","setArtLocation","ButtonGroup","Button","faEdit","Tooltip","arrow","faBan","faChartLine","faTrashAlt","unSelectText","unSelectIcon","noUnselect","characterSheets","characterKeys","_getCharKeys","ck","DropdownButton","thumbImg","ThumbSide","thumbImgSide","BusinessCenter","Replay","MenuItem","ListItemIcon","noWrap","Divider","CharacterMenuItemArray","selectedCharacterKey","characterKey","WeaponCard","weaponId","canEquip","cs","weaponTypeKey","actionWrapperFunc","children","CardActionArea","equipOnChar","setWeaponLocation","UIData","useMemo","computeUIData","data","dataObjForWeapon","ascension","refinement","input","type","main","sub","sub2","imgAwaken","ConditionalWrapper","condition","wrapper","CardHeader","avatar","ImgIcon","fontSize","titleTypographyProps","action","updateWeapon","ascensionMaxLevel","alignContent","node","displayVal","valueString","StatIcon","characterSortKeys","characterSortConfigs","new","_getChar","characterFilterConfigs","element","elementKey","WeaponDisplayCard","propWeaponId","footer","DataContext","weaponDispatch","newWeapon","setLevel","findIndex","ascenML","setAscension","lowerAscension","ws","initialWeaponFilter","showModal","setshowModal","weaponUIData","k","bgcolor","palette","contentLight","startAdornment","inputProps","textAlign","ambiguousLevel","milestoneLevels","lv","as","lvlstr","SwapBtn","onChangeId","gap","minWidth","borderRadius","description","process","getLevelString","passiveName","gutterBottom","passiveDescription","refineIndex","isEmpty","document","sections","setShow","close","clickHandler","weapons","dbWeapon","sm","defaultSortKeys","CharacterSelectionModal","newFirst","sortBy","setsortBy","setascending","elementalFilter","setelementalFilter","setweaponFilter","sortConfigs","characterKeyList","allCharacterKeys","cKey","ModalWrapper","CardDark","ElementToggle","CloseButton","CharacterBtn","UIDataBundle","character","useCharacter","equippedWeapon","artifactSheetsData","getAllData","artifacts","objectMap","equippedArtifacts","useForceUpdate","dbDirty","setDbDirty","team","teammate1","teammate2","teammate3","followChar","dataWoArt","dataObjForCharacter","common","dataObjForArtifact","useCharUIData","lvl","asc","constellation","bonus","auto","skill","burst","SolidColoredToggleButton","styled","ToggleButton","shouldForwardProp","prop","theme","baseColor","selectedColor","backgroundColor","contrastText","dark","ToggleButtonGroup","allElements","ele","lineHeight","uncoloredEleIcons","FormulaCalcCard","expanded","setexpanded","toggle","ExpandButton","expand","ExpandMore","Collapse","in","timeout","unmountOnExit","CalculationDisplay","getDisplaySections","Nodes","FormulaCalc","displayNs","sectionKey","header","getDisplayHeader","Accordion","AccordionSummary","expandIcon","AccordionDetails","formulas","subform","CharacterArtifactPane","newBuild","oldData","history","useHistory","edit","artid","pathname","artToEditId","artifactSheets","followAnyArt","equipArts","window","confirm","fromEntries","allSlotKeys","s","equipArtifacts","unequipArts","objectKeyMap","artIds","artSetNums","artSet","StatDisplayComponent","Card","p","warning","setNumKeyArr","defIconSrc","SetEffectDisplay","CharacterTeamBuffsPane","TeamBuffDisplay","range","TeammateDisplay","statBreakpoint","teamBuffs","getTeamBuff","nodes","premod","enemy","columnSpacing","rowSpacing","oldValue","objPathValue","dataContext","active","teamData","activeCharacterDispatch","characterDispatch","activeCharacterKey","useCharacterReducer","onClickHandler","useCharSelectionCallback","dataBundle","teamMateDataContext","fullWidth","includes","PersonAdd","Provider","CharacterCard","onClickHeader","artifactChildren","CharArtifactCondDisplay","weaponChildren","CharWeaponCondDisplay","characterChildren","CharTalentCondDisplay","flatMap","se","d","DisplaySectionsTeamCond","talent","getTalent","charEle","sheets","sts","section","conditional","teamBuff","ConditionalDisplay","fieldContext","CharacterOverviewPane","tlvl","tBoost","cardImg","tKey","Badge","badgeContent","overlap","anchorOrigin","vertical","horizontal","padding","getTalentOfKey","constellationName","cursor","MainStatsCards","mainSubKeys","mainReadNodes","mainEditKeys","otherStatReadNodes","allElementsWithPhy","otherStatKeys","info","miscStatReadNodes","all_dmg_","normal_dmg_","normal_critRate_","charged_dmg_","charged_critRate_","plunging_dmg_","plunging_critRate_","skill_dmg_","skill_critRate_","burst_dmg_","burst_critRate_","transformativeReactions","amplifyingReactions","miscStatkeys","StatDisplayContent","rn","specialNode","special","StatDisplayCard","content","justifyContent","editContent","StatInput","placeholder","getStr","bonusStats","percent","onValueChange","defaultValue","setedit","faSave","CharacterTalentPane","ReactionDisplay","tText","SkillDisplayCard","talentKey","subtitle","enabled","style","onClickTitle","ReactionComponents","superconduct","electro","cryo","electrocharged","hydro","overloaded","pyro","pyroSwirl","swirlEleToDisplay","setele","getDisplay","reaction","shattered","information","faQuestionCircle","Ele","anemo","geo","talentLimits","actionWrapeprFunc","levelBoost","newTalentLevelKey","talentSheet","DocumentDisplay","TabPanel","other","role","hidden","CharacterDisplayCard","newteamData","tabName","isFlex","useTeamData","charUIData","tab","settab","onTab","v","compareData","dataContextValue","CharSelectDropdown","SolidToggleButtonGroup","Tabs","Tab","setCharacter","contentDark","talents","eleKey","CustomNumberInput"],"mappings":"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","file":"static/js/15.4d702ba0.chunk.js","sourcesContent":["import { useContext, useEffect, useState } from \"react\";\nimport { DatabaseContext } from \"../Database/Database\";\n\nexport default function useWeapon(weaponID: string | undefined = \"\") {\n  const database = useContext(DatabaseContext)\n  const [weapon, setWeapon] = useState(database._getWeapon(weaponID))\n  useEffect(() => setWeapon(database._getWeapon(weaponID)), [database, weaponID])\n  useEffect(() =>\n    weaponID ? database.followWeapon(weaponID, setWeapon) : undefined,\n    [weaponID, setWeapon, database])\n  return weapon\n}","import { BusinessCenter } from \"@mui/icons-material\";\nimport { Typography } from \"@mui/material\";\nimport { useTranslation } from \"react-i18next\";\nimport CharacterSheet from \"../../Data/Characters/CharacterSheet\";\nimport usePromise from \"../../ReactHooks/usePromise\";\n\nexport default function LocationName({ location }) {\n  const { t } = useTranslation(\"ui\");\n  const characterSheet = usePromise(CharacterSheet.get(location ?? \"\"), [location])\n  return <Typography component=\"span\">\n    {characterSheet?.name ? characterSheet.nameWIthIcon : <span><BusinessCenter sx={{ verticalAlign: \"text-bottom\" }} /> {t`inventory`}</span>}\n  </Typography>\n\n}\n","import { ToggleButton } from \"@mui/material\";\nimport { useCallback } from \"react\";\nimport Assets from \"../../Assets/Assets\";\nimport { allWeaponTypeKeys, WeaponTypeKey } from \"../../Types/consts\";\nimport ImgIcon from \"../Image/ImgIcon\";\nimport SolidToggleButtonGroup, { SolidToggleButtonGroupProps } from \"../SolidToggleButtonGroup\";\ntype WeaponToggleProps = Omit<SolidToggleButtonGroupProps, \"onChange\" | \"value\"> & {\n  onChange: (value: WeaponTypeKey | \"\") => void\n  value: WeaponTypeKey | \"\"\n}\nexport default function WeaponToggle({ value, onChange, ...props }: WeaponToggleProps) {\n  const cb = useCallback((e, newVal) => onChange(newVal || \"\"), [onChange])\n  return <SolidToggleButtonGroup exclusive onChange={cb} value={value || allWeaponTypeKeys} {...props}>\n    {allWeaponTypeKeys.map(wt => <ToggleButton key={wt} value={wt}>\n      <ImgIcon src={Assets.weaponTypes?.[wt]} size={2} />\n    </ToggleButton>)}\n  </SolidToggleButtonGroup>\n}","type SortConfig<T> = {\n  getValue: (id: T) => number | string\n  tieBreaker?: string\n}\nexport type SortConfigs<Keys extends string, T> = Record<Keys, SortConfig<T>>\n\nexport function sortFunction<Keys extends string, T>(sortby: string, ascending: boolean, configs: SortConfigs<Keys, T>) {\n  function Sort(a: T, b: T, ascending: boolean, config: SortConfig<T>) {\n    const aV = config.getValue(a)\n    const bV = config.getValue(b)\n    let diff = 0\n    if (typeof aV === \"string\" && typeof bV === \"string\")\n      diff = aV.localeCompare(bV)\n    else\n      diff = ((bV as number) - (aV as number))\n    return (ascending ? -1 : 1) * diff\n  }\n  return (a: T, b: T) => {\n    if (!configs[sortby]) return 0\n    const filterOption = configs[sortby]\n    let diff = Sort(a, b, ascending, filterOption)\n    if (!diff && filterOption.tieBreaker && configs[filterOption.tieBreaker])\n      diff = Sort(a, b, ascending, configs[filterOption.tieBreaker])\n    return diff\n  }\n}\n\ntype FilterConfig<T> = (obj: T, filter: any) => boolean\nexport type FilterConfigs<Keys extends string, T> = Record<Keys, FilterConfig<T>>\nexport function filterFunction<Keys extends string, T>(filterOptions: Record<Keys, any>, filterConfigs: FilterConfigs<Keys, T>) {\n  return (obj: T) => Object.entries(filterOptions).every(([optionKey, optionVal]) => filterConfigs[optionKey as any](obj, optionVal))\n}","import { faSortAmountDownAlt, faSortAmountUp } from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { Button, ButtonGroup, ButtonGroupProps, MenuItem } from \"@mui/material\";\nimport { Trans, useTranslation } from \"react-i18next\";\nimport DropdownButton from \"./DropdownMenu/DropdownButton\";\n\ntype SortByButtonProps = ButtonGroupProps & {\n  sortKeys: string[]\n  value: string\n  onChange: (value: string) => void\n  ascending: boolean\n  onChangeAsc: (value: boolean) => void\n}\n// Assumes that all the sortKeys has corresponding translations in ui.json sortMap\nexport default function SortByButton({ sortKeys, value, onChange, ascending, onChangeAsc, ...props }: SortByButtonProps) {\n  const { t } = useTranslation(\"ui\")\n  return <ButtonGroup {...props} >\n    <DropdownButton title={<Trans t={t} i18nKey=\"sortByFormat\" value={t(`sortMap.${value}`) as any}>Sort By: {{ value: t(`sortMap.${value}`) }}</Trans>}>\n      {sortKeys.map(key =>\n        <MenuItem key={key} selected={value === key} disabled={value === key} onClick={() => onChange(key)}>{t(`sortMap.${key}`) as any}</MenuItem>)}\n    </DropdownButton>\n    <Button onClick={() => onChangeAsc(!ascending)} startIcon={<FontAwesomeIcon icon={ascending ? faSortAmountDownAlt : faSortAmountUp} className=\"fa-fw\" />}>\n      {ascending ? <Trans t={t} i18nKey=\"ascending\" >Ascending</Trans> : <Trans t={t} i18nKey=\"descending\" >Descending</Trans>}\n    </Button>\n  </ButtonGroup>\n}","/**\n * @deprecated\n */\nexport default class Stat {\n  //do not instantiate.\n  constructor() {\n    if (this instanceof Stat)\n      throw Error('A static class cannot be instantiated.');\n  }\n  static printStat = (statKey, stats, premod = false) => <></>\n}\n","import Assets from \"../../Assets/Assets\";\nimport { getTalentStatKey, getTalentStatKeyVariant } from \"../../PageBuild/Build\";\nimport ImgIcon from \"../../Components/Image/ImgIcon\";\nimport SqBadge from \"../../Components/SqBadge\";\nimport { Translate } from \"../../Components/Translate\";\nimport Stat from \"../../Stat\";\nimport { DocumentSection, TalentSheetElement, TalentSheetElementKey } from \"../../Types/character\";\nimport { ElementKey, WeaponTypeKey } from \"../../Types/consts\";\nimport IConditional from \"../../Types/IConditional\";\nexport const st = (strKey: string) => <Translate ns=\"sheet\" key18={strKey} />\nexport const sgt = (strKey: string) => <Translate ns=\"sheet_gen\" key18={strKey} />\n\n//this template only works if there is no variation in normal attacks.(no multi hits)\n/**\n * @deprecated\n */\nexport const normalDocSection = (tr, formula, data) => ({\n  text: tr(`auto.fields.normal`),\n  fields: data.normal.hitArr.map((percentArr, i) =>\n  ({\n    text: sgt(`normal.hit${i + 1}`),\n    formulaText: stats => <span>{percentArr[stats.tlvl.auto]}% {Stat.printStat(getTalentStatKey(\"normal\", stats), stats)}</span>,\n    formula: formula.normal[i],\n    variant: stats => getTalentStatKeyVariant(\"normal\", stats),\n  }))\n})\n/**\n * @deprecated\n */\nexport const chargedDocSection = (tr, formula, data, stamina = 25): DocumentSection => ({\n  text: tr(`auto.fields.charged`),\n  fields: [{\n    text: sgt(`charged.dmg`),\n    formulaText: stats => <span>{data.charged.dmg[stats.tlvl.auto]}% {Stat.printStat(getTalentStatKey(\"charged\", stats), stats)}</span>,\n    formula: formula.charged.dmg,\n    variant: stats => getTalentStatKeyVariant(\"charged\", stats),\n  }, {\n    text: sgt(\"charged.stamina\"),\n    value: stamina,\n  }]\n})\n/**\n * @deprecated\n */\nexport const chargedHitsDocSection = (tr, formula, data, stamina = 20): DocumentSection => ({\n  text: tr(`auto.fields.charged`),\n  fields: [...data.charged.hitArr.map((percentArr, i) =>\n  ({\n    text: sgt(`normal.hit${i + 1}`),\n    formulaText: stats => <span>{percentArr[stats.tlvl.auto]}% {Stat.printStat(getTalentStatKey(\"charged\", stats), stats)}</span>,\n    formula: formula.charged[i],\n    variant: stats => getTalentStatKeyVariant(\"charged\", stats),\n  })), {\n    text: sgt(\"charged.stamina\"),\n    value: stamina\n  }]\n})\n/**\n * @deprecated\n */\nexport const plungeDocSection = (tr, formula, data): DocumentSection => ({\n  text: tr`auto.fields.plunging`,\n  fields: [{\n    text: sgt(`plunging.dmg`),\n    formulaText: stats => <span>{data.plunging.dmg[stats.tlvl.auto]}% {Stat.printStat(getTalentStatKey(\"plunging\", stats), stats)}</span>,\n    formula: formula.plunging.dmg,\n    variant: stats => getTalentStatKeyVariant(\"plunging\", stats),\n  }, {\n    text: sgt(\"plunging.low\"),\n    formulaText: stats => <span>{data.plunging.low[stats.tlvl.auto]}% {Stat.printStat(getTalentStatKey(\"plunging\", stats), stats)}</span>,\n    formula: formula.plunging.low,\n    variant: stats => getTalentStatKeyVariant(\"plunging\", stats),\n  }, {\n    text: sgt(\"plunging.high\"),\n    formulaText: stats => <span>{data.plunging.high[stats.tlvl.auto]}% {Stat.printStat(getTalentStatKey(\"plunging\", stats), stats)}</span>,\n    formula: formula.plunging.high,\n    variant: stats => getTalentStatKeyVariant(\"plunging\", stats),\n  }]\n})\n/**\n * @deprecated\n */\nexport const claymoreChargedDocSection = (tr, formula, data): DocumentSection => ({\n  text: tr(\"auto.fields.charged\"),\n  fields: [{\n    text: sgt(\"charged.spinning\"),\n    formulaText: stats => <span>{data.charged.spinning[stats.tlvl.auto]}% {Stat.printStat(getTalentStatKey(\"charged\", stats), stats)}</span>,\n    formula: formula.charged.spinning,\n    variant: stats => getTalentStatKeyVariant(\"charged\", stats),\n  }, {\n    text: sgt(\"charged.final\"),\n    formulaText: stats => <span>{data.charged.final[stats.tlvl.auto]}% {Stat.printStat(getTalentStatKey(\"charged\", stats), stats)}</span>,\n    formula: formula.charged.final,\n    variant: stats => getTalentStatKeyVariant(\"charged\", stats),\n  }, {\n    text: sgt(\"charged.stamina\"),\n    value: data.charged.stam ?? 40,\n    unit: \"/s\"\n  }, {\n    text: sgt(\"maxDuration\"),\n    value: data.charged.maxDuration ?? 5,\n    unit: \"s\"\n  }]\n})\n/**\n * @deprecated\n */\nexport const bowChargedDocSection = (tr, formula, data, elementKey: ElementKey): DocumentSection => ({\n  text: tr(\"auto.fields.charged\"),\n  fields: [{\n    text: sgt(\"charged.aimed\"),\n    formulaText: stats => <span>{data.charged.hit[stats.tlvl.auto]}% {Stat.printStat(getTalentStatKey(\"charged\", stats), stats)}</span>,\n    formula: formula.charged.hit,\n    variant: stats => getTalentStatKeyVariant(\"charged\", stats),\n  }, {\n    text: sgt(\"charged.fullyAimed\"),\n    formulaText: stats => <span>{data.charged.full[stats.tlvl.auto]}% {Stat.printStat(getTalentStatKey(\"charged\", stats, elementKey), stats)}</span>,\n    formula: formula.charged.full,\n    variant: stats => getTalentStatKeyVariant(\"charged\", stats, elementKey),\n  }]\n})\ntype BoostKey = \"autoBoost\" | \"skillBoost\" | \"burstBoost\"\n/**\n * @deprecated\n */\nexport const talentTemplate = (talentKey: TalentSheetElementKey, tr: (string) => Displayable, img: string, boostKey?: BoostKey, boostAmt: number = 3): TalentSheetElement => ({\n  name: tr(`${talentKey}.name`),\n  img,\n  sections: [{\n    text: tr(`${talentKey}.description`),\n    ...(boostKey ? {\n      conditional: {\n        key: boostKey,\n        canShow: stats => stats.constellation >= parseInt(talentKey.split(\"constellation\")[1] ?? 3),\n        maxStack: 0,\n        stats: {\n          [boostKey]: boostAmt\n        }\n      } as IConditional\n    } : {})\n  }],\n})\n\nconst talentStrMap: Record<TalentSheetElementKey, string> = {\n  auto: \"Auto\",\n  skill: \"Skill\",\n  burst: \"Burst\",\n  passive: \"Passive\",\n  passive1: \"Ascension 1\",\n  passive2: \"Ascension 4\",\n  passive3: \"Passive\",\n  sprint: \"Sprint\",\n  constellation1: \"C1\",\n  constellation2: \"C2\",\n  constellation3: \"C3\",\n  constellation4: \"C4\",\n  constellation5: \"C5\",\n  constellation6: \"C6\"\n}\n/**\n * @deprecated\n */\nexport const conditionalHeader = (talentKey: TalentSheetElementKey, tr: (string) => Displayable, img: string): IConditional[\"header\"] => {\n  return {\n    title: tr(`${talentKey}.name`),\n    icon: <ImgIcon size={2} sx={{ m: -1 }} src={img} />,\n    action: <SqBadge color=\"success\">{talentStrMap[talentKey]}</SqBadge>,\n  }\n}\n/**\n * @deprecated\n */\nexport const normalSrc = (weaponKey: WeaponTypeKey) => Assets.weaponTypes[weaponKey]\n","import { IArtifact, ISubstat, MainStatKey, SubstatKey } from '../Types/artifact'\nimport { crawlObject, layeredAssignment } from '../Util/Util'\nimport Artifact from '../Data/Artifacts/Artifact'\nimport ArtifactMainStatsData from '../Data/Artifacts/artifact_main_gen.json'\n\n// We separate rolls into \"filler rolls\" that occurs when there are less than 4 substats,\n// and \"upgrade rolls\" that occurs when all 4 substats are added. They have different\n// probability distribution and require separate consideration.\n\n// Notations for the remainder of this file.\n//\n// i, j, k := substat\n// E(i) := Extra substat that rolls into substat i\n// T(i) := Targetted (extra) substat for substat i\n// Nf(i) := # of filler roll into substat i (0 <= Nfi <= 1)\n// Nu(i) := # of upgrade rolls into substat i\n//\n// E := { E1, E2, ... }\n// T := { T1, T2, ... }\n// N(i) := Nf(i) + Nu(i)\n// Nf := Nf(1) + Nf(2) + ...\n// Nu := Nu(1) + Nu(2) + ...\n//\n// For example, if the artifact has 14 atk, and the target atk is 30,\n// in a scenario where we roll 2 rolls of 16 and 18 into atk, then\n//\n// i = atk, E(atk) = 16 + 18, T(atk) = 30 - 14, Nf(atk) = 0 roll, Nu(atk) = 2 rolls\n\nconst allWeights = [3, 4, 6] as const\ntype Weight = typeof allWeights[number]\n\n/**\n * Weight used when rolling a filler roll. Each roll will choose from available\n * substats (excluding main stat and existing substats) with these weights.\n */\nconst fWeight: StrictDict<SubstatKey, Weight> = {\n  hp: 6, atk: 6, def: 6,\n  hp_: 4, atk_: 4, def_: 4, eleMas: 4, enerRech_: 4,\n  critRate_: 3, critDMG_: 3\n}\n\n/**\n * Probability of observing a filler sequence with particular weights\n *\n * pFillerSeq[w0][w1][w2][...] = Pr [ fWeight[main stat] = w0, fWeight[substat1] = w1, fWeight[substat2] = w2, ... ]\n */\nconst pFillerSeq: Dict<0 | Weight, Dict<Weight, Dict<Weight, Dict<Weight, Dict<Weight, number>>>>> = {}\nfunction populatePFillerSeq(prefix: (0 | Weight)[], prob: { [key in Weight]: number }, sumProb: number, current: number) {\n  if (prefix.length === 5) {\n    layeredAssignment(pFillerSeq, prefix as any, current)\n    return\n  }\n\n  for (const i of allWeights)\n    if (prob[i] > 0)\n      populatePFillerSeq([...prefix, i], { ...prob, [i]: prob[i] - i }, sumProb - i, current * prob[i] / sumProb)\n}\npopulatePFillerSeq([0], { 3: 6, 4: 20, 6: 18 }, 44, 1)\n\npopulatePFillerSeq([3], { 3: 3, 4: 20, 6: 18 }, 41, 1)\npopulatePFillerSeq([4], { 3: 6, 4: 16, 6: 18 }, 40, 1)\npopulatePFillerSeq([6], { 3: 6, 4: 20, 6: 12 }, 38, 1)\n\n/**\n * cnr[n][r] = C(n, r) = n! / (r!(n-r)!)\n *\n * 0 <= n <= 5; 0 <= r <= n\n */\nconst cnr = Array(6).fill(0).map((_, n) => {\n  const result = [1]\n  let r = 0, value = 1\n  while (++r <= n) {\n    value *= n - r + 1\n    value /= r\n    result.push(value)\n  }\n\n  return result\n})\n\n/**\n * pNExtra[n][i] = Pr[ E(k) >= (i - 7n) * alpha(i) | N(k) = n ]\n *               = Pr[ (E(k) / alpha(k)) - 7n >= i | N(k) = n ]\n *\n * 0 <= n <= 5; 0 <= i < 3*n + 1\n */\nconst pNExtra = [[1]]\nwhile (pNExtra.length < 6) {\n  const last = pNExtra[pNExtra.length - 1]\n  const next = Array(last.length + 3).fill(0)\n  last.forEach((value, i) => {\n    for (const j of [0, 1, 2, 3]) {\n      next[i + j] += value\n    }\n  })\n\n  pNExtra.push(next.map(x => x / 4))\n}\nfor (const array of pNExtra) {\n  let accu = array.reduce((a, b) => a + b)\n  array.forEach((x, i, array) => {\n    array[i] = accu\n    accu -= x\n  })\n}\n\n/** Probability that `artifact` will have at least `target` stats at max level */\nfunction probability(artifact: IArtifact, _target: { [key in SubstatKey]?: number }): number {\n  if (artifact.rarity <= 2) return NaN // Doesn't work with 1* and 2* should we decide to add them\n\n  const { rarity, level, substats } = artifact\n\n  // `target = target - mainstat - substat` to find the extra substats we need\n  // Also count filler rolls (4 - # of substats) while we're at it\n  const target = { ..._target }, required = new Set(Object.keys(target))\n  let numFillerSlots = 0\n  {\n    const key = artifact.mainStatKey\n    if (key in target) {\n      const maxLevel = rarity * 4 // Note: this formula doesn't work with 1* and 2* artifacts\n      const maxLevelMainStat = ArtifactMainStatsData[rarity][key][maxLevel]\n      if (maxLevelMainStat < target[key]!) return 0 // Main stat won't meet the target\n\n      delete target[key]\n      required.delete(key as SubstatKey)\n    }\n  }\n  for (const { key, value } of substats) {\n    if (key) {\n      if (required.has(key)) {\n        required.delete(key)\n        if (target[key]! > value)\n          target[key]! -= value\n        else delete target[key] // Requirement already met\n      }\n    } else numFillerSlots += 1\n  }\n  numFillerSlots += 4 - substats.length\n\n  if (required.size > numFillerSlots || Object.keys(target).length > 4) return 0 // Not enough filler rolls\n\n  const numUpgradeRolls = Artifact.rollsRemaining(level, rarity) - numFillerSlots\n\n  // normalize `target`\n  for (const [key, value] of Object.entries(target))\n    target[key] = Math.max(Math.ceil(10 * value / Artifact.maxSubstatValues(key, rarity)), 1)\n\n  let minTotalUpgrades = 0\n  const targetEntries = Object.entries(target).map(([key, target]) => {\n    const filler = required.has(key) ? 1 : 0 // Nf(i)\n    const minUpgrade = Math.ceil(target / 10) - filler // Minimum # of upgrade rolls to ensure E(i) > T(i)\n    minTotalUpgrades += minUpgrade\n    return { target, filler, minUpgrade }\n  }).reverse()\n\n  if (minTotalUpgrades > numUpgradeRolls) return 0 // Not enough upgrade rolls\n\n  /**\n   * The optimization trick here is to write Pr[ E > T | N ] using a recursive relation. Let\n   *\n   *  f(n, t) = Pr[ E(i) >= t | N(i) = n ]\n   *  g(k, n) = Pr[ E(1) >= T(1), E(2) >= T(2), ..., E(k) >= T(k) | Nu - Nu(1) - Nu(2) - ... - Nu(k) = n ]\n   *  h(n, m, M) = Pr[ Nu(k) = m | 0 <= Nu(k) <= n, |K| = M ]\n   *\n   * Then\n   *\n   *  Pr [ E > T | N ] = Pr[ Nf(k) = I(k requires filler) for all k | N ] sum{0 <= n <= Nu} g(|K|, n)\n   *\n   * where I(X) is the indicator function, and |K| is the number of substat constraints, and\n   *\n   *  f(n, e * alpha(i)) = pNExtra[n][ e - 7n ]\n   *  h(n, m, M) = C(n, m) (M-1)^(n - m) M^(-n) = pRollInto(n, m, M)\n   *  g(0, N) = 1\n   *  g(0, n) = 0 for n != N\n   *\n   *  g(k + 1, n) = sum{0 <= m <= n} g(k, n + m) f(m + Nf(k), T(k)) h(n + m, m, |K| - k)\n   */\n\n  // At this point,\n  //  `target` = ceil(T / alpha)\n  //  `numUpgradeRolls` = Nu\n\n  let result = { [numUpgradeRolls]: 1 }, additionalUpgradeRolls = numUpgradeRolls - minTotalUpgrades\n\n  // Keep applying `target` from first to last.\n  // At each step i in the loop, `result[n]` = g(i, n)\n  targetEntries.forEach(({ target, filler, minUpgrade }, targetIndex) => {\n    const next: typeof result = {}\n\n    for (let rolls = minUpgrade; rolls <= minUpgrade + additionalUpgradeRolls; rolls++) {\n      // rolls = m; extra = T(i) / alpha - 7n\n\n      // Extra substat (mutiple of alpha) required from upgrade & filler rolls\n      const extra = target - 7 * (rolls + filler)\n      // pExtra = Pr[ Has at least `extra` * alpha from `rolls` upgrade or filler rolls into `key` ]\n      //        = f(m + Nf(i), T(i))\n      const pExtra = (extra > 0 ? pNExtra[rolls + filler][extra] : 1)\n\n      for (const [_remaining, probability] of Object.entries(result)) {\n        const remaining = parseInt(_remaining)\n        if (remaining < rolls) continue\n\n        // n := remaining - m\n        // remaining = n + m\n        // probability = g(i, n + m)\n\n        // `pRolls` = Pr[ Has `rolls` rolls into `key` from `remaining` upgrade rolls ]\n        //          = h(n + m, m, |K| - i)\n        const pRolls = pRollInto(remaining, rolls, 4 - targetIndex)\n        const index = remaining - rolls // n\n\n        // g(i + 1, n) += g(i, n + m) f(m + Nf(i), T(i)) h(n + m, m, |K| - i)\n        next[index] = (next[index] ?? 0) + probability * pExtra * pRolls\n      }\n    }\n    result = next\n  })\n\n  // At this point, `result[i]` = g(|K|, i)\n\n  return calculatePFillerRolls(artifact.mainStatKey, substats, required) * Object.values(result).reduce((a, b) => a + b)\n}\n\n/**\n * Pr[ N(k) = n | N = m, |K| = M ]\n *\n * 0 <= n <= N <= 5; 0 <= M <= 4\n */\nfunction pRollInto(m: number, n: number, M: number) {\n  return cnr[m][n] * Math.pow(M - 1, m - n) / Math.pow(M, m)\n}\n\n// Given a list of substat (in that order), calculate the probability that filler rolls will have all `required` substats in any order\nfunction calculatePFillerRolls(mainStat: MainStatKey, substats: ISubstat[], required: Set<SubstatKey>) {\n  // Instead of picking substats in a particular order [critDMG_, atk_, ...],\n  // We pick substat weights first [3, 4, 3, ...], then assign proper substats\n  // that corresponds to that weight: 3 => critDMG_ | critRate_ ; 4 => atk_, etc.\n  // This reduces the search space significantly (5040 substat sequences => 71 weight sequences).\n\n  const mainStatRatio = fWeight[mainStat] ?? 0\n  let pFillerRolls = 0 // Pr[ filler rolls include all `required` substats, Substats are in the same order as `substats` ]\n\n  const numUnusedSubstats = { 3: 2, 4: 5, 6: 3 } // # of substat not used by main stat or substats\n  let pSuffixFillerSeq: any = pFillerSeq[mainStatRatio] // Suffix of `pFillerSeq` that excludes the `substats` portion\n  for (const { key } of substats) {\n    if (key) {\n      const ratio = fWeight[key]\n      pSuffixFillerSeq = pSuffixFillerSeq[ratio]\n      numUnusedSubstats[ratio] -= 1\n    }\n  }\n  if (mainStatRatio) numUnusedSubstats[mainStatRatio] -= 1\n\n  const requiredCount = { 3: 0, 4: 0, 6: 0 }\n  for (const key of required) requiredCount[fWeight[key]] += 1\n\n  let total = 0\n  crawlObject(pSuffixFillerSeq, [], obj => typeof obj === \"number\", (prob: number, path: string[]) => {\n    total += prob\n    const currentCount = { 3: 0, 4: 0, 6: 0 }\n    for (const key of path) currentCount[key] += 1\n\n    let sum = prob\n    for (const i of allWeights) {\n      const current = currentCount[i], required = requiredCount[i]\n      if (current < required) return\n      sum *= cnr[current][required]\n    }\n\n    pFillerRolls += sum\n  })\n\n  for (const i of allWeights)\n    pFillerRolls /= cnr[numUnusedSubstats[i]][requiredCount[i]]\n  return pFillerRolls / total\n}\n\nexport { probability }\n","import SqBadge from '../Components/SqBadge';\nimport { clamp } from '../Util/Util';\n\nexport default function PercentBadge({ value, valid }: Data) {\n  let [badgeColor, text] = typeof value === 'number' ?\n    [`roll${clamp(Math.floor(value * 0.05) + 1, 1, 6)}`, value.toFixed(2) + \"%\"] : [\"secondary\", value]\n  if (!valid) badgeColor = \"error\"\n  return <SqBadge color={badgeColor} >{text}</SqBadge>\n}\n\ntype Data = {\n  valid: boolean,\n  value: number | string,\n}\n","import { Box, CardActionArea, CardContent, Divider, Grid, Typography } from \"@mui/material\"\nimport { useEffect, useState } from \"react\"\nimport Assets from \"../../Assets/Assets\"\nimport usePromise from \"../../ReactHooks/usePromise\"\nimport { allWeaponKeys, WeaponKey, WeaponTypeKey } from \"../../Types/consts\"\nimport WeaponSheet from \"../../Data/Weapons/WeaponSheet\"\nimport CardDark from \"../Card/CardDark\"\nimport CardLight from \"../Card/CardLight\"\nimport CloseButton from \"../CloseButton\"\nimport ImgIcon from \"../Image/ImgIcon\"\nimport ModalWrapper from \"../ModalWrapper\"\nimport { Stars } from \"../StarDisplay\"\nimport WeaponToggle from \"../ToggleButton/WeaponToggle\"\n\ntype WeaponSelectionModalProps = {\n  show: boolean,\n  onHide: () => void,\n  onSelect: (wKey: WeaponKey) => void,\n  filter?: (sheet: WeaponSheet) => boolean,\n  weaponFilter?: WeaponTypeKey,\n}\n\nexport default function WeaponSelectionModal({ show, onHide, onSelect, filter = () => true, weaponFilter: propWeaponFilter }: WeaponSelectionModalProps) {\n  const weaponSheets = usePromise(WeaponSheet.getAll, [])\n  const [weaponFilter, setWeaponfilter] = useState<WeaponTypeKey | \"\">(propWeaponFilter ?? \"\")\n\n  useEffect(() => propWeaponFilter && setWeaponfilter(propWeaponFilter), [propWeaponFilter])\n\n  const weaponIdList = !weaponSheets ? [] : [...new Set(allWeaponKeys)].filter(wKey => filter(weaponSheets[wKey]))\n    .filter(wKey => {\n      if (weaponFilter && weaponFilter !== weaponSheets?.[wKey]?.weaponType) return false\n      return true\n    })\n    .sort((a, b) => (weaponSheets?.[b]?.rarity ?? 0) - (weaponSheets?.[a]?.rarity ?? 0))\n\n  if (!weaponSheets) return null\n\n  return <ModalWrapper open={show} onClose={onHide}>\n    <CardDark>\n      <CardContent sx={{ py: 1 }}>\n        <Grid container>\n          <Grid item flexGrow={1}>\n            <WeaponToggle value={weaponFilter} onChange={setWeaponfilter} disabled={!!propWeaponFilter} size=\"small\" />\n          </Grid >\n          <Grid item>\n            <CloseButton onClick={onHide} />\n          </Grid >\n        </Grid>\n      </CardContent>\n      <Divider />\n      <CardContent><Grid container spacing={1}>\n        {weaponIdList.map(weaponKey => {\n          const weaponSheet = weaponSheets[weaponKey]\n          return <Grid item key={weaponKey} lg={3} md={4}>\n            <CardLight sx={{ height: \"100%\" }} >\n              <CardActionArea onClick={() => { onHide(); onSelect(weaponKey) }} sx={{ display: \"flex\" }}>\n                <Box component=\"img\" src={weaponSheet.img} sx={{ width: 100, height: \"auto\" }} className={` grad-${weaponSheet.rarity}star`} />\n                <Box sx={{ flexGrow: 1, px: 1 }}>\n                  <Typography variant=\"subtitle1\">{weaponSheet.name}</Typography>\n                  <Typography><ImgIcon src={Assets.weaponTypes?.[weaponSheet.weaponType]} /> <Stars stars={weaponSheet.rarity} colored /></Typography>\n                </Box>\n              </CardActionArea>\n            </CardLight>\n          </Grid>\n        })}\n      </Grid></CardContent>\n      <Divider />\n      <CardContent sx={{ py: 1 }}>\n        <CloseButton large onClick={onHide} />\n      </CardContent>\n    </CardDark>\n  </ModalWrapper>\n}\n","import { faBan, faChartLine, faEdit, faInfoCircle, faTrashAlt } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { Lock, LockOpen } from '@mui/icons-material';\nimport { Box, Button, ButtonGroup, CardActions, CardContent, CardMedia, Chip, Grid, IconButton, Skeleton, Tooltip, Typography } from '@mui/material';\nimport React, { Suspense, useContext } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport BootstrapTooltip from '../Components/BootstrapTooltip';\nimport CardLight from '../Components/Card/CardLight';\nimport CharacterDropdownButton from '../Components/Character/CharacterDropdownButton';\nimport LocationName from '../Components/Character/LocationName';\nimport ColorText from '../Components/ColoredText';\nimport SqBadge from '../Components/SqBadge';\nimport { Stars } from '../Components/StarDisplay';\nimport { database as localDatabase, DatabaseContext } from '../Database/Database';\nimport useArtifact from '../ReactHooks/useArtifact';\nimport usePromise from '../ReactHooks/usePromise';\nimport { allSubstats, ICachedArtifact, ICachedSubstat, SubstatKey } from '../Types/artifact';\nimport { CharacterKey } from '../Types/consts';\nimport { valueStringWithUnit } from '../Util/UIUtil';\nimport { clamp } from '../Util/Util';\nimport Artifact from '../Data/Artifacts/Artifact';\nimport { ArtifactSheet } from '../Data/Artifacts/ArtifactSheet';\nimport SlotNameWithIcon from '../Components/Artifact/SlotNameWIthIcon';\nimport PercentBadge from './PercentBadge';\nimport { probability } from './RollProbability';\nimport KeyMap from '../KeyMap';\n\ntype Data = {\n  artifactId?: string,\n  artifactObj?: ICachedArtifact,\n  onEdit?: (string) => void,\n  onDelete?: (string) => void, mainStatAssumptionLevel?: number,\n  effFilter?: Set<SubstatKey>,\n  probabilityFilter?: Dict<SubstatKey, number>\n}\nconst allSubstatFilter = new Set(allSubstats)\n\nexport default function ArtifactCard({ artifactId, artifactObj, onEdit, onDelete, mainStatAssumptionLevel = 0, effFilter = allSubstatFilter, probabilityFilter }: Data): JSX.Element | null {\n  const { t } = useTranslation([\"artifact\"]);\n  const database = useContext(DatabaseContext)\n  const databaseArtifact = useArtifact(artifactId)\n  const sheet = usePromise(ArtifactSheet.get((artifactObj ?? databaseArtifact)?.setKey), [artifactObj, databaseArtifact])\n  const equipOnChar = (charKey: CharacterKey | \"\") => database.setArtLocation(artifactId!, charKey)\n\n  const editable = !artifactObj && database === localDatabase // dont allow edit for flex artifacts\n  const art = artifactObj ?? databaseArtifact\n  if (!art) return null\n\n  const { id, lock, slotKey, rarity, level, mainStatKey, substats, exclude, location = \"\" } = art\n  const mainStatLevel = Math.max(Math.min(mainStatAssumptionLevel, rarity * 4), level)\n  const levelVariant = \"roll\" + (Math.floor(Math.max(level, 0) / 4) + 1)\n  const mainStatVal = <ColorText color={mainStatLevel !== level ? \"warning\" : undefined}>{valueStringWithUnit(Artifact.mainStatValue(mainStatKey, rarity, mainStatLevel) ?? 0, KeyMap.unit(mainStatKey))}</ColorText>\n  const { currentEfficiency, maxEfficiency } = Artifact.getArtifactEfficiency(art, effFilter)\n  const artifactValid = maxEfficiency !== 0\n  const slotName = sheet?.getSlotName(slotKey) || \"Unknown Piece Name\"\n  const slotDesc = sheet?.getSlotDesc(slotKey)\n  const slotDescTooltip = slotDesc && <BootstrapTooltip placement=\"top\" title={<Typography>{slotDesc}</Typography>}>\n    <span><FontAwesomeIcon icon={faInfoCircle} /></span>\n  </BootstrapTooltip>\n  const setEffects = sheet?.setEffects\n  const setDescTooltip = sheet && setEffects && <BootstrapTooltip placement=\"top\" title={\n    <span>\n      {Object.keys(setEffects).map(setNumKey => <span key={setNumKey}>\n        <Typography variant=\"h6\"><SqBadge color=\"success\">{t(`setEffectNum`, { setNum: setNumKey })}</SqBadge></Typography>\n        <Typography>{sheet.setEffectDesc(setNumKey as any)}</Typography>\n      </span>)}\n    </span>\n  }>\n    <span><FontAwesomeIcon icon={faInfoCircle} /></span>\n  </BootstrapTooltip>\n\n  return <Suspense fallback={<Skeleton variant=\"rectangular\" sx={{ width: \"100%\", height: \"100%\", minHeight: 350 }} />}>\n    <CardLight sx={{ height: \"100%\", display: \"flex\", flexDirection: \"column\" }}>\n      <CardContent className={`grad-${rarity}star`} sx={{ pt: 1, pb: 0, pr: 0 }}>\n        <Box component=\"div\" sx={{ display: \"flex\", alignItems: \"center\", pr: 1 }}>\n          <Chip size=\"small\" label={<strong>{` +${level}`}</strong>} color={levelVariant as any} />\n          <Typography sx={{ pl: 1, flexGrow: 1 }}>{slotName} {slotDescTooltip}</Typography>\n          <IconButton color=\"primary\" disabled={!editable} onClick={() => database.updateArt({ lock: !lock }, id)}>\n            {lock ? <Lock /> : <LockOpen />}\n          </IconButton>\n        </Box>\n        <Grid container sx={{ flexWrap: \"nowrap\" }}>\n          <Grid item flexGrow={1}>\n            <Typography color=\"text.secondary\" variant=\"body2\">\n              <SlotNameWithIcon slotKey={slotKey} />\n            </Typography>\n            <Typography variant=\"h6\">\n              {KeyMap.get(mainStatKey)}\n            </Typography>\n            <Typography variant=\"h5\">\n              <strong>{mainStatVal}</strong>\n            </Typography>\n            <Stars stars={rarity} colored />\n            {/* {process.env.NODE_ENV === \"development\" && <Typography color=\"common.black\">{id || `\"\"`} </Typography>} */}\n          </Grid>\n          <Grid item maxWidth=\"40%\" sx={{ mt: -3, mb: -1, pl: -2 }} alignSelf=\"flex-end\">\n            <CardMedia\n              component=\"img\"\n              image={sheet?.slotIcons[slotKey] ?? \"\"}\n              width=\"100%\"\n              height=\"auto\"\n            />\n          </Grid>\n        </Grid>\n      </CardContent>\n      <CardContent sx={{ flexGrow: 1, display: \"flex\", flexDirection: \"column\", pt: 1, pb: 0 }}>\n        {substats.map((stat: ICachedSubstat, i) => {\n          if (!stat.value) return null\n          const numRolls = stat.rolls?.length ?? 0\n          const rollColor = `roll${clamp(numRolls, 1, 6)}`\n          const efficiency = stat.efficiency ?? 0\n          const effOpacity = 0.3 + (efficiency / 100) * 0.7\n          const statName = KeyMap.get(stat.key)\n          return (<Box key={i} sx={{ display: \"flex\" }}>\n            <Box sx={{ flexGrow: 1 }}>\n              <SqBadge color={(numRolls ? rollColor : \"error\") as any} sx={{ mr: 1 }}><strong>{numRolls ? numRolls : \"?\"}</strong></SqBadge>\n              <Typography color={(numRolls ? `${rollColor}.main` : \"error.main\") as any} component=\"span\">{statName}{`+${valueStringWithUnit(stat.value, KeyMap.unit(stat.key))}`}</Typography>\n            </Box>\n            <Typography sx={{ opacity: effOpacity }}>{stat.key && effFilter.has(stat.key) ? valueStringWithUnit(efficiency, \"eff\") : \"-\"}</Typography>\n          </Box>)\n        })}\n        <Box sx={{ display: \"flex\", my: 1 }}>\n          <Typography color=\"text.secondary\" component=\"span\" variant=\"caption\" sx={{ flexGrow: 1 }}>{t`editor.curSubEff`}</Typography>\n          <PercentBadge value={currentEfficiency} valid={artifactValid} />\n        </Box>\n        {currentEfficiency !== maxEfficiency && <Box sx={{ display: \"flex\", mb: 1 }}>\n          <Typography color=\"text.secondary\" component=\"span\" variant=\"caption\" sx={{ flexGrow: 1 }}>{t`editor.maxSubEff`}</Typography>\n          <PercentBadge value={maxEfficiency} valid={artifactValid} />\n        </Box>}\n        <Box flexGrow={1} />\n        {probabilityFilter && <strong>Probability: {(probability(art, probabilityFilter) * 100).toFixed(2)}%</strong>}\n        <Typography color=\"success.main\">{sheet?.name ?? \"Artifact Set\"} {setDescTooltip}</Typography>\n      </CardContent>\n      <CardActions>\n        <Grid container sx={{ flexWrap: \"nowrap\" }}>\n          <Grid item xs=\"auto\" flexShrink={1}>\n            {editable ?\n              <CharacterDropdownButton size=\"small\" inventory value={location} onChange={equipOnChar} /> : <LocationName location={location} />}\n          </Grid>\n          <Grid item flexGrow={1} sx={{ mr: 1 }} />\n          {editable && <Grid item xs=\"auto\">\n            <ButtonGroup sx={{ height: \"100%\" }}>\n              {!!onEdit && <Button color=\"info\" onClick={() => onEdit(id)} size=\"small\">\n                <FontAwesomeIcon icon={faEdit} className=\"fa-fw\" />\n              </Button>}\n              <Tooltip title={<Typography>{t`excludeArtifactTip`}</Typography>} placement=\"top\" arrow>\n                <Button onClick={() => database.updateArt({ exclude: !exclude }, id)} color={exclude ? \"error\" : \"success\"} size=\"small\">\n                  <FontAwesomeIcon icon={exclude ? faBan : faChartLine} className=\"fa-fw\" />\n                </Button>\n              </Tooltip>\n              {!!onDelete && <Button color=\"error\" size=\"small\" onClick={() => onDelete(id)} disabled={lock}>\n                <FontAwesomeIcon icon={faTrashAlt} className=\"fa-fw\" />\n              </Button>}\n            </ButtonGroup>\n          </Grid>}\n        </Grid>\n      </CardActions>\n    </CardLight >\n  </Suspense>\n}\n","import { useContext, useEffect, useState } from \"react\";\nimport { DatabaseContext } from \"../Database/Database\";\n\nexport default function useArtifact(artifactID: string | undefined = \"\") {\n  const database = useContext(DatabaseContext)\n  const [artifact, setArtifact] = useState(database._getArt(artifactID))\n  useEffect(() => setArtifact(database._getArt(artifactID)), [database, artifactID])\n  useEffect(() =>\n    artifactID ? database.followArt(artifactID, setArtifact) : undefined,\n    [artifactID, setArtifact, database])\n  return artifact\n}","import { BusinessCenter, Replay } from \"@mui/icons-material\";\nimport { Divider, ListItemIcon, MenuItem, Typography } from \"@mui/material\";\nimport { useContext } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport CharacterSheet from \"../../Data/Characters/CharacterSheet\";\nimport { DatabaseContext } from \"../../Database/Database\";\nimport usePromise from \"../../ReactHooks/usePromise\";\nimport { CharacterKey } from \"../../Types/consts\";\nimport DropdownButton, { DropdownButtonProps } from \"../DropdownMenu/DropdownButton\";\nimport ThumbSide from \"./ThumbSide\";\n\nexport type CharacterDropdownButtonProps = Omit<DropdownButtonProps, \"title\" | \"onChange\" | \"children\"> & {\n  value: CharacterKey | \"\"\n  onChange: (ck: CharacterKey | \"\") => void\n  filter?: (cs: CharacterSheet, ck: CharacterKey) => boolean\n  inventory?: boolean\n  noUnselect?: boolean,\n  unSelectText?: Displayable,\n  unSelectIcon?: Displayable,\n}\n\nexport default function CharacterDropdownButton({ value, onChange, unSelectText, unSelectIcon, inventory = false, noUnselect = false, filter = () => true, ...props }: CharacterDropdownButtonProps) {\n  const { t } = useTranslation(\"ui\");\n  const database = useContext(DatabaseContext)\n  const characterSheets = usePromise(CharacterSheet.getAll, [])\n  const characterSheet = usePromise(CharacterSheet.get(value), [value])\n  const characterKeys = database._getCharKeys().filter(ck => characterSheets?.[ck] && filter(characterSheets[ck], ck)).sort()\n  return <DropdownButton\n    {...props}\n    title={characterSheet?.name ?? (inventory ? t`inventory` : (unSelectText ?? t`unselect`))}\n    color={value ? \"success\" : \"primary\"}\n    startIcon={characterSheet?.thumbImg ? <ThumbSide src={characterSheet.thumbImgSide} /> : (inventory ? <BusinessCenter /> : (unSelectIcon ?? <Replay />))}>\n    {!noUnselect && (inventory ? <MenuItem onClick={() => onChange(\"\")} selected={value === \"\"} disabled={value === \"\"}>\n      <ListItemIcon>\n        <BusinessCenter />\n      </ListItemIcon>\n      <Typography variant=\"inherit\" noWrap>\n        {t`inventory`}\n      </Typography>\n    </MenuItem> : <MenuItem onClick={() => onChange(\"\")} selected={value === \"\"} disabled={value === \"\"}>\n      <ListItemIcon>\n        <Replay />\n      </ListItemIcon>\n      <Typography variant=\"inherit\" noWrap>\n        {t`unselect`}\n      </Typography>\n    </MenuItem>)}\n    {!noUnselect && <Divider key=\"div\" />}\n    {!!characterSheets && CharacterMenuItemArray(characterSheets, characterKeys, onChange, value)}\n  </DropdownButton >\n}\n\n// Returning an array instead of Fragment because MUI Menu doesn't like fragments.\nexport function CharacterMenuItemArray(characterSheets: StrictDict<CharacterKey, CharacterSheet>, characterKeys: CharacterKey[], onChange: (ck: CharacterKey) => void, selectedCharacterKey: CharacterKey | \"\" = \"\") {\n  return characterKeys.map(characterKey =>\n    <MenuItem onClick={() => onChange(characterKey)} key={characterKey} selected={selectedCharacterKey === characterKey} disabled={selectedCharacterKey === characterKey} >\n      <ListItemIcon>\n        <ThumbSide src={characterSheets[characterKey].thumbImgSide} />\n      </ListItemIcon>\n      <Typography variant=\"inherit\" noWrap>\n        {characterSheets?.[characterKey]?.name}\n      </Typography>\n    </MenuItem>)\n}\n","import { faEdit, faTrashAlt } from \"@fortawesome/free-solid-svg-icons\"\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\nimport { Lock, LockOpen } from \"@mui/icons-material\"\nimport { Box, Button, ButtonGroup, CardActionArea, CardContent, CardHeader, Grid, IconButton, Skeleton, Typography } from \"@mui/material\"\nimport { Suspense, useCallback, useContext, useMemo } from \"react\"\nimport Assets from \"../Assets/Assets\"\nimport CharacterSheet from \"../Data/Characters/CharacterSheet\"\nimport CardLight from \"../Components/Card/CardLight\"\nimport CharacterDropdownButton from '../Components/Character/CharacterDropdownButton_WR'\nimport LocationName from \"../Components/Character/LocationName\"\nimport ConditionalWrapper from \"../Components/ConditionalWrapper\"\nimport ImgIcon from \"../Components/Image/ImgIcon\"\nimport { Stars } from \"../Components/StarDisplay\"\nimport StatIcon from \"../Components/StatIcon\"\nimport { ascensionMaxLevel } from \"../Data/LevelData\"\nimport { DatabaseContext } from \"../Database/Database\"\nimport { uiInput as input } from \"../Formula\"\nimport { computeUIData, valueString, dataObjForWeapon } from \"../Formula/api\"\nimport usePromise from \"../ReactHooks/usePromise\"\nimport useWeapon from \"../ReactHooks/useWeapon\"\nimport KeyMap from \"../KeyMap\"\nimport { CharacterKey } from \"../Types/consts\"\nimport WeaponSheet from \"../Data/Weapons/WeaponSheet\"\n\ntype WeaponCardProps = { weaponId: string, onClick?: (weaponId: string) => void, onEdit?: (weaponId: string) => void, onDelete?: (weaponId: string) => void, canEquip?: boolean }\nexport default function WeaponCard({ weaponId, onClick, onEdit, onDelete, canEquip = false }: WeaponCardProps) {\n  const database = useContext(DatabaseContext)\n  const databaseWeapon = useWeapon(weaponId)\n  const weapon = databaseWeapon\n  const weaponSheet = usePromise(weapon?.key ? WeaponSheet.get(weapon.key) : undefined, [weapon?.key])\n\n  const filter = useCallback(\n    (cs: CharacterSheet) => cs.weaponTypeKey === weaponSheet?.weaponType,\n    [weaponSheet],\n  )\n\n  const actionWrapperFunc = useCallback(\n    children => <CardActionArea onClick={() => onClick?.(weaponId)} sx={{ height: \"100%\" }}>{children}</CardActionArea>,\n    [onClick, weaponId],\n  )\n\n  const equipOnChar = useCallback((charKey: CharacterKey | \"\") => database.setWeaponLocation(weaponId, charKey), [database, weaponId],)\n\n  const UIData = useMemo(() => weaponSheet && weapon && computeUIData([weaponSheet.data, dataObjForWeapon(weapon)]), [weaponSheet, weapon])\n\n  if (!weapon || !weaponSheet || !UIData) return null;\n  const { level, ascension, refinement, id, location = \"\", lock } = weapon\n  const weaponTypeKey = UIData.get(input.weapon.type).value!\n  const stats = [input.weapon.main, input.weapon.sub, input.weapon.sub2].map(x => UIData.get(x))\n  const img = ascension < 2 ? weaponSheet?.img : weaponSheet?.imgAwaken\n\n  return <Suspense fallback={<Skeleton variant=\"rectangular\" sx={{ width: \"100%\", height: \"100%\", minHeight: 300 }} />}>\n    <ConditionalWrapper condition={!!onClick} wrapper={actionWrapperFunc}>\n      <CardLight sx={{ height: \"100%\", display: \"flex\", flexDirection: \"column\" }}>\n        <div className={`grad-${weaponSheet.rarity}star`} >\n          <CardHeader title={weaponSheet.name} avatar={<ImgIcon sx={{ fontSize: \"2em\" }} src={Assets.weaponTypes?.[weaponTypeKey]} />} titleTypographyProps={{ variant: \"h6\" }}\n            action={!onClick && <IconButton color=\"primary\" onClick={() => database.updateWeapon({ lock: !lock }, id)}>\n              {lock ? <Lock /> : <LockOpen />}\n            </IconButton>} />\n          <Grid container sx={{ flexWrap: \"nowrap\", pl: 2 }}>\n            <Grid item flexGrow={1}>\n              <Typography component=\"span\" variant=\"h4\">Lv. {level}</Typography>\n              <Typography component=\"span\" variant=\"h4\" color=\"text.secondary\">/{ascensionMaxLevel[ascension]}</Typography>\n              <Typography variant=\"h6\">Refinement <strong>{refinement}</strong></Typography>\n              <Typography><Stars stars={weaponSheet.rarity} colored /></Typography>\n            </Grid>\n            {/* use flex-end here to align the image to the bottom. */}\n            <Grid item container maxWidth=\"40%\" alignContent=\"flex-end\" sx={{ mt: -3 }}>\n              <Box component=\"img\" src={img} width=\"100%\" height=\"auto\" />\n            </Grid>\n          </Grid>\n        </div>\n        <CardContent>\n          {stats.map(node => {\n            if (!node.key) return null\n            const displayVal = valueString(node.value, node.unit, node.unit === \"flat\" ? 0 : undefined)\n            return <Box key={node.key} sx={{ display: \"flex\" }}>\n              <Typography flexGrow={1}>{StatIcon[node.key]} {KeyMap.get(node.key)}</Typography>\n              <Typography>{displayVal}</Typography>\n            </Box>\n          })}\n        </CardContent>\n        {/* grow to fill the 100% heigh */}\n        <Box flexGrow={1} />\n        <CardContent sx={{ py: 1 }}>\n          <Grid container sx={{ flexWrap: \"nowrap\" }} >\n            <Grid item xs=\"auto\" flexShrink={1}>\n              {canEquip ? <CharacterDropdownButton size=\"small\" noUnselect inventory value={location} onChange={equipOnChar} filter={filter} /> : <LocationName location={location} />}\n            </Grid>\n            <Grid item flexGrow={1} sx={{ mr: 1 }} />\n            <Grid item xs=\"auto\">\n              <ButtonGroup sx={{ height: \"100%\" }}>\n                {!!onEdit && <Button color=\"info\" size=\"small\" onClick={() => onEdit(id)} >\n                  <FontAwesomeIcon icon={faEdit} className=\"fa-fw\" />\n                </Button>}\n                {!!onDelete && <Button color=\"error\" size=\"small\" onClick={() => onDelete(id)} disabled={!!location || lock} >\n                  <FontAwesomeIcon icon={faTrashAlt} className=\"fa-fw\" />\n                </Button>}\n              </ButtonGroup>\n            </Grid>\n          </Grid>\n        </CardContent>\n\n      </CardLight>\n    </ConditionalWrapper>\n  </Suspense>\n}\n","import CharacterSheet from \"../Data/Characters/CharacterSheet\";\nimport { ArtCharDatabase } from \"../Database/Database\";\nimport { CharacterKey } from \"../Types/consts\";\nimport { FilterConfigs, SortConfigs } from \"./SortByFilters\";\nexport const characterSortKeys = [\"level\", \"rarity\", \"name\"]\nexport type CharacterSortKey = typeof characterSortKeys[number]\n\nexport function characterSortConfigs(database: ArtCharDatabase, characterSheets: Record<CharacterKey, CharacterSheet>): SortConfigs<CharacterSortKey, CharacterKey> {\n  return {\n    new: {\n      getValue: (ck) => database._getChar(ck as CharacterKey) ? 0 : 1,\n      tieBreaker: \"name\"\n    },\n    name: {\n      getValue: (ck) => ck,\n    },\n    level: {\n      getValue: (ck) => database._getChar(ck as CharacterKey)?.level ?? 0,\n      tieBreaker: \"rarity\"\n    },\n    rarity: {\n      getValue: (ck) => characterSheets?.[ck]?.rarity,\n      tieBreaker: \"level\"\n    }\n  }\n}\n\nexport function characterFilterConfigs(characterSheets: Record<CharacterKey, CharacterSheet>): FilterConfigs<\"element\" | \"weaponType\", CharacterKey> {\n  return {\n    element: (ck, filter) => !filter || (filter === characterSheets?.[ck]?.elementKey),\n    weaponType: (ck, filter) => !filter || (filter === characterSheets?.[ck]?.weaponTypeKey),\n  }\n}\n","import { Lock, LockOpen, SwapHoriz } from \"@mui/icons-material\"\nimport { Box, Button, ButtonGroup, CardContent, Divider, Grid, ListItem, MenuItem, Typography } from \"@mui/material\"\nimport { useCallback, useContext, useMemo, useState } from \"react\"\nimport Assets from \"../Assets/Assets\"\nimport CharacterSheet from \"../Data/Characters/CharacterSheet\"\nimport CardDark from \"../Components/Card/CardDark\"\nimport CardLight from \"../Components/Card/CardLight\"\nimport CharacterDropdownButton from \"../Components/Character/CharacterDropdownButton\"\nimport CloseButton from \"../Components/CloseButton\"\nimport ColorText from \"../Components/ColoredText\"\nimport CustomNumberInput, { CustomNumberInputButtonGroupWrapper } from \"../Components/CustomNumberInput\"\nimport DocumentDisplay from \"../Components/DocumentDisplay\"\nimport DropdownButton from \"../Components/DropdownMenu/DropdownButton\"\nimport { FieldDisplayList, NodeFieldDisplay } from \"../Components/FieldDisplay\"\nimport ImgIcon from \"../Components/Image/ImgIcon\"\nimport ModalWrapper from \"../Components/ModalWrapper\"\nimport SqBadge from \"../Components/SqBadge\"\nimport { Stars } from \"../Components/StarDisplay\"\nimport WeaponSelectionModal from \"../Components/Weapon/WeaponSelectionModal\"\nimport { ambiguousLevel, ascensionMaxLevel, milestoneLevels } from \"../Data/LevelData\"\nimport { database as localDatabase, DatabaseContext } from \"../Database/Database\"\nimport { uiInput as input } from \"../Formula\"\nimport { computeUIData, dataObjForWeapon } from \"../Formula/api\"\nimport usePromise from \"../ReactHooks/usePromise\"\nimport useWeapon from \"../ReactHooks/useWeapon\"\nimport { CharacterKey } from \"../Types/consts\"\nimport { ICachedWeapon } from \"../Types/weapon\"\nimport { clamp } from \"../Util/Util\"\nimport WeaponCard from \"./WeaponCard\"\nimport WeaponSheet from \"../Data/Weapons/WeaponSheet\"\nimport { DataContext } from \"../DataContext\"\n\ntype WeaponStatsEditorCardProps = {\n  weaponId: string\n  footer?: boolean\n  onClose?: () => void\n}\nexport default function WeaponDisplayCard({\n  weaponId: propWeaponId,\n  footer = false,\n  onClose\n}: WeaponStatsEditorCardProps) {\n  const { data } = useContext(DataContext)\n\n  const database = useContext(DatabaseContext)\n  const weapon = useWeapon(propWeaponId)\n  const { key = \"\", level, refinement = 0, ascension = 0, lock, location = \"\", id } = weapon ?? {}\n  const weaponSheet = usePromise(WeaponSheet.get(key), [key])\n  const weaponTypeKey = weaponSheet?.weaponType\n\n  const weaponDispatch = useCallback((newWeapon: Partial<ICachedWeapon>) => {\n    database.updateWeapon(newWeapon, propWeaponId)\n  }, [propWeaponId, database])\n\n  const setLevel = useCallback(level => {\n    level = clamp(level, 1, 90)\n    const ascension = ascensionMaxLevel.findIndex(ascenML => level <= ascenML)\n    weaponDispatch({ level, ascension })\n  }, [weaponDispatch])\n\n  const setAscension = useCallback(() => {\n    const lowerAscension = ascensionMaxLevel.findIndex(ascenML => level !== 90 && level === ascenML)\n    if (ascension === lowerAscension) weaponDispatch({ ascension: ascension + 1 })\n    else weaponDispatch({ ascension: lowerAscension })\n  }, [weaponDispatch, ascension, level])\n\n  const characterSheet = usePromise(location ? CharacterSheet.get(location) : undefined, [location])\n  const weaponFilter = characterSheet ? (ws) => ws.weaponType === characterSheet.weaponTypeKey : undefined\n  const initialWeaponFilter = characterSheet && characterSheet.weaponTypeKey\n\n  const equipOnChar = useCallback((charKey: CharacterKey | \"\") => id && database.setWeaponLocation(id, charKey), [database, id])\n  const filter = useCallback(\n    (cs: CharacterSheet) => cs.weaponTypeKey === weaponSheet?.weaponType,\n    [weaponSheet],\n  )\n  const [showModal, setshowModal] = useState(false)\n  const img = ascension < 2 ? weaponSheet?.img : weaponSheet?.imgAwaken\n\n  const weaponUIData = useMemo(() => weaponSheet && weapon && computeUIData([weaponSheet.data, dataObjForWeapon(weapon)]), [weaponSheet, weapon])\n  return <CardLight>\n    <CardContent sx={{ py: 1 }}>\n      <Grid container spacing={1}>\n        <Grid item flexGrow={1}>\n          <Grid container spacing={1}>\n            <Grid item >\n              <WeaponSelectionModal show={showModal} onHide={() => setshowModal(false)} onSelect={k => weaponDispatch({ key: k })} filter={weaponFilter} weaponFilter={initialWeaponFilter} />\n              <ButtonGroup>\n                <Button onClick={() => setshowModal(true)} >{weaponSheet?.name ?? \"Select a Weapon\"}</Button>\n                <DropdownButton title={`Refinement ${refinement}`}>\n                  <MenuItem>Select Weapon Refinement</MenuItem>\n                  <Divider />\n                  {[...Array(5).keys()].map(key =>\n                    <MenuItem key={key} onClick={() => weaponDispatch({ refinement: key + 1 })} selected={refinement === (key + 1)} disabled={refinement === (key + 1)}>\n                      {`Refinement ${key + 1}`}\n                    </MenuItem>)}\n                </DropdownButton>\n              </ButtonGroup>\n            </Grid>\n            <Grid item >\n              <ButtonGroup sx={{ bgcolor: t => t.palette.contentLight.main }} >\n                <CustomNumberInputButtonGroupWrapper >\n                  <CustomNumberInput onChange={setLevel} value={level}\n                    startAdornment=\"Lvl. \"\n                    inputProps={{ min: 1, max: 90, sx: { textAlign: \"center\" } }}\n                    sx={{ width: \"100%\", height: \"100%\", pl: 2 }}\n                  />\n                </CustomNumberInputButtonGroupWrapper>\n                <Button sx={{ pl: 1 }} disabled={!ambiguousLevel(level)} onClick={setAscension}><strong>/ {ascensionMaxLevel[ascension]}</strong></Button>\n                <DropdownButton title={\"Select Level\"} >\n                  {milestoneLevels.map(([lv, as]) => {\n                    const sameLevel = lv === ascensionMaxLevel[as]\n                    const lvlstr = sameLevel ? `Lv. ${lv}` : `Lv. ${lv}/${ascensionMaxLevel[as]}`\n                    const selected = lv === level && as === ascension\n                    return <MenuItem key={`${lv}/${as}`} selected={selected} disabled={selected} onClick={() => weaponDispatch({ level: lv, ascension: as })}>{lvlstr}</MenuItem>\n                  })}\n                </DropdownButton>\n              </ButtonGroup>\n            </Grid>\n            <Grid item>\n              <Button color=\"error\" onClick={() => id && database.updateWeapon({ lock: !lock }, id)} startIcon={lock ? <Lock /> : <LockOpen />}>\n                {lock ? \"Locked\" : \"Unlocked\"}\n              </Button>\n            </Grid>\n          </Grid>\n        </Grid>\n        {!!onClose && <Grid item  >\n          <CloseButton onClick={onClose} />\n        </Grid>}\n        {database === localDatabase && <Grid item >\n          <SwapBtn weaponTypeKey={weaponTypeKey} onChangeId={id => database.setWeaponLocation(id, data.get(input.charKey).value as CharacterKey)} />\n        </Grid>}\n      </Grid>\n    </CardContent>\n    <Divider />\n    <CardContent >\n      {weaponSheet && weaponUIData && <Box display=\"flex\" gap={{ xs: 1, md: 1.5, lg: 2 }} >\n        <Box sx={{ maxWidth: 256 }} flexShrink={1} minWidth=\"25%\">\n          <Box component=\"img\" src={img} className={`grad-${weaponSheet.rarity}star`} sx={{ maxWidth: 256, width: \"100%\", height: \"auto\", borderRadius: 1 }} />\n          <Typography><small>{weaponSheet.description}</small></Typography>\n        </Box>\n        <Box sx={{ mb: -1 }} flexGrow={1} >\n          <Typography variant=\"h6\" >{process.env.NODE_ENV === \"development\" && <ColorText color=\"warning\">{id || `\"\"`} </ColorText>}{weaponSheet.name} Lv. {weapon && WeaponSheet.getLevelString(weapon)} {weaponSheet.rarity > 2 && <SqBadge color=\"info\">Refinement {refinement}</SqBadge>}</Typography>\n          <Typography><Stars stars={weaponSheet.rarity} /></Typography>\n          <Typography variant=\"subtitle1\">{weaponSheet.passiveName}</Typography>\n          <Typography gutterBottom>{weaponSheet.passiveName && weaponSheet.passiveDescription(weaponUIData.get(input.weapon.refineIndex).value)}</Typography>\n          <Box display=\"flex\" flexDirection=\"column\" gap={1}>\n            <CardDark >\n              <CardContent>\n                <Typography>Main Stats</Typography>\n              </CardContent>\n              <FieldDisplayList>\n                {[input.weapon.main, input.weapon.sub, input.weapon.sub2].map((node, i) => {\n                  const n = weaponUIData.get(node)\n                  if (n.isEmpty || !n.value) return null\n                  return <ListItem key={i}><NodeFieldDisplay node={n} /></ListItem>\n                })}\n              </FieldDisplayList>\n            </CardDark>\n            {data && weaponSheet.document && <DocumentDisplay sections={weaponSheet.document} />}\n          </Box>\n        </Box>\n      </Box>}\n    </CardContent>\n    {footer && id && <CardContent sx={{ py: 1 }}>\n      <Grid container>\n        <Grid item flexGrow={1}>\n          <CharacterDropdownButton noUnselect inventory value={location} onChange={equipOnChar} filter={filter} />\n        </Grid>\n        {!!onClose && <Grid item><CloseButton large onClick={onClose} /></Grid>}\n      </Grid>\n    </CardContent>}\n  </CardLight>\n}\nfunction SwapBtn({ onChangeId, weaponTypeKey }) {\n  const database = useContext(DatabaseContext)\n  const [show, setShow] = useState(false)\n  const open = () => setShow(true)\n  const close = () => setShow(false)\n\n  const clickHandler = (id) => {\n    onChangeId(id)\n    close()\n  }\n\n  const weaponSheets = usePromise(WeaponSheet.getAll, [])\n\n  const weaponIdList = database.weapons.keys.filter(wKey => {\n    const dbWeapon = database._getWeapon(wKey)\n    if (!dbWeapon) return false\n    if (weaponTypeKey && weaponTypeKey !== weaponSheets?.[dbWeapon.key]?.weaponType) return false\n    return true\n  })\n\n\n  return <>\n    <Button color=\"info\" onClick={open} startIcon={<SwapHoriz />} >SWAP WEAPON</Button>\n    <ModalWrapper open={show} onClose={close} >\n      <CardDark>\n        <CardContent sx={{ py: 1 }}>\n          <Grid container>\n            <Grid item flexGrow={1}>\n              <Typography variant=\"h6\">{weaponTypeKey ? <ImgIcon src={Assets.weaponTypes[weaponTypeKey]} /> : null} Swap Weapon</Typography>\n            </Grid>\n            <Grid item>\n              <CloseButton onClick={close} />\n            </Grid>\n          </Grid>\n        </CardContent>\n        <Divider />\n        <CardContent>\n          <Grid container spacing={1}>\n            {weaponIdList.map(weaponId =>\n              <Grid item key={weaponId} xs={6} sm={6} md={4} lg={3} >\n                <WeaponCard\n                  weaponId={weaponId}\n                  onClick={clickHandler}\n                />\n              </Grid>)}\n          </Grid>\n        </CardContent>\n      </CardDark>\n    </ModalWrapper>\n  </>\n}\n","import { Box, CardActionArea, CardContent, Divider, Grid, Typography } from \"@mui/material\";\nimport { useContext, useMemo, useState } from \"react\";\nimport Assets from \"../../Assets/Assets\";\nimport CharacterSheet from \"../../Data/Characters/CharacterSheet\";\nimport { DatabaseContext } from \"../../Database/Database\";\nimport { uiInput as input } from \"../../Formula\";\nimport useCharUIData from \"../../ReactHooks/useCharUIData\";\nimport usePromise from \"../../ReactHooks/usePromise\";\nimport { ICachedCharacter } from \"../../Types/character_WR\";\nimport { allCharacterKeys, CharacterKey, ElementKey, WeaponTypeKey } from \"../../Types/consts\";\nimport { characterFilterConfigs, characterSortConfigs } from \"../../Util/CharacterSort\";\nimport { filterFunction, sortFunction } from \"../../Util/SortByFilters\";\nimport CardDark from \"../Card/CardDark\";\nimport CardLight from \"../Card/CardLight\";\nimport CloseButton from \"../CloseButton\";\nimport ImgIcon from \"../Image/ImgIcon\";\nimport ModalWrapper from \"../ModalWrapper\";\nimport SortByButton from \"../SortByButton\";\nimport SqBadge from \"../SqBadge\";\nimport { Stars } from \"../StarDisplay\";\nimport StatIcon from \"../StatIcon\";\nimport ElementToggle from \"../ToggleButton/ElementToggle\";\nimport WeaponToggle from \"../ToggleButton/WeaponToggle\";\n\nconst defaultSortKeys = [\"level\", \"rarity\", \"name\"]\n\ntype characterFilter = (character: ICachedCharacter | undefined, sheet: CharacterSheet) => boolean\n\ntype CharacterSelectionModalProps = {\n  show: boolean,\n  newFirst?: boolean\n  onHide: () => void,\n  onSelect?: (ckey: CharacterKey) => void,\n  filter?: characterFilter\n}\n\nexport function CharacterSelectionModal({ show, onHide, onSelect, filter = () => true, newFirst = false }: CharacterSelectionModalProps) {\n  const sortKeys = useMemo(() => newFirst ? [\"new\", ...defaultSortKeys] : defaultSortKeys, [newFirst])\n  const database = useContext(DatabaseContext)\n\n  const [sortBy, setsortBy] = useState(sortKeys[0])\n  const [ascending, setascending] = useState(false)\n  const [elementalFilter, setelementalFilter] = useState<ElementKey | \"\">(\"\")\n  const [weaponFilter, setweaponFilter] = useState<WeaponTypeKey | \"\">(\"\")\n\n  const characterSheets = usePromise(CharacterSheet.getAll, [])\n\n  const sortConfigs = useMemo(() => characterSheets && characterSortConfigs(database, characterSheets), [database, characterSheets])\n  const filterConfigs = useMemo(() => characterSheets && characterFilterConfigs(characterSheets), [characterSheets])\n  const characterKeyList = useMemo(() => (characterSheets && sortConfigs && filterConfigs) ?\n    [...new Set(allCharacterKeys)].filter(cKey => filter(database._getChar(cKey), characterSheets[cKey]))\n      .filter(filterFunction({ element: elementalFilter, weaponType: weaponFilter }, filterConfigs))\n      .sort(sortFunction(sortBy, ascending, sortConfigs) as (a: CharacterKey, b: CharacterKey) => number) : [],\n    [database, characterSheets, filter, elementalFilter, weaponFilter, sortBy, ascending, sortConfigs, filterConfigs])\n\n  if (!characterSheets) return null\n  return <ModalWrapper open={show} onClose={onHide} >\n    <CardDark>\n      <CardContent sx={{ py: 1 }}>\n        <Grid container spacing={1} >\n          <Grid item>\n            <WeaponToggle sx={{ height: \"100%\" }} onChange={setweaponFilter} value={weaponFilter} size=\"small\" />\n          </Grid>\n          <Grid item flexGrow={1}>\n            <ElementToggle sx={{ height: \"100%\" }} onChange={setelementalFilter} value={elementalFilter} size=\"small\" />\n          </Grid>\n\n          <Grid item flexGrow={1} />\n\n          <Grid item >\n            <SortByButton sx={{ height: \"100%\" }}\n              sortKeys={sortKeys} value={sortBy} onChange={setsortBy as any}\n              ascending={ascending} onChangeAsc={setascending} />\n          </Grid>\n          <Grid item>\n            <CloseButton onClick={onHide} />\n          </Grid>\n        </Grid>\n      </CardContent>\n      <Divider />\n      <CardContent><Grid container spacing={1}>\n        {characterKeyList.map(characterKey => <Grid item key={characterKey} xs={6} md={4} lg={3} >\n          <CharacterBtn key={characterKey} characterKey={characterKey} onClick={() => { onHide(); onSelect?.(characterKey) }} />\n        </Grid>)}\n      </Grid></CardContent>\n    </CardDark>\n  </ModalWrapper>\n}\n\nfunction CharacterBtn({ onClick, characterKey }: { onClick: () => void, characterKey: CharacterKey }) {\n  const characterSheet = usePromise(CharacterSheet.get(characterKey), [characterKey])\n  const UIDataBundle = useCharUIData(characterKey)\n  if (!characterSheet) return null\n  const rarity = characterSheet.rarity\n  return <CardActionArea onClick={onClick} >\n    <CardLight sx={{ display: \"flex\", alignItems: \"center\" }}  >\n      <Box component=\"img\" src={characterSheet.thumbImg} sx={{ width: 130, height: \"auto\" }} className={`grad-${rarity}star`} />\n      <Box sx={{ pl: 1 }}>\n        <Typography><strong>{characterSheet.name}</strong></Typography>\n        {UIDataBundle ? <>\n          <Typography variant=\"h6\"> {characterSheet.elementKey && StatIcon[characterSheet.elementKey]} <ImgIcon src={Assets.weaponTypes?.[characterSheet.weaponTypeKey]} />{` `}{CharacterSheet.getLevelString(UIDataBundle.data.get(input.lvl).value, UIDataBundle.data.get(input.asc).value)}</Typography>\n          <Typography >\n            <SqBadge color=\"success\">{`C${UIDataBundle.data.get(input.constellation).value}`}</SqBadge>{` `}\n            <SqBadge color={UIDataBundle.data.get(input.bonus.auto).value ? \"info\" : \"secondary\"}><strong >{UIDataBundle.data.get(input.total.auto).value}</strong></SqBadge>{` `}\n            <SqBadge color={UIDataBundle.data.get(input.bonus.skill).value ? \"info\" : \"secondary\"}><strong >{UIDataBundle.data.get(input.total.skill).value}</strong></SqBadge>{` `}\n            <SqBadge color={UIDataBundle.data.get(input.bonus.burst).value ? \"info\" : \"secondary\"}><strong >{UIDataBundle.data.get(input.total.burst).value}</strong></SqBadge>\n          </Typography>\n        </> : <>\n          <Typography variant=\"h6\"><SqBadge color=\"primary\">NEW</SqBadge></Typography>\n        </>}\n        <small><Stars stars={rarity} colored /></small>\n      </Box>\n    </CardLight>\n  </CardActionArea >\n}\n","import { useContext, useEffect, useMemo } from \"react\";\nimport { ArtifactSheet } from \"../Data/Artifacts/ArtifactSheet\";\nimport CharacterSheet from \"../Data/Characters/CharacterSheet\";\nimport { DatabaseContext } from \"../Database/Database\";\nimport { common } from \"../Formula\";\nimport { computeUIData, dataObjForArtifact, dataObjForCharacter, dataObjForWeapon } from \"../Formula/api\";\nimport { ICachedArtifact } from \"../Types/artifact_WR\";\nimport { CharacterKey, SlotKey } from \"../Types/consts\";\nimport { objectMap } from \"../Util/Util\";\nimport WeaponSheet from \"../Data/Weapons/WeaponSheet\";\nimport useCharacter from \"./useCharacter\";\nimport useForceUpdate from \"./useForceUpdate\";\nimport usePromise from \"./usePromise\";\nimport useWeapon from \"./useWeapon\";\n\n/**\n * @deprecated\n * @param characterKey\n * @param mainStatAssumptionLevel\n * @returns\n */\nexport default function useCharUIData(characterKey: CharacterKey | \"\", mainStatAssumptionLevel: number = 0) {\n  const database = useContext(DatabaseContext)\n  const character = useCharacter(characterKey)\n  const weapon = useWeapon(character?.equippedWeapon)\n\n  const characterSheet = usePromise(CharacterSheet.get(characterKey), [characterKey])\n  const artifactSheetsData = usePromise(ArtifactSheet.getAllData, [])\n\n  const weaponSheet = usePromise(weapon && WeaponSheet.get(weapon.key), [weapon])\n  const artifacts = useMemo(() => character && database && objectMap(character.equippedArtifacts, a => database._getArt(a)), [character, database])\n\n  const [dbDirty, setDbDirty] = useForceUpdate()\n  //follow updates from team\n  const [teammate1, teammate2, teammate3] = character?.team ?? []\n  useEffect(() =>\n    teammate1 ? database.followChar(teammate1, setDbDirty) : undefined,\n    [teammate1, setDbDirty, database])\n  useEffect(() =>\n    teammate2 ? database.followChar(teammate2, setDbDirty) : undefined,\n    [teammate2, setDbDirty, database])\n  useEffect(() =>\n    teammate3 ? database.followChar(teammate3, setDbDirty) : undefined,\n    [teammate3, setDbDirty, database])\n\n  const dataWoArt = useMemo(() => dbDirty && character && characterSheet && weapon && weaponSheet && artifacts && artifactSheetsData && [\n    dataObjForCharacter(character),\n    characterSheet.data,\n    dataObjForWeapon(weapon),\n    weaponSheet.data,\n    artifactSheetsData,\n    common, // NEED TO PUT THIS AT THE END\n  ], [dbDirty, character, characterSheet, weapon, weaponSheet, artifacts, artifactSheetsData])\n\n  const data = useMemo(() => dataWoArt && artifacts && computeUIData([\n    ...Object.values(artifacts).filter(a => a).map(a => dataObjForArtifact(a, mainStatAssumptionLevel)),\n    ...dataWoArt,\n  ]),\n    [dataWoArt, artifacts, mainStatAssumptionLevel])\n  if (!data || !character || !characterSheet || !weapon || !weaponSheet || !artifacts || !artifactSheetsData || !database || !dataWoArt)\n    return undefined\n  return { data, character, characterSheet, weapon, weaponSheet, artifacts, artifactSheetsData, database, dataWoArt }\n}\n","import { ButtonProps, ToggleButton, ToggleButtonProps, styled } from \"@mui/material\";\n\ntype SolidColoredToggleButtonPartial = {\n  baseColor?: ButtonProps[\"color\"];\n  selectedColor?: ButtonProps[\"color\"];\n}\nexport type SolidColoredToggleButtonProps = SolidColoredToggleButtonPartial & ToggleButtonProps\n\n\nconst SolidColoredToggleButton = styled(ToggleButton, {\n  shouldForwardProp: (prop) => prop !== \"baseColor\" && prop !== \"selectedColor\"\n})<SolidColoredToggleButtonPartial>(({ theme, baseColor = \"primary\", selectedColor = \"success\" }) => ({\n  '&': {\n    backgroundColor: theme.palette[baseColor].main,\n    color: theme.palette[baseColor].contrastText,\n  },\n  '&:hover': {\n    backgroundColor: theme.palette[baseColor].dark,\n  },\n  '&.Mui-selected': {\n    backgroundColor: theme.palette[selectedColor].main,\n    color: theme.palette[selectedColor].contrastText,\n  },\n  '&.Mui-selected:hover': {\n    backgroundColor: theme.palette[selectedColor].dark,\n  },\n  '&.Mui-disabled': {\n    backgroundColor: theme.palette[baseColor].dark,\n  },\n  '&.Mui-selected.Mui-disabled': {\n    backgroundColor: theme.palette[selectedColor].dark,\n  },\n}));\n\nexport default SolidColoredToggleButton","import { Box, ToggleButtonGroup } from \"@mui/material\";\nimport { useCallback } from \"react\";\nimport { allElements, ElementKey } from \"../../Types/consts\";\nimport SolidColoredToggleButton from \"../SolidColoredToggleButton\";\nimport { SolidToggleButtonGroupProps } from \"../SolidToggleButtonGroup\";\nimport { uncoloredEleIcons } from \"../StatIcon\";\ntype ElementToggleProps = Omit<SolidToggleButtonGroupProps, \"onChange\" | \"value\"> & {\n  onChange: (value: ElementKey | \"\") => void\n  value: ElementKey | \"\"\n}\nexport default function ElementToggle({ value, onChange, ...props }: ElementToggleProps) {\n  const cb = useCallback((e, newVal) => onChange(newVal || \"\"), [onChange])\n  return <ToggleButtonGroup exclusive onChange={cb} value={value || allElements} {...props}>\n    {allElements.map(ele => <SolidColoredToggleButton key={ele} value={ele} selectedColor={ele} >\n      <Box sx={{ fontSize: \"2em\", lineHeight: 1 }}>{uncoloredEleIcons[ele]}</Box>\n    </SolidColoredToggleButton>)}\n  </ToggleButtonGroup>\n}\n","import { ExpandMore } from \"@mui/icons-material\"\nimport { Accordion, AccordionDetails, AccordionSummary, Box, CardContent, CardHeader, Collapse, Divider, Grid, Skeleton, Typography } from \"@mui/material\"\nimport { Suspense, useCallback, useContext, useState } from \"react\"\nimport { DataContext } from \"../DataContext\"\nimport { getDisplayHeader, getDisplaySections } from \"../Formula/DisplayUtil\"\nimport { DisplaySub } from \"../Formula/type\"\nimport { NodeDisplay, valueString } from \"../Formula/uiData\"\nimport KeyMap from \"../KeyMap\"\nimport usePromise from \"../ReactHooks/usePromise\"\nimport CardDark from \"./Card/CardDark\"\nimport CardLight from \"./Card/CardLight\"\nimport ColorText from \"./ColoredText\"\nimport ExpandButton from \"./ExpandButton\"\nimport ImgIcon from \"./Image/ImgIcon\"\n\nexport default function FormulaCalcCard() {\n  const [expanded, setexpanded] = useState(false)\n  const toggle = useCallback(() => setexpanded(!expanded), [setexpanded, expanded])\n  return <CardLight>\n    <CardContent>\n      <Grid container>\n        <Grid item flexGrow={1}>\n          <Typography>Formulas {\"&\"} Calculations</Typography>\n          <Typography variant=\"caption\" color=\"text.secondary\">Expand to see every formula and all their calculations.</Typography>\n        </Grid>\n        <Grid item>\n          <ExpandButton\n            expand={expanded}\n            onClick={toggle}\n            aria-expanded={expanded}\n            aria-label=\"show more\"\n          >\n            <ExpandMore />\n          </ExpandButton>\n        </Grid>\n      </Grid>\n    </CardContent>\n    <Collapse in={expanded} timeout=\"auto\" unmountOnExit>\n      <CardContent sx={{ pt: 0 }}>\n        <CalculationDisplay />\n      </CardContent>\n    </Collapse>\n  </CardLight>\n}\n\nfunction CalculationDisplay() {\n  const { data } = useContext(DataContext)\n  const sections = getDisplaySections(data)\n  return <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={1000} />} >\n    <Box sx={{ mr: -1, mb: -1 }}>\n      {sections.map(([key, Nodes]) =>\n        <FormulaCalc key={key} displayNs={Nodes} sectionKey={key} />)}\n    </Box>\n  </Suspense>\n}\nfunction FormulaCalc({ sectionKey, displayNs }: { displayNs: DisplaySub<NodeDisplay>, sectionKey: string }) {\n  const { data } = useContext(DataContext)\n  const header = usePromise(getDisplayHeader(data, sectionKey), [data, sectionKey])\n  if (!header) return null\n  const { title, icon, action } = header\n  return <CardDark sx={{ mb: 1 }}>\n    <CardHeader avatar={icon && <ImgIcon size={2} sx={{ m: -1 }} src={icon} />} title={title} action={action} titleTypographyProps={{ variant: \"subtitle1\" }} />\n    <Divider />\n    <CardContent>\n      {Object.entries(displayNs).map(([key, node]) =>\n        !node.isEmpty && <Accordion sx={{ bgcolor: \"contentLight.main\" }} key={key}>\n          <AccordionSummary expandIcon={<ExpandMore />}>\n            <Typography><ColorText color={node.variant}>{KeyMap.get(node.key ?? \"\")}</ColorText> <strong>{valueString(node.value, node.unit)}</strong></Typography>\n          </AccordionSummary>\n          <AccordionDetails>\n            {node.formulas.map((subform, i) => <Typography key={i}>{subform}</Typography>)}\n          </AccordionDetails>\n        </Accordion>)}\n    </CardContent>\n  </CardDark>\n}\n","import { Button, Card, CardContent, CardHeader, Divider, Grid, Typography } from '@mui/material';\nimport { useCallback, useContext, useEffect } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport ArtifactCard from '../../PageArtifact/ArtifactCard';\nimport { ArtifactSheet } from '../../Data/Artifacts/ArtifactSheet';\nimport SetEffectDisplay from '../../Components/Artifact/SetEffectDisplay';\nimport CardLight from '../../Components/Card/CardLight';\nimport ImgIcon from '../../Components/Image/ImgIcon';\nimport { database as localDatabase, DatabaseContext } from '../../Database/Database';\nimport { DataContext } from '../../DataContext';\nimport { uiInput as input } from '../../Formula';\nimport useForceUpdate from '../../ReactHooks/useForceUpdate';\nimport usePromise from '../../ReactHooks/usePromise';\nimport { allSlotKeys, ArtifactSetKey, SlotKey } from '../../Types/consts';\nimport { objectKeyMap } from '../../Util/Util';\nimport StatDisplayComponent from '../../Components/Character/StatDisplayComponent';\n\nfunction CharacterArtifactPane({ newBuild = false }: { newBuild?: boolean }) {\n  const { data, oldData, character, mainStatAssumptionLevel } = useContext(DataContext)\n\n  const database = useContext(DatabaseContext)\n  const history = useHistory()\n  const edit = useCallback(\n    artid => history.push({\n      pathname: \"/artifact\",\n      artToEditId: artid\n    } as any), [history])\n  const artifactSheets = usePromise(ArtifactSheet.getAll, [])\n\n  // TODO: We can also listen only to equipped artifacts\n  const [, updateArt] = useForceUpdate()\n  useEffect(() => database.followAnyArt(updateArt))\n\n  const equipArts = useCallback(() => {\n    if (!window.confirm(\"Do you want to equip this artifact build to this character?\")) return\n    if (!oldData) return\n    const newBuild = Object.fromEntries(allSlotKeys.map(s => [s, data.get(input.art[s].id).value])) as Record<SlotKey, string>\n    database.equipArtifacts(character.key, newBuild)\n  }, [character, data, oldData, database])\n\n  const unequipArts = useCallback(() => {\n    if (!character) return\n    if (!window.confirm(\"Do you want to move all currently equipped artifacts to inventory?\")) return\n    database.equipArtifacts(character.key, objectKeyMap(allSlotKeys, _ => \"\"))\n  }, [character, database])\n  const artIds = allSlotKeys.map(slotKey => data.get(input.art[slotKey].id).value)\n  const artSetNums = Object.entries(input.artSet).map(([key, value]) => [key, data.get(value).value]) as [ArtifactSetKey, number][]\n  return <>\n    <CardLight sx={{ mb: 1 }}>\n      <CardContent>\n        <StatDisplayComponent />\n      </CardContent>\n      <Divider />\n      <CardContent sx={{ py: 1 }}>\n        <Grid container spacing={1}>\n          <Grid item>\n            {newBuild ? <Button onClick={equipArts} className=\"mr-2\">Equip artifacts</Button> : (database === localDatabase && <Button color=\"error\" onClick={unequipArts}>Unequip all artifacts</Button>)}\n          </Grid>\n          <Grid item flexGrow={1}></Grid>\n          <Grid item>{!!mainStatAssumptionLevel && <Card sx={{ p: 1, bgcolor: t => t.palette.warning.dark }}><Typography><strong>Assume Main Stats are Level {mainStatAssumptionLevel}</strong></Typography></Card>}</Grid>\n        </Grid>\n      </CardContent>\n    </CardLight>\n    <Grid container spacing={1}>\n      <Grid item xs={12} sm={6} md={4} display=\"flex\" flexDirection=\"column\" gap={1}>\n        {artifactSheets && ArtifactSheet.setEffects(artifactSheets, artSetNums).map(([setKey, setNumKeyArr]) =>\n          <CardLight key={setKey} sx={{ flexGrow: 1, }} >\n            <CardHeader avatar={<ImgIcon size={2} sx={{ m: -1 }} src={artifactSheets[setKey].defIconSrc} />} title={artifactSheets[setKey].name} titleTypographyProps={{ variant: \"subtitle1\" }} />\n            <Divider />\n            <CardContent >\n              <Grid container spacing={1} flexDirection=\"column\" height=\"100%\" >\n                <Grid item display=\"flex\" flexDirection=\"column\" gap={1}>\n                  {setNumKeyArr.map(setNumKey => <SetEffectDisplay key={setKey + setNumKey} setKey={setKey} setNumKey={setNumKey} />)}\n                </Grid>\n              </Grid>\n            </CardContent>\n          </CardLight>\n        )}\n      </Grid>\n      {artIds.map((id, i) =>\n        !!id && <Grid item xs={6} md={4} key={i} >\n          <ArtifactCard artifactId={id} mainStatAssumptionLevel={mainStatAssumptionLevel} onEdit={() => edit(id)} />\n        </Grid>\n      )}\n    </Grid>\n  </>\n}\nexport default CharacterArtifactPane\n","import { PersonAdd } from \"@mui/icons-material\";\nimport { CardContent, Divider, Grid } from \"@mui/material\";\nimport { Box } from \"@mui/system\";\nimport React, { useContext } from 'react';\nimport CardLight from \"../../Components/Card/CardLight\";\nimport CharacterDropdownButton from \"../../Components/Character/CharacterDropdownButton\";\nimport ConditionalDisplay from \"../../Components/ConditionalDisplay\";\nimport { NodeFieldDisplay } from \"../../Components/FieldDisplay\";\nimport resonanceSheets from \"../../Conditional/Resonance\";\nimport { ArtifactSheet } from \"../../Data/Artifacts/ArtifactSheet\";\nimport { DataContext, dataContextObj } from \"../../DataContext\";\nimport { uiInput as input } from \"../../Formula\";\nimport { NodeDisplay } from \"../../Formula/uiData\";\nimport useCharacterReducer from \"../../ReactHooks/useCharacterReducer\";\nimport useCharSelectionCallback from \"../../ReactHooks/useCharSelectionCallback\";\nimport usePromise from \"../../ReactHooks/usePromise\";\nimport { ElementKey } from \"../../Types/consts\";\nimport { DocumentSection } from \"../../Types/sheet\";\nimport { objPathValue, range } from \"../../Util/Util\";\nimport CharacterCard from \"../CharacterCard\";\n\nexport default function CharacterTeamBuffsPane() {\n  return <Box display=\"flex\" flexDirection=\"column\" gap={1} alignItems=\"stretch\">\n    <TeamBuffDisplay />\n    {/* <ResonanceDisplay characterKey={characterKey} build={build} /> */}\n    <Grid container spacing={1}>\n      {range(0, 2).map(i => <Grid item xs={12} md={6} lg={4} key={i}>\n        <TeammateDisplay index={i} />\n      </Grid>)}\n    </Grid>\n  </Box>\n}\nconst statBreakpoint = {\n  xs: 12, sm: 6, md: 6, lg: 4,\n} as const\nexport function TeamBuffDisplay() {\n  const { data, oldData } = useContext(DataContext)\n  const teamBuffs = data.getTeamBuff()\n  const nodes: Array<[string[], NodeDisplay<number>]> = []\n  Object.entries(teamBuffs.total ?? {}).forEach(([key, node]) => nodes.push([[\"total\", key], node]))\n  Object.entries(teamBuffs.premod ?? {}).forEach(([key, node]) => nodes.push([[\"premod\", key], node]))\n  Object.entries(teamBuffs.enemy ?? {}).forEach(([key, node]) => nodes.push([[\"enemy\", key], node]))\n  if (!nodes.length) return null\n  return <CardLight>\n    <CardContent>\n      Team Buffs\n    </CardContent>\n    <Divider />\n    <CardContent>\n      <Grid container columnSpacing={2} rowSpacing={1}>\n        {nodes.map(([path, n], i) => n && !n.isEmpty && <Grid item {...statBreakpoint} key={n.key} >\n          <NodeFieldDisplay node={n} oldValue={objPathValue(oldData?.getTeamBuff(), path)?.value} />\n        </Grid>)}\n      </Grid>\n    </CardContent>\n  </CardLight>\n}\nfunction ResonanceDisplay() {\n  const { data, characterDispatch } = useContext(DataContext)\n  return <CardLight>\n    <CardContent>\n      Team Resonance\n    </CardContent>\n    <Divider />\n    <CardContent>\n      <Grid container spacing={1}>\n        {/* {resonanceSheets.map((doc, i) =>\n          <Grid item key={i} xs={12} md={6} lg={4} >\n            <CardDark sx={{ opacity: doc.canShow(build) ? 1 : 0.5, height: \"100%\" }}>\n              <CardHeader avatar={doc?.header?.icon} title={doc?.header?.title} action={doc?.header?.action} titleTypographyProps={{ variant: \"subtitle2\" }} />\n              <Divider />\n              <CardContent>\n                {doc.description}\n              </CardContent>\n              {doc.conditionals.map(cond =>\n                <ConditionalDisplay key={cond.key} conditional={cond} stats={build} onChange={val => characterDispatch({ conditionalValues: val })} />\n              )}\n            </CardDark>\n          </Grid>\n        )} */}\n      </Grid>\n    </CardContent>\n  </CardLight>\n}\nfunction TeammateDisplay({ index }: { index: number }) {\n  const dataContext = useContext(DataContext)\n  const { character: active, teamData, characterDispatch: activeCharacterDispatch } = dataContext\n  const activeCharacterKey = active.key\n  const characterKey = active.team[index]\n  const characterDispatch = useCharacterReducer(characterKey)\n  // TODO: this UIData should be fed from the main CharacterDisplayCard for teams.\n  const onClickHandler = useCharSelectionCallback()\n\n  const dataBundle = teamData[characterKey]\n  const teamMateDataContext: dataContextObj | undefined = dataBundle && characterDispatch && {\n    character: dataBundle.character,\n    characterSheet: dataBundle.characterSheet,\n    data: dataBundle.target,\n    teamData: teamData,\n    mainStatAssumptionLevel: 0,\n    characterDispatch\n  }\n  return <CardLight>\n    <CardContent>\n      <CharacterDropdownButton fullWidth value={characterKey}\n        onChange={charKey => activeCharacterDispatch({ type: \"team\", index, charKey })}\n        filter={(_, ck) => ck !== activeCharacterKey && !active.team.includes(ck)} unSelectText={`Teammate ${index + 1}`} unSelectIcon={<PersonAdd />} />\n    </CardContent>\n    {teamMateDataContext && <DataContext.Provider value={teamMateDataContext}>\n      <CharacterCard characterKey={characterKey}\n        onClickHeader={onClickHandler}\n        artifactChildren={<CharArtifactCondDisplay dataContext={dataContext} />}\n        weaponChildren={<CharWeaponCondDisplay dataContext={dataContext} />}\n        characterChildren={<CharTalentCondDisplay dataContext={dataContext} />}\n      />\n    </DataContext.Provider>}\n  </CardLight>\n\n}\nfunction CharArtifactCondDisplay({ dataContext }: { dataContext: dataContextObj }) {\n  const artifactSheets = usePromise(ArtifactSheet.getAll, [])\n  if (!artifactSheets) return null\n  const sections = Object.values(artifactSheets).flatMap(s => Object.values(s.setEffects).flatMap(se => se?.document)).filter(d => d) as DocumentSection[]\n  return <DisplaySectionsTeamCond sections={sections} dataContext={dataContext} />\n}\nfunction CharWeaponCondDisplay({ dataContext }: { dataContext: dataContextObj }) {\n  const { data, teamData, character: { key: charKey } } = useContext(DataContext)\n  const weaponSheet = teamData[charKey]!.weaponSheet\n\n  return <DisplaySectionsTeamCond sections={weaponSheet.document} dataContext={dataContext} />\n}\nfunction CharTalentCondDisplay({ dataContext }: { dataContext: dataContextObj }) {\n  const { data, teamData, character: { key: charKey } } = useContext(DataContext)\n  const characterSheet = teamData[charKey]!.characterSheet\n  const talent = characterSheet.getTalent(data.get(input.charEle).value as ElementKey)!\n  const sections = Object.values(talent.sheets).flatMap(sts => sts.sections)\n  return <DisplaySectionsTeamCond sections={sections} dataContext={dataContext} />\n}\n\nfunction DisplaySectionsTeamCond({ sections, dataContext }: { sections: DocumentSection[], dataContext: dataContextObj }) {\n  return <Box display=\"flex\" flexDirection=\"column\" gap={1} pt={0} >\n    {sections.map(section => section.conditional?.teamBuff && <ConditionalDisplay conditional={section.conditional} fieldContext={dataContext} />)}\n  </Box >\n}\n","import { faEdit, faSave } from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { Badge, Box, Button, CardContent, CardMedia, Divider, Grid, Typography } from \"@mui/material\";\nimport React, { useContext, useState } from \"react\";\nimport Assets from \"../../Assets/Assets\";\nimport CardLight from \"../../Components/Card/CardLight\";\nimport ColorText from \"../../Components/ColoredText\";\nimport { NodeFieldDisplay } from \"../../Components/FieldDisplay\";\nimport ImgIcon from \"../../Components/Image/ImgIcon\";\nimport { Stars } from \"../../Components/StarDisplay\";\nimport StatIcon from \"../../Components/StatIcon\";\nimport { DataContext } from \"../../DataContext\";\nimport { valueString } from \"../../Formula/api\";\nimport { uiInput as input } from \"../../Formula\";\nimport { ReadNode } from \"../../Formula/type\";\nimport KeyMap from \"../../KeyMap\";\nimport useCharacterReducer from \"../../ReactHooks/useCharacterReducer\";\nimport { amplifyingReactions, transformativeReactions } from \"../../StatConstants\";\nimport { TalentSheetElementKey } from \"../../Types/character\";\nimport { allElementsWithPhy, ElementKey } from \"../../Types/consts\";\nimport WeaponDisplayCard from \"../../PageWeapon/WeaponDisplayCard\";\nimport CharacterSheet from \"../../Data/Characters/CharacterSheet\";\nimport StatInput from \"../StatInput\";\nimport { TeamBuffDisplay } from \"./CharacterTeamBuffsPane\";\nexport default function CharacterOverviewPane() {\n  const { data, characterSheet, character, character: { key: characterKey } } = useContext(DataContext)\n  const characterDispatch = useCharacterReducer(characterKey)\n  const charEle = data.get(input.charEle).value as ElementKey\n  const weaponTypeKey = characterSheet.weaponTypeKey\n  const level = data.get(input.lvl).value\n  const ascension = data.get(input.asc).value\n  const constellation = data.get(input.constellation).value\n  const tlvl = {\n    auto: data.get(input.total.auto).value,\n    skill: data.get(input.total.skill).value,\n    burst: data.get(input.total.burst).value,\n  }\n  const tBoost = {\n    auto: data.get(input.bonus.auto).value,\n    skill: data.get(input.bonus.skill).value,\n    burst: data.get(input.bonus.burst).value,\n  }\n  return <Grid container spacing={1}>\n    <Grid item xs={12} md={3}  >\n      {/* Image card with star and name and level */}\n      <CardLight >\n        <CardMedia src={characterSheet.cardImg} component=\"img\" width=\"100%\" height=\"auto\" />\n        <CardContent>\n          <Typography variant=\"h4\" >{characterSheet.name} <ImgIcon src={Assets.weaponTypes?.[weaponTypeKey]} /> {StatIcon[charEle]} </Typography>\n          <Typography variant=\"h6\"><Stars stars={characterSheet.rarity} colored /></Typography>\n          <Typography variant=\"h5\">Lvl. {CharacterSheet.getLevelString(level, ascension)}</Typography>\n          <Grid container spacing={1} mt={1}>\n            {([\"auto\", \"skill\", \"burst\"] as TalentSheetElementKey[]).map(tKey =>\n              <Grid item xs={4} key={tKey}>\n                <Badge badgeContent={tlvl[tKey]} color={tBoost[tKey] ? \"info\" : \"secondary\"}\n                  overlap=\"circular\"\n                  anchorOrigin={{\n                    vertical: 'bottom',\n                    horizontal: 'right',\n                  }}\n                  sx={{\n                    width: \"100%\",\n                    height: \"100%\",\n                    \"& > .MuiBadge-badge\": {\n                      fontSize: \"1.25em\",\n                      padding: \".25em .4em\",\n                      borderRadius: \".5em\",\n                      lineHeight: 1,\n                      height: \"1.25em\"\n                    }\n                  }}>\n                  <Box component=\"img\" src={characterSheet.getTalentOfKey(tKey, charEle)?.img} width=\"100%\" height=\"auto\" />\n                </Badge>\n              </Grid>)}\n          </Grid>\n          <Typography sx={{ textAlign: \"center\", mt: 1 }} variant=\"h6\">{characterSheet.constellationName}</Typography>\n          <Grid container spacing={1}>\n            {[...Array(6).keys()].map(i =>\n              <Grid item xs={4} key={i}>\n                <Box component=\"img\" src={characterSheet.getTalentOfKey(`constellation${i + 1}` as TalentSheetElementKey, charEle)?.img}\n                  sx={{\n                    cursor: \"pointer\",\n                    ...(constellation > i ? {} : { filter: \"brightness(50%)\" })\n                  }}\n                  width=\"100%\" height=\"auto\"\n                  onClick={() => characterDispatch({ constellation: (i + 1) === constellation ? i : i + 1 })} />\n              </Grid>)}\n          </Grid>\n        </CardContent>\n      </CardLight>\n    </Grid>\n    <Grid item xs={12} md={9} sx={{\n      \"> div:not(:last-child)\": { mb: 1 }\n    }} >\n      <WeaponDisplayCard weaponId={character.equippedWeapon} />\n      <MainStatsCards />\n    </Grid>\n  </Grid >\n}\nconst EDIT = \"Edit Stats\"\nconst EXIT = \"EXIT\"\n\nconst mainBaseKeys = [\"atk\", \"hp\", \"def\"] as const\nconst mainSubKeys = [\"eleMas\", \"critRate_\", \"critDMG_\", \"enerRech_\", \"heal_\"] as const\nconst mainReadNodes = [...mainBaseKeys, ...mainSubKeys].map(k => input.total[k])\nconst mainEditKeys = [\"atk_\", \"atk\", \"hp_\", \"hp\", \"def_\", \"def\", ...mainSubKeys] as const\n\nconst otherStatReadNodes = [\n  ...allElementsWithPhy.map(ele => input.total[`${ele}_dmg_`]),\n  ...allElementsWithPhy.map(ele => input.total[`${ele}_res_`]),\n  ...([\"stamina\", \"incHeal_\", \"shield_\", \"cdRed_\"] as const).map(x => input.total[x])\n]\nconst otherStatKeys = otherStatReadNodes.map(x => x.info!.key!)\n\nconst miscStatReadNodes = [\n  input.total.all_dmg_,\n  ...allElementsWithPhy.map(x => input.total[`${x}_enemyRes_`]),\n  input.total.normal_dmg_, input.total.normal_critRate_,\n  input.total.charged_dmg_, input.total.charged_critRate_,\n  input.total.plunging_dmg_, input.total.plunging_critRate_,\n  input.total.skill_dmg_, input.total.skill_critRate_,\n  input.total.burst_dmg_, input.total.burst_critRate_,\n  ...Object.keys(transformativeReactions).map(x => input.total[`${x}_dmg_`]),\n  ...Object.keys(amplifyingReactions).map(x => input.total[`${x}_dmg_`]),\n  ...([\"moveSPD_\", \"atkSPD_\", \"weakspotDMG_\"] as const).map(x => input.total[x])\n]\nconst miscStatkeys = miscStatReadNodes.map(x => x.info!.key!)\n\nconst statBreakpoint = {\n  xs: 12, sm: 6, md: 6, lg: 4,\n} as const\n\nfunction StatDisplayContent({ nodes, statBreakpoint, extra }: { nodes: ReadNode<number>[], statBreakpoint: object, extra?: Displayable }) {\n  const { data, oldData } = useContext(DataContext)\n  return <Grid container columnSpacing={{ xs: 2, lg: 3 }} rowSpacing={1}>\n    {nodes.map((rn, i) => <Grid item key={i} {...statBreakpoint} >\n      {<NodeFieldDisplay node={data.get(rn)} oldValue={oldData?.get(rn)?.value} />}\n    </Grid>)}\n    {extra}\n  </Grid>\n}\n\nfunction MainStatsCards() {\n  const { data, character, character: { key: characterKey } } = useContext(DataContext)\n  const characterDispatch = useCharacterReducer(characterKey)\n  const specialNode = data.get(input.special)\n\n  return <>\n    <TeamBuffDisplay />\n    <StatDisplayCard\n      title=\"Main Stats\"\n      content={<StatDisplayContent statBreakpoint={statBreakpoint} nodes={mainReadNodes}\n        extra={specialNode && <Grid item {...statBreakpoint} display=\"flex\" flexDirection=\"row\" justifyContent=\"space-between\">\n          <span><b>Special:</b> <ColorText color={specialNode.variant}>{specialNode.key && StatIcon[specialNode.key]} {specialNode.key && KeyMap.get(specialNode.key)}</ColorText></span>\n          <span >{valueString(specialNode.value, specialNode.unit)}</span>\n        </Grid>}\n      />}\n      editContent={<Grid container columnSpacing={2} rowSpacing={1}>\n        {mainEditKeys.map(statKey => {\n          const statName = KeyMap.get(statKey)\n          return <Grid item xs={12} lg={6} key={statKey}>\n            <StatInput\n              name={<span>{StatIcon[statKey]} {statName}</span>}\n              placeholder={KeyMap.getStr(statKey)}\n              value={character.bonusStats[statKey] ?? 0}\n              percent={KeyMap.unit(statKey) === \"%\"}\n              onValueChange={value => characterDispatch({ type: \"editStats\", statKey, value })}\n            />\n          </Grid>\n        })}\n      </Grid>}\n    />\n    <StatDisplayCard\n      title=\"Other Stats\"\n      content={<StatDisplayContent statBreakpoint={statBreakpoint} nodes={otherStatReadNodes} />}\n      editContent={<Grid container columnSpacing={2} rowSpacing={1}>\n        {otherStatKeys.map(statKey => {\n          const statName = KeyMap.get(statKey)\n          return <Grid item xs={12} lg={6} key={statKey}>\n            <StatInput\n              name={<span>{StatIcon[statKey]} {statName}</span>}\n              placeholder={KeyMap.getStr(statKey)}\n              value={character.bonusStats[statKey] ?? 0}\n              percent={KeyMap.unit(statKey) === \"%\"}\n              defaultValue={undefined}\n              onValueChange={value => characterDispatch({ type: \"editStats\", statKey, value })}\n            />\n          </Grid>\n        })}\n      </Grid>}\n    />\n    <StatDisplayCard\n      title=\"Misc Stats\"\n      content={<StatDisplayContent statBreakpoint={{\n        xs: 12, sm: 6, md: 6,\n      }} nodes={miscStatReadNodes} />}\n      editContent={<Grid container columnSpacing={2} rowSpacing={1}>\n        {miscStatkeys.map(statKey => {\n          const statName = KeyMap.get(statKey)\n          return <Grid item xs={12} lg={6} key={statKey}>\n            <StatInput\n              name={<span>{StatIcon[statKey]} {statName}</span>}\n              placeholder={KeyMap.getStr(statKey)}\n              value={character.bonusStats[statKey] ?? 0}\n              percent={KeyMap.unit(statKey) === \"%\"}\n              onValueChange={value => characterDispatch({ type: \"editStats\", statKey, value })}\n            />\n          </Grid>\n        })}\n      </Grid>}\n    />\n  </>\n}\nfunction StatDisplayCard({ title, content, editContent }) {\n  const [edit, setedit] = useState(false)\n  return <CardLight>\n    <CardContent sx={{ py: 1 }}>\n      <Box display=\"flex\" justifyContent=\"space-between\">\n        <Typography variant=\"subtitle1\">{title}</Typography>\n        <Button size=\"small\" color={edit ? \"error\" : \"info\"} onClick={() => setedit(!edit)} >\n          <span><FontAwesomeIcon icon={edit ? faSave : faEdit} /> {edit ? EXIT : EDIT}</span>\n        </Button>\n      </Box>\n    </CardContent>\n    <Divider />\n    <CardContent>\n      {edit ? editContent : content}\n    </CardContent>\n  </CardLight>\n}\n","import { faQuestionCircle } from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { Box, CardActionArea, CardContent, Divider, Grid, MenuItem, Typography } from \"@mui/material\";\nimport React, { useCallback, useContext, useState } from 'react';\nimport BootstrapTooltip from \"../../Components/BootstrapTooltip\";\nimport CardDark from \"../../Components/Card/CardDark\";\nimport CardLight from \"../../Components/Card/CardLight\";\nimport ColorText from \"../../Components/ColoredText\";\nimport ConditionalWrapper from \"../../Components/ConditionalWrapper\";\nimport DocumentDisplay from \"../../Components/DocumentDisplay\";\nimport DropdownButton from \"../../Components/DropdownMenu/DropdownButton\";\nimport StatIcon from \"../../Components/StatIcon\";\nimport useCharacterReducer from \"../../ReactHooks/useCharacterReducer\";\nimport { TalentSheetElementKey } from \"../../Types/character\";\nimport { DataContext } from '../../DataContext';\nimport { uiInput as input } from \"../../Formula\";\nimport { ElementKey } from \"../../Types/consts\";\nimport KeyMap from '../../KeyMap'\nimport { NodeDisplay, valueString } from '../../Formula/uiData'\nimport { NumNode } from \"../../Formula/type\";\nexport default function CharacterTalentPane() {\n  const { data, character, characterSheet } = useContext(DataContext)\n  const characterDispatch = useCharacterReducer(character.key)\n  const skillBurstList = [[\"auto\", \"Normal/Charged Attack\"], [\"skill\", \"Elemental Skill\"], [\"burst\", \"Elemental Burst\"]] as [TalentSheetElementKey, string][]\n  const passivesList: [tKey: TalentSheetElementKey, tText: string, asc: number][] = [[\"passive1\", \"Unlocked at Ascension 1\", 1], [\"passive2\", \"Unlocked at Ascension 4\", 4], [\"passive3\", \"Unlocked by Default\", 0]]\n  const charEle = data.get(input.charEle).value as ElementKey | undefined\n  const ascension = data.get(input.asc).value\n  const constellation = data.get(input.constellation).value\n  return <>\n    <ReactionDisplay />\n    <Grid container spacing={1} sx={{ mb: 1 }}>\n      {/* auto, skill, burst */}\n      {skillBurstList.map(([tKey, tText]) =>\n        <Grid item key={tKey} xs={12} md={6} lg={4} >\n          <SkillDisplayCard\n            talentKey={tKey}\n            subtitle={tText}\n          />\n        </Grid>)}\n      {!!characterSheet.getTalentOfKey(\"sprint\", charEle) && <Grid item xs={12} md={6} lg={4} >\n        <SkillDisplayCard\n          talentKey=\"sprint\"\n          subtitle=\"Alternative Sprint\"\n        />\n      </Grid>}\n      {!!characterSheet.getTalentOfKey(\"passive\", charEle) && <Grid item xs={12} md={6} lg={4} >\n        <SkillDisplayCard\n          talentKey=\"passive\"\n          subtitle=\"Passive\"\n        />\n      </Grid>}\n    </Grid>\n    <Grid container spacing={1}>\n      {/* passives */}\n      {passivesList.map(([tKey, tText, asc]) => {\n        let enabled = ascension >= asc\n        if (!characterSheet.getTalentOfKey(tKey, charEle)) return null\n        return <Grid item key={tKey} style={{ opacity: enabled ? 1 : 0.5 }} xs={12} md={4} >\n          <SkillDisplayCard\n            talentKey={tKey}\n            subtitle={tText}\n          />\n        </Grid>\n      })}\n    </Grid>\n    <Typography variant=\"h6\" sx={{ textAlign: \"center\" }}>Constellation Lv. {constellation}</Typography>\n    <Grid container spacing={1}>\n      {/* constellations */}\n      {[...Array(6).keys()].map(i => {\n        let tKey = `constellation${i + 1}` as TalentSheetElementKey\n        return <Grid item key={i} xs={12} md={4}\n          sx={{ opacity: constellation > i ? 1 : 0.5 }}>\n          <SkillDisplayCard\n            talentKey={tKey}\n            subtitle={`Contellation Lv. ${i + 1}`}\n            onClickTitle={() => characterDispatch({ constellation: (i + 1) === constellation ? i : i + 1 })}\n          />\n        </Grid>\n      })}\n    </Grid>\n  </>\n}\nconst ReactionComponents = {\n  superconduct: SuperConductCard,\n  electrocharged: ElectroChargedCard,\n  overloaded: OverloadedCard,\n  pyroSwirl: SwirlCard,// TODO: Assumes if character can pyro swirl, it can swirl every element. This behaviour will need to be changed for characters that can only swirl specific elements.\n  shattered: ShatteredCard,\n  // crystalize_hit: CrystalizeCard, // TODO: crystallize\n}\nfunction ReactionDisplay() {\n  const { data } = useContext(DataContext)\n  const reaction = data.getDisplay().reaction as { [key: string]: NodeDisplay }\n  return <CardLight sx={{ mb: 1 }}>\n    <CardContent>\n      <Grid container spacing={1}>\n        {Object.entries(reaction).map(([key, node]) => {\n          const Ele = ReactionComponents[key]\n          if (!Ele) return null\n          return <Grid item key={key}><Ele node={node} /></Grid>\n        })}\n      </Grid>\n    </CardContent>\n  </CardLight>\n}\nfunction SuperConductCard({ node }: { node: NodeDisplay }) {\n  return <CardDark><CardContent sx={{ p: 1 }}>\n    <Typography color=\"superconduct.main\">{KeyMap.get(node.key!)} {StatIcon.electro}+{StatIcon.cryo} <strong>{valueString(node.value, node.unit)}</strong></Typography>\n  </CardContent></CardDark>\n}\nfunction ElectroChargedCard({ node }: { node: NodeDisplay }) {\n  return <CardDark><CardContent sx={{ p: 1 }}>\n    <Typography color=\"electrocharged.main\">{KeyMap.get(node.key!)} {StatIcon.electro}+{StatIcon.hydro} <strong>{valueString(node.value, node.unit)}</strong></Typography>\n  </CardContent></CardDark>\n}\nfunction OverloadedCard({ node }: { node: NodeDisplay }) {\n  return <CardDark><CardContent sx={{ p: 1 }}>\n    <Typography color=\"overloaded.main\" >{KeyMap.get(node.key!)} {StatIcon.electro}+{StatIcon.pyro} <strong>{valueString(node.value, node.unit)}</strong></Typography>\n  </CardContent></CardDark>\n}\n\nconst swirlEleToDisplay = {\n  \"pyro\": <span><ColorText color=\"pyro\">{KeyMap.get(\"pyro_swirl_hit\")}</ColorText> {StatIcon.pyro} + {StatIcon.anemo}</span>,\n  \"electro\": <span><ColorText color=\"electro\">{KeyMap.get(\"electro_swirl_hit\")}</ColorText> {StatIcon.electro}+{StatIcon.anemo}</span>,\n  \"cryo\": <span><ColorText color=\"cryo\">{KeyMap.get(\"cryo_swirl_hit\")}</ColorText> {StatIcon.cryo} + {StatIcon.anemo}</span>,\n  \"hydro\": <span><ColorText color=\"hydro\">{KeyMap.get(\"hydro_swirl_hit\")}</ColorText> {StatIcon.hydro} + {StatIcon.anemo}</span>\n} as const\nfunction SwirlCard() {\n  const [ele, setele] = useState(Object.keys(swirlEleToDisplay)[0])\n  const { data } = useContext(DataContext)\n  const node = data.getDisplay().reaction![`${ele}Swirl`]!\n  return <CardDark sx={{ display: \"flex\" }}>\n    <DropdownButton size=\"small\" title={swirlEleToDisplay[ele]} color=\"success\">\n      {Object.entries(swirlEleToDisplay).map(([key, element]) => <MenuItem key={key} selected={ele === key} disabled={ele === key} onClick={() => setele(key)}>{element}</MenuItem>)}\n    </DropdownButton>\n    <Box sx={{ color: `${ele}.main`, p: 1 }}><strong>{valueString(node.value, node.unit)}</strong></Box>\n  </CardDark>\n}\nfunction ShatteredCard({ node }: { node: NodeDisplay }) {\n  const information = <BootstrapTooltip placement=\"top\" title={<Typography>Claymores, Plunging Attacks and <ColorText color=\"geo\">Geo DMG</ColorText></Typography>}>\n    <Box component=\"span\" sx={{ cursor: \"help\" }}><FontAwesomeIcon icon={faQuestionCircle} /></Box>\n  </BootstrapTooltip>\n\n  return <CardDark><CardContent sx={{ p: 1 }}>\n    <ColorText color=\"shattered\">{KeyMap.get(node.key!)} {StatIcon.hydro}+{StatIcon.cryo}+ <ColorText color=\"physical\"><small>Heavy Attack{information} </small></ColorText> <strong>{valueString(node.value, node.unit)}</strong></ColorText>\n  </CardContent></CardDark>\n}\n// TODO: crystallize\nconst crystalizeEleToDisplay = {\n  \"default\": <ColorText color=\"crystalize\">{KeyMap.get(\"crystalize_hit\")} {StatIcon.electro}/{StatIcon.hydro}/{StatIcon.pyro}/{StatIcon.cryo}+{StatIcon.geo}</ColorText>,\n  \"pyro\": <span>{KeyMap.get(\"pyro_crystalize_hit\")} {StatIcon.pyro}+{StatIcon.geo}</span>,\n  \"electro\": <span>{KeyMap.get(\"electro_crystalize_hit\")} {StatIcon.electro}+{StatIcon.geo}</span>,\n  \"cryo\": <span>{KeyMap.get(\"cryo_crystalize_hit\")} {StatIcon.cryo}+{StatIcon.geo}</span>,\n  \"hydro\": <span>{KeyMap.get(\"hydro_crystalize_hit\")} {StatIcon.hydro}+{StatIcon.geo}</span>\n} as const\nfunction CrystalizeCard() {\n  const [ele, setele] = useState(Object.keys(crystalizeEleToDisplay)[0])\n  const sKey = ele === \"default\" ? \"crystalize_hit\" : `${ele}_crystalize_hit`\n  return <CardDark sx={{ display: \"flex\" }}>\n    <DropdownButton size=\"small\" title={crystalizeEleToDisplay[ele]} color=\"success\">\n      {Object.entries(crystalizeEleToDisplay).map(([key, element]) => <MenuItem key={key} selected={ele === key} disabled={ele === key} onClick={() => setele(key)}>{element}</MenuItem>)}\n    </DropdownButton>\n    {/* <Box sx={{ color: `${ele}.main`, p: 1 }}><strong>{stats[sKey]?.toFixed(Stat.fixedUnit(sKey))}</strong></Box> */}\n  </CardDark>\n}\n\nconst talentLimits = [1, 1, 2, 4, 6, 8, 10]\ntype SkillDisplayCardProps = {\n  talentKey: TalentSheetElementKey,\n  subtitle: string,\n  onClickTitle?: (any) => any\n}\nfunction SkillDisplayCard({ talentKey, subtitle, onClickTitle }: SkillDisplayCardProps) {\n  const { data, character: { talent }, characterSheet, characterDispatch } = useContext(DataContext)\n\n  const actionWrapeprFunc = useCallback(\n    children => <CardActionArea onClick={onClickTitle}>{children}</CardActionArea>,\n    [onClickTitle],\n  )\n\n  let header: Displayable | null = null\n\n  if (talentKey in talent) {\n    const levelBoost = data.get(input.bonus[talentKey] as NumNode).value\n    const level = data.get(input.total[talentKey]).value\n    const asc = data.get(input.asc).value\n    const setTalentLevel = (tKey, newTalentLevelKey) => {\n      talent[tKey] = newTalentLevelKey\n      characterDispatch({ talent })\n    }\n    header = <>\n      <CardContent sx={{ py: 1 }}>\n        <DropdownButton fullWidth title={`Talent Lv. ${level}`} color={levelBoost ? \"info\" : \"primary\"}>\n          {[...Array(talentLimits[asc]).keys()].map(i =>\n            <MenuItem key={i} selected={talent[talentKey] === (i + 1)} disabled={talent[talentKey] === (i + 1)} onClick={() => setTalentLevel(talentKey, i + 1)}>Talent Lv. {i + levelBoost + 1}</MenuItem>)}\n        </DropdownButton>\n      </CardContent>\n      <Divider />\n    </>\n  }\n  const talentSheet = characterSheet.getTalentOfKey(talentKey, data.get(input.charEle).value as ElementKey | undefined)\n\n  return <CardLight sx={{ height: \"100%\" }}>\n    {header}\n    <CardContent>\n      <ConditionalWrapper condition={!!onClickTitle} wrapper={actionWrapeprFunc} >\n        <Grid container sx={{ flexWrap: \"nowrap\" }}>\n          <Grid item>\n            <Box component=\"img\" src={talentSheet?.img} sx={{ width: 60, height: \"auto\" }} />\n          </Grid>\n          <Grid item flexGrow={1} sx={{ pl: 1 }}>\n            <Typography variant=\"h6\">{talentSheet?.name}</Typography>\n            <Typography variant=\"subtitle1\">{subtitle}</Typography>\n          </Grid>\n        </Grid>\n      </ConditionalWrapper>\n      {/* Display document sections */}\n      {talentSheet?.sections ? <DocumentDisplay sections={talentSheet.sections} /> : null}\n    </CardContent>\n  </CardLight>\n}\n","import { Button, ButtonGroup, Card, CardContent, Divider, Grid, MenuItem, Skeleton, Tab, Tabs, ToggleButton, Typography } from '@mui/material';\nimport { Suspense, useCallback, useContext, useState } from 'react';\nimport CardDark from '../Components/Card/CardDark';\nimport CardLight from '../Components/Card/CardLight';\nimport { CharacterSelectionModal } from '../Components/Character/CharacterSelectionModal';\nimport ThumbSide from '../Components/Character/ThumbSide';\nimport CloseButton from '../Components/CloseButton';\nimport ColorText from '../Components/ColoredText';\nimport CustomNumberInput, { CustomNumberInputButtonGroupWrapper } from '../Components/CustomNumberInput';\nimport DropdownButton from '../Components/DropdownMenu/DropdownButton';\nimport { EnemyExpandCard } from '../Components/EnemyEditor';\nimport FormulaCalcCard from '../Components/FormulaCalcCard';\nimport { DamageOptionsCard } from '../Components/HitModeEditor';\nimport SolidToggleButtonGroup from '../Components/SolidToggleButtonGroup';\nimport { sgt } from '../Data/Characters/SheetUtil';\nimport { ambiguousLevel, ascensionMaxLevel, milestoneLevels } from '../Data/LevelData';\nimport { DataContext, dataContextObj, TeamData } from '../DataContext';\nimport useCharacterReducer from '../ReactHooks/useCharacterReducer';\nimport useCharSelectionCallback from '../ReactHooks/useCharSelectionCallback';\nimport useTeamData from '../ReactHooks/useTeamData';\nimport { CharacterKey } from '../Types/consts';\nimport { clamp } from '../Util/Util';\nimport CharacterArtifactPane from './CharacterDisplay/CharacterArtifactPane';\nimport CharacterOverviewPane from './CharacterDisplay/CharacterOverviewPane';\nimport CharacterTalentPane from './CharacterDisplay/CharacterTalentPane';\nimport CharacterTeamBuffsPane from './CharacterDisplay/CharacterTeamBuffsPane';\n\ninterface TabPanelProps {\n  children?: React.ReactNode;\n  value: string;\n  current: string | boolean;\n}\n\nfunction TabPanel({ children, current, value, ...other }: TabPanelProps) {\n  if (value !== current) return null\n  return <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={1000} />}>\n    <div\n      role=\"tabpanel\"\n      hidden={value !== current}\n      id={`simple-tabpanel-${value}`}\n      aria-labelledby={`simple-tab-${value}`}\n      {...other}\n    >\n      {children}\n    </div>\n  </Suspense>\n}\n\ntype CharacterDisplayCardProps = {\n  characterKey: CharacterKey,\n  footer?: JSX.Element\n  newteamData?: TeamData,\n  mainStatAssumptionLevel?: number,\n  onClose?: (any) => void,\n  tabName?: string,\n  isFlex?: boolean,\n}\nexport default function CharacterDisplayCard({ characterKey, footer, newteamData, mainStatAssumptionLevel = 0, onClose, tabName, isFlex }: CharacterDisplayCardProps) {\n  const teamData = useTeamData(characterKey, mainStatAssumptionLevel)\n  const { character, characterSheet, target: charUIData } = teamData?.[characterKey] ?? {}\n\n  // set initial state to false, because it fails to check validity of the tab values on 1st load\n  const [tab, settab] = useState<string | boolean>(tabName ? tabName : (newteamData ? \"newartifacts\" : \"character\"))\n  const onTab = useCallback((e, v) => settab(v), [settab])\n\n  const characterDispatch = useCharacterReducer(character?.key ?? \"\")\n  if (!teamData || !character || !characterSheet || !charUIData) return <></>\n  const { compareData } = character\n  // main CharacterDisplayCard\n  const dataContextValue: dataContextObj = {\n    character,\n    characterSheet,\n    mainStatAssumptionLevel,\n    data: (newteamData ? newteamData[characterKey]!.target : charUIData),\n    teamData: (newteamData ? newteamData : teamData),\n    oldData: (compareData && newteamData) ? charUIData : undefined,\n    characterDispatch\n  }\n  return <CardDark >\n    <DataContext.Provider value={dataContextValue}>\n      <CardContent sx={{\n        \"> div:not(:last-child)\": { mb: 1 },\n      }}>\n        <Grid container spacing={1}>\n          <Grid item>\n            <CharSelectDropdown />\n          </Grid>\n          <Grid item>\n            {/* Compare against new build toggle */}\n            {!!newteamData && <SolidToggleButtonGroup exclusive value={compareData} onChange={(e, v) => characterDispatch({ compareData: v })} size=\"small\">\n              <ToggleButton value={false} disabled={!compareData}>\n                <small>Show New artifact Stats</small>\n              </ToggleButton>\n              <ToggleButton value={true} disabled={compareData}>\n                <small>Compare against equipped artifacts</small>\n              </ToggleButton>\n            </SolidToggleButtonGroup>}\n          </Grid>\n          <Grid item flexGrow={1} />\n          {!!mainStatAssumptionLevel && <Grid item><Card sx={{ p: 1, bgcolor: t => t.palette.warning.dark }}><Typography><strong>Assume Main Stats are Level {mainStatAssumptionLevel}</strong></Typography></Card></Grid>}\n          {!!onClose && <Grid item>\n            <CloseButton onClick={onClose} />\n          </Grid>}\n        </Grid>\n        <CardLight>\n          <Tabs\n            onChange={onTab}\n            value={tab}\n            variant=\"fullWidth\"\n          >\n            <Tab value=\"character\" label=\"Character\" />\n            {!!newteamData && <Tab value=\"newartifacts\" label=\"New Artifacts\" />}\n            <Tab value=\"artifacts\" label={newteamData ? \"Current Artifacts\" : \"Artifacts\"} />\n            {!isFlex && <Tab value=\"buffs\" label=\"Team Buffs\" />}\n            <Tab value=\"talent\" label=\"Talents\" />\n          </Tabs>\n        </CardLight>\n        <DamageOptionsCard />\n        <FormulaCalcCard />\n        <EnemyExpandCard />\n\n        {/* Character Panel */}\n        <TabPanel value=\"character\" current={tab}><CharacterOverviewPane /></TabPanel >\n        {/* Artifacts Panel */}\n        <DataContext.Provider value={{ ...dataContextValue, data: charUIData, oldData: undefined }}>\n          <TabPanel value=\"artifacts\" current={tab} ><CharacterArtifactPane /></TabPanel >\n        </DataContext.Provider>\n        {/* new build panel */}\n        <TabPanel value=\"newartifacts\" current={tab} ><CharacterArtifactPane newBuild /></TabPanel >\n        {/* Buffs panel */}\n        <TabPanel value=\"buffs\" current={tab}><CharacterTeamBuffsPane /></TabPanel >\n        {/* talent panel */}\n        <TabPanel value=\"talent\" current={tab}>\n          <CharacterTalentPane />\n        </TabPanel >\n      </CardContent>\n      {!!footer && <Divider />}\n      {footer && <CardContent >\n        {footer}\n      </CardContent>}\n    </DataContext.Provider>\n  </CardDark>\n}\n\n\nfunction CharSelectDropdown() {\n  const { character, characterSheet, characterDispatch } = useContext(DataContext)\n  const [showModal, setshowModal] = useState(false)\n  const setCharacter = useCharSelectionCallback()\n  const setLevel = useCallback((level) => {\n    level = clamp(level, 1, 90)\n    const ascension = ascensionMaxLevel.findIndex(ascenML => level <= ascenML)\n    characterDispatch({ level, ascension })\n  }, [characterDispatch])\n  const setAscension = useCallback(() => {\n    if (!character) return\n    const { level = 1, ascension = 0 } = character\n    const lowerAscension = ascensionMaxLevel.findIndex(ascenML => level !== 90 && level === ascenML)\n    if (ascension === lowerAscension) characterDispatch({ ascension: ascension + 1 })\n    else characterDispatch({ ascension: lowerAscension })\n  }, [characterDispatch, character])\n  const { elementKey = \"anemo\", level = 1, ascension = 0 } = character\n  return <>\n    <CharacterSelectionModal show={showModal} onHide={() => setshowModal(false)} onSelect={setCharacter} />\n    <Grid container spacing={1}>\n      <Grid item>\n        <Button onClick={() => setshowModal(true)} startIcon={<ThumbSide src={characterSheet?.thumbImgSide} />} >{characterSheet?.name ?? \"Select a Character\"}</Button>\n      </Grid>\n      <Grid item>\n        <ButtonGroup sx={{ bgcolor: t => t.palette.contentDark.main }} >\n          {characterSheet?.sheet && \"talents\" in characterSheet?.sheet && <DropdownButton title={<strong><ColorText color={elementKey}>{sgt(`element.${elementKey}`)}</ColorText></strong>}>\n            {Object.keys(characterSheet.sheet.talents).map(eleKey =>\n              <MenuItem key={eleKey} selected={elementKey === eleKey} disabled={elementKey === eleKey} onClick={() => characterDispatch({ elementKey: eleKey })}>\n                <strong><ColorText color={eleKey}>{sgt(`element.${eleKey}`)}</ColorText></strong></MenuItem>)}\n          </DropdownButton>}\n          <CustomNumberInputButtonGroupWrapper >\n            <CustomNumberInput onChange={setLevel} value={level}\n              startAdornment=\"Lvl. \"\n              inputProps={{ min: 1, max: 90, sx: { textAlign: \"center\" } }}\n              sx={{ width: \"100%\", height: \"100%\", pl: 2 }}\n              disabled={!characterSheet} />\n          </CustomNumberInputButtonGroupWrapper>\n          <Button sx={{ pl: 1 }} disabled={!ambiguousLevel(level) || !characterSheet} onClick={setAscension}><strong>/ {ascensionMaxLevel[ascension]}</strong></Button>\n          <DropdownButton title={\"Select Level\"} disabled={!characterSheet}>\n            {milestoneLevels.map(([lv, as]) => {\n              const sameLevel = lv === ascensionMaxLevel[as]\n              const lvlstr = sameLevel ? `Lv. ${lv}` : `Lv. ${lv}/${ascensionMaxLevel[as]}`\n              const selected = lv === level && as === ascension\n              return <MenuItem key={`${lv}/${as}`} selected={selected} disabled={selected} onClick={() => characterDispatch({ level: lv, ascension: as })}>{lvlstr}</MenuItem>\n            })}\n          </DropdownButton>\n        </ButtonGroup>\n      </Grid>\n    </Grid>\n  </>\n}\n"],"sourceRoot":""}