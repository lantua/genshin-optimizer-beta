"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[821],{56748:(e,t,n)=>{n.d(t,{Z:()=>i});const i=(0,n(65992).ZP)("img")((({theme:e})=>({display:"inline-block",width:"auto",height:"2.3em",lineHeight:1,verticalAlign:"text-bottom",marginTop:e.spacing(-3),marginLeft:e.spacing(-1.25),marginRight:e.spacing(-1),marginBottom:e.spacing(-1)})))},57889:(e,t,n)=>{function i({condition:e,wrapper:t,falseWrapper:n,children:i}){return e?t(i):n?n(i):i}n.d(t,{Z:()=>i})},71765:(e,t,n)=>{n.d(t,{q:()=>r});var i=n(78437),a=n(2344),l=n(52903);const r=({stars:e=1,colored:t=!1,inline:n=!1})=>(0,l.tZ)(a.Z,{color:t?"warning":void 0,children:[...Array(e).keys()].map(((e,t)=>(0,l.tZ)(i.Z,{fontSize:n?"inherit":void 0,sx:n?{verticalAlign:"text-top"}:void 0},t)))})},6286:(e,t,n)=>{n.r(t),n.d(t,{default:()=>$s});var i=n(96e3),a=n(85439),l=n(36380),r=n(61391),s=n(60319),c=n(68826),o=n(32782),d=n(67550),u=n(79906),Z=n(7671),h=n(38484),p=n(78287),m=n(83249),f=n(2784),g=n(21548),x=n(73557),b=n(39857),y=n(87985),v=n(67937),C=n(72055),w=n(69360),B=n(97859),k=n(83673),S=n(53710),X=n(790),P=n(63762);const j=(0,f.createContext)({});var K=n(70630),O=n(25870),E=n(94657),D=n(44304),T=n(50670),I=n(10002),A=n(44942),M=n(47165),R=n(36893),_=n(20536),G=n(65396),z=n(56748),L=n(97856),$=n(52903);const N=f.lazy((()=>Promise.all([n.e(592),n.e(26)]).then(n.bind(n,1296))));function W(){var e;const{t}=(0,g.$G)("page_character"),{characterSheet:n,character:{key:i}}=(0,f.useContext)(S.K),[a,l]=(0,f.useState)(!1),{gender:r}=(0,I.Z)(),s=(0,L.Z)();return(0,$.BX)($.HY,{children:[(0,$.tZ)(f.Suspense,{fallback:!1,children:(0,$.tZ)(N,{show:a,onHide:()=>l(!1),onSelect:s})}),(0,$.tZ)(m.Z,{color:"info",onClick:()=>l(!0),startIcon:(0,$.tZ)(z.Z,{src:(0,G.Li)(i,"iconSide",r)}),children:null!=(e=null==n?void 0:n.name)?e:t("selectCharacter")})]})}var V=n(84485),q=n(42523),F=n(56961),H=n(23570),U=n(2995),Y=n(62197),J=n(35322),Q=n(17447),ee=n(86113),te=n(2344),ne=n(26578),ie=n(98927),ae=n(99625),le=n(61278);function re(){const{modalOpen:e}=(0,f.useContext)(P.M),{setFormulaData:t}=(0,f.useContext)(P.M),n=(0,f.useCallback)((()=>null==t?void 0:t(void 0,void 0)),[t]);return(0,$.tZ)(ie.Z,{open:!!e,onClose:n,children:(0,$.BX)(y.Z,{children:[(0,$.tZ)(q.Z,{title:"Formulas & Calculations",action:(0,$.tZ)(C.Z,{onClick:n})}),(0,$.tZ)(Z.Z,{sx:{pt:0},children:(0,$.tZ)(se,{})})]})})}function se(){const{data:e}=(0,f.useContext)(X.R),{data:t}=(0,f.useContext)(P.M),n=(0,ae.U)(null!=t?t:e);return(0,$.tZ)(f.Suspense,{fallback:(0,$.tZ)(u.Z,{variant:"rectangular",width:"100%",height:1e3}),children:(0,$.tZ)(d.Z,{sx:{mr:-1,mb:-1},children:n.map((([e,t])=>(0,$.tZ)(ce,{displayNs:t,sectionKey:e},e)))})})}function ce({sectionKey:e,displayNs:t}){const{data:n}=(0,f.useContext)(X.R),{database:i}=(0,f.useContext)(O.t),{data:a}=(0,f.useContext)(P.M),l=(0,f.useMemo)((()=>(0,ae.f)(null!=a?a:n,e,i)),[i,a,n,e]);if(!l)return null;if(Object.entries(t).every((([e,t])=>t.isEmpty)))return null;const{title:r,icon:s,action:c}=l;return(0,$.BX)(v.Z,{sx:{mb:1},children:[(0,$.tZ)(ee.Z,{avatar:s&&(0,$.tZ)(ne.Z,{size:2,src:s}),title:r,action:c&&(0,$.tZ)(k.Z,{children:c})}),(0,$.tZ)(F.Z,{}),(0,$.tZ)(Z.Z,{children:Object.entries(t).map((([e,t])=>!t.isEmpty&&(0,$.tZ)(oe,{node:t},e)))})]})}function oe({node:e}){const{node:t}=(0,f.useContext)(P.M),[n,i]=(0,f.useState)(!1),a=(0,f.useCallback)(((e,t)=>i(t)),[]),l=(0,f.useRef)();return(0,f.useEffect)((()=>{e===t&&setTimeout((()=>{var e;return null==l||null==(e=l.current)||null==e.scrollIntoView?void 0:e.scrollIntoView({behavior:"smooth"})}),300)}),[l,e,t]),(0,$.BX)(H.Z,{sx:{bgcolor:"contentDark.main"},expanded:e===t||n,onChange:a,ref:l,children:[(0,$.BX)(U.Z,{expandIcon:(0,$.tZ)(V.Z,{}),children:[(0,$.BX)(Y.Z,{children:[(0,$.tZ)(te.Z,{color:e.info.variant,children:e.info.name})," ",(0,$.tZ)("strong",{children:(0,le.p)(e)})]}),R.jU.includes(e.info.variant)&&(0,$.tZ)(d.Z,{sx:{display:"inline-block",ml:"auto",mr:2},children:(0,$.tZ)(Q.Z,{reaction:e.info.variant,trigger:e.info.subVariant})})]}),(0,$.tZ)(J.Z,{children:e.formulas.map(((e,t)=>(0,$.tZ)(Y.Z,{component:"div",children:e},t)))})]})}var de=n(33927),ue=n(41075),Ze=n(107),he=n(15873),pe=n(82799),me=n(32510),fe=n(5658),ge=n(27216),xe=n(66198),be=n(41033),ye=n(34958),ve=n(19807),Ce=n(43397),we=n(29063),Be=n(31461),ke=n(65992),Se=n(85801);const Xe=["expand"],Pe=(0,ke.ZP)((e=>{const t=(0,Be.Z)(e,Xe);return(0,$.tZ)(Se.Z,Object.assign({},t))}))((({theme:e,expand:t})=>({transform:t?"rotate(180deg)":"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})})));var je=n(38553),Ke=n(89343),Oe=n(87051);const Ee=["name","children","value","placeholder","defaultValue","onValueChange","percent","disabled","onReset"],De=(0,ke.ZP)(je.Z)({display:"flex"});function Te(e){let{name:t,children:n,value:i,placeholder:a,defaultValue:l=0,onValueChange:r,percent:s=!1,disabled:c=!1,onReset:o}=e,d=(0,Be.Z)(e,Ee);return(0,$.BX)(De,Object.assign({},d,{children:[n,(0,$.tZ)(Oe.Z,{sx:{px:1},children:t}),(0,$.tZ)(Ke.CC,{sx:{flexBasis:"10em",flexGrow:1},children:(0,$.tZ)(Ke.ZP,{sx:{px:1},inputProps:{sx:{textAlign:"right"}},float:s,placeholder:a,value:i,onChange:r,disabled:c,endAdornment:s?"%":void 0})}),(0,$.tZ)(m.Z,{sx:{flexShrink:2},size:"small",color:"error",onClick:()=>o?o():r(l),disabled:c||i===l,children:(0,$.tZ)(me.Z,{})})]}))}let Ie,Ae=e=>e;function Me(){const{t:e}=(0,g.$G)("ui"),{characterDispatch:t}=(0,f.useContext)(S.K),{data:n}=(0,f.useContext)(X.R),[i,a]=(0,f.useState)(!1),l=(0,f.useCallback)((()=>a(!i)),[a,i]),r=n.get(ye.ri.enemy.level),s=n.get(ye.ri.enemy.defRed),c=n.get(ye.ri.enemy.defIgn),o=(0,f.useCallback)((()=>t({enemyOverride:{}})),[t]);return(0,$.BX)(v.Z,{children:[(0,$.BX)(Z.Z,{sx:{display:"flex",gap:1,alignItems:"center",flexWrap:"wrap"},children:[(0,$.tZ)(xe.Z,{size:"small",color:"success",label:(0,$.BX)("span",{children:[r.info.name," ",(0,$.tZ)("strong",{children:r.value})]})}),pe.fR.map((e=>(0,$.tZ)(Y.Z,{children:(0,$.tZ)(Re,{element:e})},e))),(0,$.BX)(Y.Z,{children:["DEF Red. ",(0,le.p)(s)]}),(0,$.BX)(Y.Z,{children:["DEF Ignore ",(0,le.p)(c)]}),(0,$.BX)(d.Z,{flexGrow:1,display:"flex",justifyContent:"flex-end",gap:1,children:[(0,$.tZ)(m.Z,{size:"small",color:"error",onClick:o,startIcon:(0,$.tZ)(me.Z,{}),children:e(Ie||(Ie=Ae`reset`))}),(0,$.tZ)(Pe,{expand:i,onClick:l,"aria-expanded":i,"aria-label":"show more",size:"small",sx:{marginLeft:0},children:(0,$.tZ)(V.Z,{})})]})]}),(0,$.tZ)(be.Z,{in:i,timeout:"auto",unmountOnExit:!0,children:(0,$.tZ)(Z.Z,{sx:{pt:0},children:(0,$.tZ)(_e,{})})})]})}function Re({element:e}){const{data:t}=(0,f.useContext)(X.R),n=t.get(ye.ri.enemy[`${e}_res_`]),i=!isFinite(n.value),a=(0,$.tZ)(Ce.Z,{ele:e,iconProps:we.m}),l=i?(0,$.BX)("span",{children:[a," \u221e"]}):(0,$.BX)("span",{children:[a," ",(0,$.tZ)("strong",{children:(0,le.p)(n)})]});return(0,$.tZ)(te.Z,{color:e,children:l})}function _e({bsProps:e={xs:12,md:6}}){var t,n,i;const{character:{enemyOverride:a},characterDispatch:l}=(0,f.useContext)(S.K),{data:r}=(0,f.useContext)(X.R),s=null!=(t=a.enemyLevel)?t:r.get(ye.ri.lvl).value,c=null!=(n=a.enemyDefIgn_)?n:0,o=null!=(i=a.enemyDefRed_)?i:0;return(0,$.BX)(ue.ZP,{container:!0,spacing:1,children:[(0,$.tZ)(ue.ZP,Object.assign({item:!0},e,{children:(0,$.tZ)(m.Z,{fullWidth:!0,sx:{height:"100%"},size:"small",component:"a",color:"warning",href:"https://genshin-impact.fandom.com/wiki/Resistance#Base_Enemy_Resistances",target:"_blank",rel:"noreferrer",children:"To get the specific resistance values of enemies, please visit the wiki."})})),(0,$.tZ)(ue.ZP,Object.assign({item:!0},e,{children:(0,$.tZ)(Te,{sx:{bgcolor:e=>e.palette.contentLight.main,width:"100%"},name:(0,$.tZ)("b",{children:ve.ZP.get("enemyLevel")}),value:s,placeholder:ve.ZP.getStr("enemyLevel"),defaultValue:r.get(ye.ri.lvl).value,onValueChange:e=>l({type:"enemyOverride",statKey:"enemyLevel",value:e}),onReset:()=>l({type:"enemyOverride",statKey:"enemyLevel",value:void 0})})})),pe.fR.map((t=>{const n=`${t}_enemyRes_`,i=a[n],r=i===Number.MAX_VALUE;return(0,$.tZ)(ue.ZP,Object.assign({item:!0},e,{children:(0,$.tZ)(Te,{sx:{bgcolor:e=>e.palette.contentLight.main,width:"100%"},name:(0,$.tZ)(te.Z,{color:t,children:(0,$.tZ)("b",{children:ve.ZP.get(n)})}),value:void 0!==i?r?1/0:i:10,placeholder:r?"\u221e ":ve.ZP.getStr(n),defaultValue:10,onValueChange:e=>l({type:"enemyOverride",statKey:n,value:e}),disabled:r,percent:!0,children:(0,$.tZ)(m.Z,{color:t,onClick:()=>l({type:"enemyOverride",statKey:n,value:r?10:Number.MAX_VALUE}),startIcon:r?(0,$.tZ)(fe.Z,{}):(0,$.tZ)(ge.Z,{}),children:"Immunity"})})}),t)})),(0,$.tZ)(ue.ZP,Object.assign({item:!0},e,{children:(0,$.tZ)(Te,{sx:{bgcolor:e=>e.palette.contentLight.main,width:"100%"},name:(0,$.tZ)("b",{children:ve.ZP.get("enemyDefIgn_")}),value:c,placeholder:ve.ZP.getStr("enemyDefIgn_"),defaultValue:0,onValueChange:e=>l({type:"enemyOverride",statKey:"enemyDefIgn_",value:e}),percent:!0})})),(0,$.tZ)(ue.ZP,Object.assign({item:!0},e,{children:(0,$.tZ)(Te,{sx:{bgcolor:e=>e.palette.contentLight.main,width:"100%"},name:(0,$.tZ)("b",{children:ve.ZP.get("enemyDefRed_")}),value:o,placeholder:ve.ZP.getStr("enemyDefRed_"),defaultValue:0,onValueChange:e=>l({type:"enemyOverride",statKey:"enemyDefRed_",value:e}),percent:!0})})),(0,$.tZ)(ue.ZP,{item:!0,xs:12,children:(0,$.tZ)("small",{children:"Note: Genshin Impact halves resistance shred values below 0%. For the sake of calculations enter the RAW value and GO will do the rest. (e.g. 10% - 20% = -10%)"})})]})}var Ge=n(2720),ze=n(86953);let Le,$e=e=>e;const Ne={xs:1,md:2,lg:3};function We({open:e,onClose:t}){const{t:n}=(0,g.$G)("page_character");return(0,$.tZ)(ie.Z,{open:e,onClose:t,children:(0,$.BX)(y.Z,{children:[(0,$.tZ)(q.Z,{title:n(Le||(Le=$e`addStats.title`)),action:(0,$.tZ)(C.Z,{onClick:t})}),(0,$.tZ)(Z.Z,{sx:{pt:0},children:(0,$.BX)(de.Z,{spacing:1,children:[(0,$.tZ)(Fe,{}),(0,$.tZ)(Me,{}),(0,$.tZ)(tt,{})]})})]})})}const Ve=[...ye.lR],qe=(e,t)=>(0,$.tZ)(ue.ZP,{item:!0,xs:1,children:e},t);function Fe(){const{t:e}=(0,g.$G)("page_character"),{character:{bonusStats:t},characterDispatch:n}=(0,f.useContext)(S.K),i=(0,f.useCallback)((e=>n({bonusStats:e})),[n]);return(0,$.tZ)(v.Z,{children:(0,$.tZ)(Z.Z,{sx:{display:"flex"},children:(0,$.BX)(ue.ZP,{container:!0,columns:Ne,sx:{pt:1},spacing:1,children:[(0,$.tZ)(ue.ZP,{item:!0,xs:12,children:(0,$.tZ)(Ze.Z,{severity:"info",variant:"filled",children:(0,$.BX)(g.cC,{i18nKey:"addStats.info",t:e,children:["You can use these fields to add buffs/debuffs not directly supported in GO, such as food buffs, abyss cards, or Superconduct. Please refer to the ",(0,$.tZ)("a",{href:"https://genshin-impact.fandom.com/wiki/Genshin_Impact_Wiki",children:"Genshin Impact wiki"})," for specific values."]})})}),(0,$.tZ)(ze.Z,{statKeys:Ve,statFilters:t,setStatFilters:i,wrapperFunc:qe})]})})})}const He=["eleMas","critRate_","critDMG_","enerRech_","heal_"],Ue=["hp","atk","def",...He].map((e=>ye.ri.total[e])),Ye=["atk_","atk","hp_","hp","def_","def",...He],Je=[...ve.hX,...ve.Sx,"stamina","incHeal_","shield_","cdRed_"],Qe=ye.lR.filter((e=>!Ye.includes(e)&&!Je.includes(e)));function et({nodes:e,extra:t}){const{data:n,oldData:i}=(0,f.useContext)(X.R);return(0,$.BX)(Ge.lD,{children:[e.map((e=>{var t;return(0,$.tZ)(Ge.JW,{component:he.ZP,node:n.get(e),oldValue:null==i||null==(t=i.get(e))?void 0:t.value},JSON.stringify(e.info))})),t]})}function tt(){const{characterSheet:e}=(0,f.useContext)(S.K),{data:t}=(0,f.useContext)(X.R),n=t.get(ye.ri.special),i=e.elementKey,a=e.isMelee(),l=(0,f.useMemo)((()=>Je.filter((e=>!e.includes(i)&&(a&&e.includes("physical"),!0))).map((e=>ye.ri.total[e])).filter((e=>!!t.get(e).value))),[t,i,a]),r=(0,f.useMemo)((()=>Qe.map((e=>ye.ri.total[e])).filter((e=>t.get(e).value))),[t]);return(0,$.tZ)(v.Z,{children:(0,$.tZ)(Z.Z,{children:(0,$.BX)(ue.ZP,{container:!0,columns:Ne,spacing:1,children:[(0,$.tZ)(ue.ZP,{item:!0,xs:1,children:(0,$.tZ)(nt,{title:"Main Stats",children:(0,$.tZ)(et,{nodes:Ue,extra:n&&(0,$.BX)(he.ZP,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,$.BX)("span",{children:[(0,$.tZ)("b",{children:"Special:"})," ",(0,$.BX)(te.Z,{color:n.info.variant,children:[n.info.icon," ",n.info.name]})]}),(0,$.tZ)("span",{children:(0,le.p)(n)})]})})})}),(0,$.tZ)(ue.ZP,{item:!0,xs:1,children:(0,$.tZ)(nt,{title:"Other Stats",children:(0,$.tZ)(et,{nodes:l})})}),!!r.length&&(0,$.tZ)(ue.ZP,{item:!0,xs:1,children:(0,$.tZ)(nt,{title:"Misc Stats",children:(0,$.tZ)(et,{nodes:r})})})]})})})}function nt({title:e,children:t}){return(0,$.BX)(y.Z,{children:[(0,$.tZ)(Z.Z,{sx:{py:1},children:(0,$.tZ)(d.Z,{display:"flex",justifyContent:"space-between",children:(0,$.tZ)(Y.Z,{variant:"subtitle1",children:e})})}),t]})}var it=n(36269),at=n(46342),lt=n(62469),rt=n(85162),st=n(23119),ct=n(94380),ot=n(92794),dt=n(32912),ut=n(7300),Zt=n(76638),ht=n(35711),pt=n(82334),mt=n(29432);const ft=(0,f.createContext)(void 0);var gt=n(65469),xt=n(30507),bt=n(30597),yt=n(36617),vt=n(82716),Ct=n(40580),wt=n(97797),Bt=n(41015);function kt(e,t,n=!1){const i=new Set,a=new Set;function l(e,t){t?i.add(e):e.operands.forEach((e=>i.has(e)&&a.add(e)))}const r=new Set;if((0,Ct.aD)(e,(e=>{}),(e=>{const{operation:t}=e;switch(t){case"read":r.add(e.path[1]),l(e,!0);break;case"add":l(e,e.operands.every((e=>i.has(e))));break;case"mul":{const t=e.operands.filter((e=>"const"!==e.operation));l(e,0===t.length||1===t.length&&i.has(t[0]));break}case"const":l(e,!0);break;case"res":case"threshold":case"sum_frac":case"max":case"min":l(e,!1);break;default:(0,Bt.UT)(t)}})),[...a].every((({operation:e})=>"read"===e||"const"===e))&&Object.keys(t.base).length===r.size)return{nodes:e,arts:t};let s=-1;function c(){for(;r.has(""+ ++s););return`${s}`}e.forEach((e=>i.has(e)&&a.add(e)));const o=[...a].filter((e=>"const"!==e.operation)),d=new Map(o.map((e=>[e,n||"read"!==e.operation||"dyn"!==e.path[0]?Object.assign({},(0,wt.UF)(["dyn",`${c()}`]),{accu:"add"}):e])));function u(e){const t=(0,bt.CG)([...d.keys()],{dyn:(0,Bt.xh)(e,(e=>(0,wt.a9)(e)))},(e=>!0));return Object.fromEntries([...d.values()].map(((e,n)=>[e.path[1],t[n].value])))}const Z={nodes:e=(0,Ct.uW)(e,(e=>{var t;return null!=(t=d.get(e))?t:e}),(e=>e)),arts:{base:u(t.base),values:(0,Bt.O)(R.eV,(e=>t.values[e].map((({id:e,set:t,values:n})=>({id:e,set:t,values:u(n)})))))}},h=Object.entries(u({}));for(const p of Object.values(Z.arts.values))for(const{values:e}of p)for(const[t,n]of h)e[t]-=n;return Z}function St(e,t,n){var i;let a=!1;const l=!(null!=(i=n.rainbow)&&i.length),r=Object.keys(e.base),s=new Set(Object.entries(n).filter((([e,t])=>t.length)).map((([e])=>e))),c=new Set(Object.entries(n).filter((([e,t])=>t.includes(2)&&!t.includes(4))).map((([e])=>e))),o=(0,Bt.O)(R.eV,(n=>{const i=e.values[n],o=i.filter((e=>{let n=0;return i.every((i=>{const a=r.every((t=>{var n,a;return(null!=(n=i.values[t])?n:0)>=(null!=(a=e.values[t])?a:0)})),o=r.some((t=>{var n,a;return(null!=(n=i.values[t])?n:0)>(null!=(a=e.values[t])?a:0)})),d=a&&(o||i.id>e.id),u=l&&!s.has(i.set)&&!c.has(e.set)||e.set===i.set;return d&&u&&n++,n<t}))}));return o.length!==i.length&&(a=!0),o}));return a?{base:e.base,values:o}:e}function Xt(e,t,n){const i=Object.fromEntries(Object.entries(t.base).map((([e,t])=>[e,{min:t,max:t}]))),a={arts:t};for(;;){const t=(0,Bt.O)(R.eV,(e=>Kt(a.arts.values[e]))),l=(0,Bt.O)(R.eV,(e=>jt(Object.entries(t).map((t=>t[0]===e?i:t[1])).filter((e=>e)))));let r=!1;const s=(0,Bt.O)(R.eV,(t=>{const i=a.arts.values[t].filter((i=>{const a=jt([Kt([i]),l[t]]),r=Ot(e,a);return e.every(((e,t)=>{var i;return r.get(e).max>=(null!=(i=n[t])?i:-1/0)}))}));return i.length!==a.arts.values[t].length&&(r=!0),i}));if(!r)break;a.arts={base:a.arts.base,values:s}}return a.arts}function Pt(e,t){const n=Ot(e,jt([Object.fromEntries(Object.entries(t.base).map((([e,t])=>[e,{min:t,max:t}]))),...Object.values(t.values).map((e=>Kt(e)))]));return(0,Ct.uW)(e,(e=>{{const{min:t,max:i}=n.get(e);if(t===i)return(0,wt.a9)(t)}const{operation:t}=e,i=e.operands.map((e=>n.get(e)));switch(t){case"threshold":{const[t,n,a,l]=i;if(t.min>=n.max)return e.operands[2];if(t.max<n.min)return e.operands[3];if(a.max===a.min&&l.max===l.min&&a.min===l.min&&isFinite(a.min))return(0,wt.a9)(a.max);break}case"min":{const t=e.operands.filter(((e,t)=>{const n=i[t];return i.every(((e,t)=>n.min<=e.max))}));if(t.length<i.length)return(0,wt.VV)(...t);break}case"max":{const t=e.operands.filter(((e,t)=>{const n=i[t];return i.every((e=>n.max>=e.min))}));if(t.length<i.length)return(0,wt.Fp)(...t);break}}return e}),(e=>e))}function jt(e){const t={};return e.forEach((e=>{Object.entries(e).forEach((([e,n])=>{t[e]?(t[e].min+=n.min,t[e].max+=n.max):t[e]=Object.assign({},n)}))})),t}function Kt(e){const t={};return e.length&&(Object.keys(e[0].values).filter((t=>e.every((e=>e.values[t])))).forEach((n=>t[n]={min:e[0].values[n],max:e[0].values[n]})),e.forEach((({values:e})=>{for(const[n,i]of Object.entries(e))t[n]?(t[n].max<i&&(t[n].max=i),t[n].min>i&&(t[n].min=i)):t[n]={min:0,max:i}}))),t}function Ot(e,t){const n=new Map;return(0,Ct.aD)(e,(e=>{}),(e=>{var i;const{operation:a}=e,l=e.operands.map((e=>n.get(e)));let r;switch(a){case"read":if("dyn"!==e.path[0])throw new Error(`Found non-dyn path ${e.path} while computing range`);r=null!=(i=t[e.path[1]])?i:{min:0,max:0};break;case"const":r=Et([e.value]);break;case"add":case"min":case"max":r={min:bt.aj[a](l.map((e=>e.min))),max:bt.aj[a](l.map((e=>e.max)))};break;case"res":r={min:bt.aj[a]([l[0].max]),max:bt.aj[a]([l[0].min])};break;case"mul":r=l.reduce(((e,t)=>Et([e.min*t.min,e.min*t.max,e.max*t.min,e.max*t.max])));break;case"threshold":r=l[0].min>=l[1].max?l[2]:l[0].max<l[1].min?l[3]:Et([],[l[2],l[3]]);break;case"sum_frac":{const[e,t]=l,n={min:e.min+t.min,max:e.max+t.max};r=n.min<=0&&n.max>=0?e.min<=0&&e.max>=0?{min:NaN,max:NaN}:{min:-1/0,max:1/0}:Et([e.min/n.min,e.min/n.max,e.max/n.min,e.max/n.max]);break}default:(0,Bt.UT)(a)}n.set(e,r)})),n}function Et(e,t=[]){const n=Math.max(...e,...t.map((e=>e.max)));return{min:Math.min(...e,...t.map((e=>e.min))),max:n}}function Dt(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return Dt=function(e){this.s=e,this.n=e.next},Dt.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new Dt(e)}class Tt{constructor(e,t,n){this.prio=void 0,this.commands=void 0,this.workers=void 0,this.workDone=new Map,this._workers=void 0,this.cancel=void 0,this.cancelled=void 0,this.callback=void 0,this.notifyNonEmpty=void 0,this.commands=t.map((e=>new It)),this.prio=new Map(t.map(((e,t)=>[e,t]))),this.callback=n,e.forEach((e=>{e.onmessage=t=>this.onMessage(t.data,e),e.onerror=e=>this.onError(e)})),this._workers=e,this.workers=e.map((e=>Promise.resolve(e))),this.cancel=()=>{},this.cancelled=new Promise(((e,t)=>this.cancel=t)),this.cancelled.catch((t=>e.forEach((e=>e.terminate()))))}async execute(e){var t=this;const n=async function(){var n,i=!1,a=!1;try{for(var l,r=function(e){var t,n,i,a=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,i=Symbol.iterator);a--;){if(n&&null!=(t=e[n]))return t.call(e);if(i&&null!=(t=e[i]))return new Dt(t.call(e));n="@@asyncIterator",i="@@iterator"}throw new TypeError("Object is not async iterable")}(e);i=!(l=await r.next()).done;i=!1){const e=l.value;t.add(e)}}catch(s){a=!0,n=s}finally{try{i&&null!=r.return&&await r.return()}finally{if(a)throw n}}}();for(;;){var i;const e=null==(i=this.commands.find((e=>e.length)))?void 0:i.dequeue();if(void 0===e){const e=await Promise.race([new Promise((e=>this.notifyNonEmpty=()=>e(!0))),Promise.all([...this.workers,n]).then((e=>!1)),this.cancelled]);if(this.notifyNonEmpty=void 0,e)continue;break}const{i:t,w:a}=await Promise.race([...this.workers.map(((e,t)=>e.then((e=>({i:t,w:e}))))),this.cancelled]);this.workers[t]=new Promise((e=>this.workDone.set(a,(()=>e(a))))),a.postMessage(e)}}onError(e){this.cancel(new Error(`Worker Error: ${e.message}`))}onMessage(e,t){void 0!==e.command?this.add(e):"done"===e.resultType?this.workDone.get(t)():this.callback(e,t)}add(e){var t;const n=this.prio.get(e.command);this.commands[n].enqueue(e),null==(t=this.notifyNonEmpty)||t.call(this)}broadcast(e){this._workers.forEach((t=>t.postMessage(e)))}notifiedBroadcast(e){this.workers=this.workers.map((e=>e.then((e=>new Promise((t=>{this.workDone.set(e,(()=>t(e)))})))))),this._workers.forEach((t=>t.postMessage(e)))}}class It{constructor(){this.head=[],this.tail=[]}get length(){return this.head.length+this.tail.length}enqueue(e){this.tail.push(e)}dequeue(){return!this.head.length&&this.tail.length&&([this.head,this.tail]=[this.tail.reverse(),this.head]),this.head.pop()}}class At extends Tt{constructor(e,t,i){super(Array(i).fill(NaN).map((e=>new Worker(new URL(n.p+n.u(729),n.b)))),["iterate","split","count"],((e,t)=>{switch(e.resultType){case"interim":this.interim(e,t);break;case"finalize":this.finalizedResults.push(e);break;case"count":this.status.total=e.count}})),this.maxIterateSize=16e6,this.status=void 0,this.exclusion=void 0,this.topN=void 0,this.buildValues=void 0,this.finalizedResults=[];const{exclusion:a,topN:l}=e;this.status=t,this.exclusion=a,this.topN=l,this.status.total=NaN,this.buildValues=Array(l).fill({w:void 0,val:-1/0}),this.notifiedBroadcast(this.preprocess(e))}async solve(){const{exclusion:e,maxIterateSize:t}=this;return this.finalizedResults=[],await this.execute([{command:"count",exclusion:e,maxIterateSize:t}]),this.notifiedBroadcast({command:"finalize"}),await this.execute([]),this.finalizedResults}preprocess({plotBase:e,optimizationTarget:t,arts:n,topN:i,exclusion:a,constraints:l}){let r=[...(l=l.filter((e=>e.min>-1/0))).map((e=>e.value)),t];const s=[...l.map((e=>e.min)),-1/0];e&&(r.push(e),s.push(-1/0)),r=function(e,t){const n={};for(const[i,a]of Object.entries(t))a.includes(4)&&(n[i]=a.includes(2)?1:3);return(0,Ct.uW)(e,(e=>e),(e=>{if("threshold"!==e.operation)return e;const[i,a,l,r]=e.operands;if("read"===i.operation&&"const"===a.operation){const e=i.path[i.path.length-1],s=a.value;if(e in n){if(n[e]<s)return r;if(2===s&&t[e].includes(2))return(0,wt.Lj)(i,4,l,r)}}return e}))}(r,a),({nodes:r,arts:n}=function(e,t,n,i,a,l){let r=l;const s={pruneNodeRange:!0},c={pruneNodeRange:!0},o={reaffine:!0},d={pruneOrder:!0,pruneArtRange:!0,pruneNodeRange:!0};let u=0;for(;Object.values(r).some((e=>e))&&u++<20;){if(r.pruneOrder){delete r.pruneOrder;const e=St(n,i,a);n!==e&&(n=e,r=Object.assign({},r,s))}if(r.pruneArtRange){delete r.pruneArtRange;const i=Xt(e,n,t);n!==i&&(n=i,r=Object.assign({},r,c))}if(r.pruneNodeRange){delete r.pruneNodeRange;const t=Pt(e,n);e!==t&&(e=t,r=Object.assign({},r,o))}if(r.reaffine){delete r.reaffine;const{nodes:t,arts:i}=kt(e,n);e===t&&n===i||(e=t,n=i,r=Object.assign({},r,d))}}return{nodes:e,arts:n}}(r,s,n,i,a,{reaffine:!0,pruneArtRange:!0,pruneNodeRange:!0,pruneOrder:!0})),r=(0,bt.tL)(r,{},(e=>!1)),e&&(e=r.pop());return{command:"setup",arts:n,optTarget:r.pop(),plotBase:e,topN:i,constraints:r.map(((e,t)=>({value:e,min:s[t]})))}}interim(e,t){if(this.status.tested+=e.tested,this.status.failed+=e.failed,this.status.skipped+=e.skipped,e.buildValues){var n,i;const{topN:a}=this,l=null!=(n=this.buildValues[a-1].val)?n:-1/0;this.buildValues.filter((({w:e})=>e!==t)),this.buildValues.push(...e.buildValues.map((e=>({w:t,val:e})))),this.buildValues.sort(((e,t)=>t.val-e.val)).splice(a);const r=null!=(i=this.buildValues[a-1].val)?i:-1/0;l!==r&&this.broadcast({command:"threshold",threshold:r})}}}var Mt=n(60791),Rt=n(38114),_t=n(76077),Gt=n(96511),zt=n(78437),Lt=n(61420),$t=n(73740);function Nt({setKey:e,setNumKey:t,hideHeader:n=!1,conditionalsOnly:i=!1}){var a;const l=(0,Lt.Sk)(e),r=i?null==(a=l.setEffectDocument(t))?void 0:a.filter((e=>"states"in e)):l.setEffectDocument(t);return(0,$.tZ)(d.Z,{display:"flex",flexDirection:"column",children:r?(0,$.tZ)($t.Z,{sections:r,hideHeader:n}):null})}var Wt=n(15378),Vt=n(21845),qt=n(74637),Ft=n(60184);function Ht(e){const{database:t}=(0,f.useContext)(O.t),[n,i]=(0,f.useState)((()=>t.buildSettings.get(e)));(0,f.useEffect)((()=>i(t.buildSettings.get(e))),[t,e]),(0,f.useEffect)((()=>t.buildSettings.follow(e,((e,t,n)=>"update"===t&&i(n)))),[e,i,t]);return{buildSetting:n,buildSettingDispatch:(0,f.useCallback)((n=>e&&t.buildSettings.set(e,n)),[e,t])}}let Ut,Yt,Jt,Qt,en,tn,nn,an,ln,rn,sn,cn,on,dn,un,Zn,hn=e=>e;function pn({disabled:e}){var t,n;const{t:i}=(0,g.$G)(["page_character_optimize","sheet"]),a=(0,f.useContext)(X.R),{database:l}=(0,f.useContext)(O.t),{character:{key:r,conditional:s},characterDispatch:c}=(0,f.useContext)(S.K),{buildSetting:{artSetExclusion:o},buildSettingDispatch:u}=Ht(r),[h,p]=(0,f.useState)(!1),x=(0,f.useCallback)((()=>p(!0)),[p]),b=(0,f.useCallback)((()=>p(!1)),[p]),[w,B]=(0,yt.Z)();(0,f.useEffect)((()=>l.arts.followAny(B)),[l,B]);const P=(0,f.useMemo)((()=>Object.entries(Lt.WO).reverse().flatMap((([,e])=>e)).filter((e=>!e.includes("Prayers")))),[]),{artKeys:j,artSlotCount:K}=(0,f.useMemo)((()=>{const e=(0,Bt.O)(P,(e=>(0,Bt.O)(pe.Ex,(e=>0))));l.arts.values.forEach((t=>e[t.setKey]&&e[t.setKey][t.slotKey]++));const t=[...P].sort(((t,n)=>+(gn(e[t])<2)-+(gn(e[n])<2)));return w&&{artKeys:t,artSlotCount:e}}),[w,l,P]),E=!(null!=(t=o.rainbow)&&t.includes(2)),D=!(null!=(n=o.rainbow)&&n.includes(4)),{allow2:T,allow4:I}=(0,f.useMemo)((()=>({allow2:P.filter((e=>{var t;return!(null!=(t=o[e])&&t.includes(2))})).length,allow4:P.filter((e=>{var t;return!(null!=(t=o[e])&&t.includes(4))})).length})),[P,o]),A=P.length-T,M=P.length-I,R=(0,f.useMemo)((()=>Object.keys(s).filter((e=>{var t;return pe.Gt.includes(e)&&!!Object.keys(null!=(t=s[e])?t:{}).length})).length),[s]),_=(0,f.useMemo)((()=>Object.assign({},a,{data:new le.w(Object.assign({},a.data.data[0],{artSet:(0,Bt.O)(pe.Gt,(e=>(0,wt.a9)(4)))}),void 0)})),[a]),G=(0,f.useCallback)((()=>{const e=Object.fromEntries(Object.entries(s).filter((([e,t])=>!pe.Gt.includes(e))));c({conditional:e})}),[s,c]),z=(0,f.useCallback)(((e,t=!0)=>{const n=(0,Bt.I8)(o);P.forEach((i=>{var a;t?n[i]=[...null!=(a=n[i])?a:[],e]:n[i]&&(n[i]=n[i].filter((t=>t!==e)))})),u({artSetExclusion:n})}),[P,o,u]);return(0,$.BX)($.HY,{children:[(0,$.tZ)(m.Z,{onClick:x,disabled:e,color:"info",startIcon:(0,$.tZ)(_t.Z,{}),children:(0,$.BX)(d.Z,{sx:{textAlign:"left",flexGrow:1},children:[(0,$.tZ)(Y.Z,{children:(0,$.tZ)("strong",{children:i(Ut||(Ut=hn`artSetConfig.title`))})}),(0,$.BX)(de.Z,{spacing:.5,children:[(0,$.BX)(Y.Z,{children:[i(Yt||(Yt=hn`artSetConfig.setEffCond`))," ",(0,$.BX)(k.Z,{color:R?"success":"warning",children:[R," ",i("artSetConfig.enabled")]})]}),(0,$.BX)(Y.Z,{children:[i(Jt||(Jt=hn`sheet:2set`))," ",(0,$.BX)(k.Z,{color:"success",children:[T," ",(0,$.tZ)(Gt.Z,Object.assign({},we.m))," ",i("artSetConfig.allowed")]}),!!A&&" / ",!!A&&(0,$.BX)(k.Z,{color:"secondary",children:[A," ",(0,$.tZ)(Rt.Z,Object.assign({},we.m))," ",i("artSetConfig.excluded")]})]}),(0,$.BX)(Y.Z,{children:[i(Qt||(Qt=hn`sheet:4set`))," ",(0,$.BX)(k.Z,{color:"success",children:[I," ",(0,$.tZ)(Gt.Z,Object.assign({},we.m))," ",i("artSetConfig.allowed")]}),!!M&&" / ",!!M&&(0,$.BX)(k.Z,{color:"secondary",children:[M," ",(0,$.tZ)(Rt.Z,Object.assign({},we.m))," ",i("artSetConfig.excluded")]})]}),(0,$.BX)(Y.Z,{children:[i(en||(en=hn`artSetConfig.2rainbow`))," ",(0,$.BX)(k.Z,{color:E?"success":"secondary",children:[E?(0,$.tZ)(Gt.Z,Object.assign({},we.m)):(0,$.tZ)(Rt.Z,Object.assign({},we.m))," ",E?i("artSetConfig.allowed"):"Excluded"]})]}),(0,$.BX)(Y.Z,{children:[i(tn||(tn=hn`artSetConfig.4rainbow`))," ",(0,$.BX)(k.Z,{color:D?"success":"secondary",children:[D?(0,$.tZ)(Gt.Z,Object.assign({},we.m)):(0,$.tZ)(Rt.Z,Object.assign({},we.m))," ",D?i("artSetConfig.allowed"):"Excluded"]})]})]})]})}),(0,$.tZ)(ie.Z,{open:h,onClose:b,children:(0,$.BX)(y.Z,{children:[(0,$.BX)(Z.Z,{sx:{display:"flex",gap:1,justifyContent:"space-between"},children:[(0,$.tZ)(Y.Z,{variant:"h6",children:i(nn||(nn=hn`artSetConfig.title`))}),(0,$.tZ)(C.Z,{onClick:b})]}),(0,$.tZ)(F.Z,{}),(0,$.BX)(Z.Z,{children:[(0,$.tZ)(v.Z,{sx:{mb:1},children:(0,$.BX)(Z.Z,{children:[(0,$.BX)(d.Z,{display:"flex",gap:1,children:[(0,$.tZ)(Y.Z,{children:(0,$.tZ)("strong",{children:i(an||(an=hn`artSetConfig.modal.setCond.title`))})}),(0,$.tZ)(Y.Z,{sx:{flexGrow:1},children:(0,$.BX)(k.Z,{color:R?"success":"warning",children:[R," ",i("artSetConfig.selected")]})}),(0,$.tZ)(m.Z,{size:"small",onClick:G,color:"error",startIcon:(0,$.tZ)(me.Z,{}),children:i(ln||(ln=hn`artSetConfig.modal.setCond.reset`))})]}),(0,$.tZ)(Y.Z,{children:i(rn||(rn=hn`artSetConfig.modal.setCond.text`))})]})}),(0,$.tZ)(v.Z,{sx:{mb:1},children:(0,$.BX)(Z.Z,{children:[(0,$.tZ)(Y.Z,{sx:{flexGrow:1},children:(0,$.tZ)("strong",{children:(0,$.BX)(g.cC,{t:i,i18nKey:"artSetConfig.modal.ArtSetFilter.title",children:["Artifact Sets ",(0,$.BX)(te.Z,{color:"success",children:["Allowed",(0,$.tZ)(Gt.Z,Object.assign({},we.m))]})," / ",(0,$.BX)(te.Z,{color:"secondary",variant:"light",children:["Excluded",(0,$.tZ)(Rt.Z,Object.assign({},we.m))]})]})})}),(0,$.tZ)(Y.Z,{children:(0,$.BX)(g.cC,{t:i,i18nKey:"artSetConfig.modal.ArtSetFilter.intro",children:["You can allow/exclude which sets you want the builder to consider. In the following examples, ",(0,$.tZ)("strong",{children:"A"})," is on-set, and ",(0,$.tZ)("strong",{children:"R"})," is rainbow(off-set)"]})}),(0,$.tZ)(Y.Z,{children:(0,$.BX)(g.cC,{t:i,i18nKey:"artSetConfig.modal.ArtSetFilter.2set",children:[(0,$.tZ)("strong",{children:(0,$.BX)(te.Z,{color:"secondary",variant:"light",children:["Excluding",(0,$.tZ)(Rt.Z,Object.assign({},we.m))," 2-Set"]})})," would exclude 2-Set builds: ",(0,$.BX)("strong",{children:[(0,$.tZ)(te.Z,{color:"secondary",variant:"light",children:"AA"}),"RRR"]})," and ",(0,$.BX)("strong",{children:[(0,$.tZ)(te.Z,{color:"secondary",variant:"light",children:"AAA"}),"RR"]}),"."]})}),(0,$.tZ)(Y.Z,{children:(0,$.BX)(g.cC,{t:i,i18nKey:"artSetConfig.modal.ArtSetFilter.4set",children:[(0,$.tZ)("strong",{children:(0,$.BX)(te.Z,{color:"secondary",variant:"light",children:["Excluding",(0,$.tZ)(Rt.Z,Object.assign({},we.m))," 4-Set"]})})," would exclude 4-Set builds: ",(0,$.BX)("strong",{children:[(0,$.tZ)(te.Z,{color:"secondary",variant:"light",children:"AAAA"}),"R"]})," and ",(0,$.tZ)("strong",{children:(0,$.tZ)(te.Z,{color:"secondary",variant:"light",children:"AAAAA"})}),"."]})}),(0,$.tZ)(Y.Z,{children:(0,$.BX)(g.cC,{t:i,i18nKey:"artSetConfig.modal.ArtSetFilter.2rain",children:[(0,$.tZ)("strong",{children:(0,$.BX)(te.Z,{color:"secondary",variant:"light",children:["Excluding",(0,$.tZ)(Rt.Z,Object.assign({},we.m))," 3-Rainbow"]})})," would exclude 2-Set + 3-Rainbow builds: ",(0,$.BX)("strong",{children:["AA",(0,$.tZ)(te.Z,{color:"secondary",variant:"light",children:"RRR"})]})," and ",(0,$.BX)("strong",{children:["AAA",(0,$.tZ)(te.Z,{color:"secondary",variant:"light",children:"RR"})]}),"."]})}),(0,$.tZ)(Y.Z,{children:(0,$.BX)(g.cC,{t:i,i18nKey:"artSetConfig.modal.ArtSetFilter.4rain",children:[(0,$.tZ)("strong",{children:(0,$.BX)(te.Z,{color:"secondary",variant:"light",children:["Excluding",(0,$.tZ)(Rt.Z,Object.assign({},we.m))," 5-Rainbow"]})})," would exclude full 5-Rainbow builds: ",(0,$.tZ)("strong",{children:(0,$.tZ)(te.Z,{color:"secondary",variant:"light",children:"RRRRR"})}),"."]})})]})}),(0,$.BX)(ue.ZP,{container:!0,columns:{xs:2,lg:3},sx:{mb:1},spacing:1,children:[(0,$.tZ)(ue.ZP,{item:!0,xs:1,children:(0,$.tZ)(mn,{setNum:2,numAllow:T,numExclude:A,setAllExclusion:z})}),(0,$.tZ)(ue.ZP,{item:!0,xs:1,children:(0,$.tZ)(mn,{setNum:4,numAllow:I,numExclude:M,setAllExclusion:z})}),(0,$.tZ)(ue.ZP,{item:!0,xs:1,children:(0,$.tZ)(v.Z,{children:(0,$.BX)(Z.Z,{children:[(0,$.tZ)(Y.Z,{gutterBottom:!0,children:(0,$.tZ)("strong",{children:(0,$.BX)(g.cC,{t:i,i18nKey:"artSetConfig.alExRainbow",children:[(0,$.BX)(te.Z,{color:"success",children:["Allow ",(0,$.tZ)(Gt.Z,Object.assign({},we.m))]})," / ",(0,$.BX)(te.Z,{color:"secondary",variant:"light",children:["Exclude ",(0,$.tZ)(Rt.Z,Object.assign({},we.m))]})," Rainbow Builds"]})})}),(0,$.BX)(d.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,$.tZ)(m.Z,{fullWidth:!0,onClick:()=>u({artSetExclusion:(0,Ft.s)(o,"rainbow",2)}),color:E?"success":"secondary",startIcon:E?(0,$.tZ)(fe.Z,{}):(0,$.tZ)(ge.Z,{}),endIcon:E?(0,$.tZ)(Gt.Z,{}):(0,$.tZ)(Rt.Z,{}),children:i(sn||(sn=hn`artSetConfig.2rainbow`))}),(0,$.tZ)(m.Z,{fullWidth:!0,onClick:()=>u({artSetExclusion:(0,Ft.s)(o,"rainbow",4)}),color:D?"success":"secondary",startIcon:D?(0,$.tZ)(fe.Z,{}):(0,$.tZ)(ge.Z,{}),endIcon:D?(0,$.tZ)(Gt.Z,{}):(0,$.tZ)(Rt.Z,{}),children:i(cn||(cn=hn`artSetConfig.4rainbow`))})]})]})})})]}),(0,$.tZ)(ue.ZP,{container:!0,spacing:1,columns:{xs:2,lg:3},children:j.map((e=>(0,$.tZ)(fn,{setKey:e,fakeDataContextObj:_,slotCount:K[e]},e)))})]}),(0,$.tZ)(F.Z,{}),(0,$.tZ)(Z.Z,{sx:{py:1},children:(0,$.tZ)(C.Z,{large:!0,onClick:b})})]})})]})}function mn({numAllow:e,numExclude:t,setNum:n,setAllExclusion:i}){const{t:a}=(0,g.$G)(["page_character_optimize","sheet"]);return(0,$.tZ)(v.Z,{children:(0,$.BX)(Z.Z,{children:[(0,$.BX)(Y.Z,{gutterBottom:!0,children:[(0,$.tZ)("strong",{children:a(`sheet:${n}set`)})," ",(0,$.BX)(k.Z,{color:"success",children:[e," ",(0,$.tZ)(Gt.Z,Object.assign({},we.m))," ",a("artSetConfig.allowed")]}),!!t&&" / ",!!t&&(0,$.BX)(k.Z,{color:"secondary",children:[t," ",(0,$.tZ)(Rt.Z,Object.assign({},we.m))," ",a("artSetConfig.excluded")]})]}),(0,$.BX)(d.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,$.tZ)(m.Z,{fullWidth:!0,disabled:!t,onClick:()=>i(n,!1),color:"success",startIcon:(0,$.tZ)(Gt.Z,{}),children:a(`artSetConfig.allowAll${n}set`)}),(0,$.tZ)(m.Z,{fullWidth:!0,disabled:!e,onClick:()=>i(n,!0),color:"secondary",startIcon:(0,$.tZ)(Rt.Z,{}),children:a(`artSetConfig.excludeAll${n}set`)})]})]})})}function fn({setKey:e,fakeDataContextObj:t,slotCount:n}){var i,a;const{t:l}=(0,g.$G)("sheet"),{character:{key:r}}=(0,f.useContext)(S.K),{buildSetting:s,buildSettingDispatch:c}=Ht(r),{artSetExclusion:o}=s,u=null!=(i=null==o?void 0:o[e])?i:[],h=!u.includes(4),p=gn(n),x=(0,Lt.Sk)(e),b=(0,f.useMemo)((()=>h?Object.keys(x.setEffects).filter((e=>{var t;return null==(t=x.setEffects[e])?void 0:t.document.some((e=>"states"in e))})):[]),[x.setEffects,h]),y=u.includes(2),C=u.includes(4);return(0,$.tZ)(ue.ZP,{item:!0,xs:1,children:(0,$.BX)(v.Z,{sx:{height:"100%",opacity:p<2?"50%":void 0},children:[(0,$.BX)(d.Z,{className:`grad-${x.rarity[0]}star`,width:"100%",sx:{display:"flex"},children:[(0,$.tZ)(d.Z,{component:"img",src:(0,qt.jU)(e),sx:{height:100,width:"auto",mx:-1}}),(0,$.BX)(d.Z,{sx:{flexGrow:1,px:1,display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,$.tZ)(Y.Z,{variant:"h6",children:null!=(a=x.name)?a:""}),(0,$.tZ)(d.Z,{children:(0,$.BX)(Y.Z,{variant:"subtitle1",children:[x.rarity.map(((e,t)=>(0,$.BX)(d.Z,{component:"span",sx:{display:"inline-flex",alignItems:"center"},children:[e," ",(0,$.tZ)(zt.Z,{fontSize:"inherit"})," ",t<x.rarity.length-1?"/ ":null]},e)))," ",(0,$.tZ)(pt.L,{title:(0,$.BX)(d.Z,{children:[(0,$.tZ)(Y.Z,{children:(0,$.tZ)(k.Z,{color:"success",children:l(on||(on=hn`2set`))})}),(0,$.tZ)(Y.Z,{children:(0,$.tZ)(Vt.v,{ns:`artifact_${e}_gen`,key18:"setEffects.2"})}),(0,$.BX)(d.Z,{paddingTop:2,sx:{opacity:u.includes(4)?.6:1},children:[(0,$.tZ)(Y.Z,{children:(0,$.tZ)(k.Z,{color:"success",children:l(dn||(dn=hn`4set`))})}),(0,$.tZ)(Y.Z,{children:(0,$.tZ)(Vt.v,{ns:`artifact_${e}_gen`,key18:"setEffects.4"})})]})]})})]})}),(0,$.tZ)(d.Z,{sx:{display:"flex",gap:1},children:Object.entries(n).map((([e,t])=>(0,$.tZ)(Y.Z,{sx:{flexGrow:1},variant:"subtitle2",children:(0,$.BX)(k.Z,{sx:{width:"100%"},color:t?"primary":"secondary",children:[(0,$.tZ)(Wt.Z,{slotKey:e,iconProps:we.m})," ",t]})},e)))})]})]}),(0,$.BX)(je.Z,{sx:{".MuiButton-root":{borderRadius:0}},fullWidth:!0,children:[(0,$.tZ)(m.Z,{startIcon:y?(0,$.tZ)(ge.Z,{}):(0,$.tZ)(fe.Z,{}),onClick:()=>c({artSetExclusion:(0,Ft.s)(o,e,2)}),color:y?"secondary":"success",endIcon:y?(0,$.tZ)(Rt.Z,{}):(0,$.tZ)(Gt.Z,{}),children:l(un||(un=hn`2set`))}),(0,$.tZ)(m.Z,{startIcon:C?(0,$.tZ)(ge.Z,{}):(0,$.tZ)(fe.Z,{}),onClick:()=>c({artSetExclusion:(0,Ft.s)(o,e,4)}),color:C?"secondary":"success",endIcon:C?(0,$.tZ)(Rt.Z,{}):(0,$.tZ)(Gt.Z,{}),children:l(Zn||(Zn=hn`4set`))})]}),!!b.length&&(0,$.tZ)(X.R.Provider,{value:t,children:(0,$.tZ)(Z.Z,{sx:{display:"flex",flexDirection:"column",gap:2},children:b.map((t=>(0,$.tZ)(Nt,{setKey:e,setNumKey:parseInt(t),hideHeader:!0,conditionalsOnly:!0},t)))})})]})},e)}function gn(e){return Object.values(e).reduce(((e,t)=>e+(t?1:0)),0)}const xn=[0,4,8,12,16,20];function bn({mainStatAssumptionLevel:e=0,setmainStatAssumptionLevel:t,disabled:n}){const{t:i}=(0,g.$G)("page_character_optimize");return(0,$.tZ)(ht.Z,{fullWidth:!0,color:e?"success":"primary",disabled:n,title:e?i("mainStat.assumptionLvl.lvl",{lvl:e}):i("mainStat.assumptionLvl.no"),children:xn.map((e=>(0,$.tZ)(ct.Z,{onClick:()=>t(e),children:e?i("mainStat.assumptionLvl.lvl",{lvl:e}):i("mainStat.assumptionLvl.no")},e)))})}function yn(){const{character:{bonusStats:e}}=(0,f.useContext)(S.K),{data:t}=(0,f.useContext)(X.R),n=Object.keys(e);if(!n.length)return null;const i=n.map((e=>t.get(ye.ri.customBonus[e])));return(0,$.BX)(v.Z,{children:[(0,$.tZ)(Z.Z,{children:(0,$.tZ)(Y.Z,{children:"Bonus Stats"})}),(0,$.tZ)(F.Z,{}),(0,$.tZ)(Z.Z,{children:i.map((e=>(0,$.tZ)(Ge.JW,{node:e},JSON.stringify(e.info))))})]})}var vn=n(38162),Cn=n(21940);const wn=(0,ke.ZP)("strong")({fontFamily:"monospace"}),Bn=(0,ke.ZP)(vn.Z)((({theme:e})=>({height:10,borderRadius:5})));function kn({status:{type:e,tested:t,failed:n,skipped:i,total:a,startTime:l,finishTime:r},characterName:s}){const c=isFinite(a),o="inactive"!==e,d=a-i,u=(0,$.tZ)(wn,{children:t.toLocaleString()}),Z=(0,$.tZ)(wn,{children:d.toLocaleString()}),h=!!i&&(0,$.BX)("span",{children:["(",(0,$.tZ)("b",{children:(0,$.tZ)(wn,{children:i.toLocaleString()})})," skipped)"]}),p=(0,$.tZ)(wn,{children:(0,Cn.e6)(Math.round((null!=r?r:performance.now())-(null!=l?l:NaN)))});let m,f="",g="";if(o)m=100*t/d,f=(0,$.BX)(Y.Z,{children:["Generating and testing ",u,c?(0,$.BX)($.HY,{children:["/",Z]}):void 0," build configurations against the criteria for ",(0,$.tZ)("b",{children:s}),". ",h]}),g=(0,$.BX)(Y.Z,{children:["Time elapsed: ",p]});else{if(!(t+i))return null;m=100,f=(0,$.BX)(Y.Z,{children:["Generated and tested ",u," Build configurations against the criteria for ",(0,$.tZ)("b",{children:s}),". ",h]}),g=(0,$.BX)(Y.Z,{children:["Total duration: ",p]})}return(0,$.BX)(Ze.Z,{severity:"success",variant:"filled",sx:{"& .MuiAlert-message":{flexGrow:1}},children:[f,g,void 0!==m&&(0,$.BX)(ue.ZP,{container:!0,spacing:1,alignItems:"center",children:[c&&(0,$.tZ)(ue.ZP,{item:!0,children:(0,$.tZ)(Y.Z,{children:`${m.toFixed(1)}%`})}),(0,$.tZ)(ue.ZP,{item:!0,flexGrow:1,children:(0,$.tZ)(Bn,{variant:c?"determinate":"indeterminate",value:m,color:"primary"})})]})]})}var Sn=n(74064),Xn=n(73673),Pn=n(66615),jn=n(75213),Kn=n(47746),On=n(47591),En=n(79536),Dn=n(54878),Tn=n(53163),In=n(20353);function An({characterKey:e}){const{gender:t}=(0,I.Z)(),n=(0,K.m)(e,t);return n?(0,$.tZ)(ut.Z,{placement:"right-end",title:(0,$.tZ)(Y.Z,{children:n.name}),children:(0,$.tZ)(In.Z,{src:(0,G.Li)(e,"iconSide",t),size:3,sideMargin:!0})}):null}var Mn=n(57889),Rn=n(34612),_n=n(61087);function Gn({artifactId:e,slotKey:t,mainStatAssumptionLevel:n=0,showLocation:i=!1,onClick:a,BGComponent:l=y.Z}){var r;const s=(0,Tn.Z)(e),{database:c}=(0,f.useContext)(O.t),o=(0,f.useCallback)((e=>(0,$.tZ)(jn.Z,{onClick:a,sx:{height:"100%"},children:e})),[a]),u=(0,Kn.Z)();if(!s)return(0,$.tZ)(l,{sx:{display:"flex",height:"100%",alignItems:"center",justifyContent:"center"},children:(0,$.tZ)(d.Z,{component:"img",src:En.Z.slot[t],sx:{width:"25%",height:"auto",opacity:.7}})});const{slotKey:Z,rarity:h,level:p,mainStatKey:m,substats:g,location:x}=s,b=Math.max(Math.min(n,4*h),p),v=ve.ZP.unit(m),C=pe.fR.find((e=>s.mainStatKey.includes(e))),w=C?(0,On.Fq)(u.palette[C].main,.6):(0,On.Fq)(u.palette.secondary.main,.6);return(0,$.tZ)(l,{sx:{height:"100%"},children:(0,$.tZ)(Mn.Z,{condition:!!a,wrapper:o,children:(0,$.BX)(d.Z,{display:"flex",height:"100%",children:[(0,$.BX)(d.Z,{className:`grad-${h}star`,sx:{position:"relative",flexGrow:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[(0,$.tZ)(_n.Z,{art:s,children:(0,$.tZ)(d.Z,{component:"img",src:(0,G.Hp)(s.setKey,Z),sx:{m:-1,maxHeight:"110%",maxWidth:"110%"}})}),(0,$.BX)(d.Z,{sx:{position:"absolute",width:"100%",height:"100%",p:.5,opacity:.85,display:"flex",justifyContent:"space-between",pointerEvents:"none"},children:[(0,$.tZ)(xe.Z,{size:"small",label:(0,$.tZ)("strong",{children:` +${p}`}),color:Dn.ZP.levelVariant(p)}),i&&(0,$.tZ)(xe.Z,{size:"small",label:x?(0,$.tZ)(An,{characterKey:x&&c.chars.LocationToCharacterKey(x)}):(0,$.tZ)(Pn.Z,{}),color:"secondary",sx:{overflow:"visible",".MuiChip-label":{overflow:"visible"}}})]}),(0,$.tZ)(xe.Z,{size:"small",sx:{position:"absolute",bottom:0,mb:1,backgroundColor:w,p:1},icon:(0,$.tZ)(ut.Z,{placement:"top",title:(0,$.tZ)(Y.Z,{children:(0,$.tZ)(Rn._,{statKey:m})}),disableInteractive:!0,children:(0,$.tZ)(d.Z,{lineHeight:0,children:(0,$.tZ)(Ce.C,{statKey:m,iconProps:{style:{padding:"4px"}}})})}),label:(0,$.tZ)(Y.Z,{sx:{mx:-.7},children:(0,$.BX)(te.Z,{color:b!==p?"warning":void 0,children:[(0,ve.qs)(null!=(r=Dn.ZP.mainStatValue(m,h,b))?r:0,ve.ZP.unit(m)),v]})})})]}),(0,$.tZ)(d.Z,{display:"flex",flexDirection:"column",justifyContent:"space-between",sx:{p:1},children:g.map(((e,t)=>(0,$.tZ)(zn,{stat:e},t+e.key)))})]})})})}function zn({stat:e}){var t,n;if(!e.value)return null;const i=null!=(t=null==(n=e.rolls)?void 0:n.length)?t:0,a=`roll${(0,Bt.uZ)(i,1,6)}`,l=ve.ZP.unit(e.key);return(0,$.tZ)(d.Z,{display:"flex",gap:1,alignContent:"center",children:(0,$.BX)(Y.Z,{sx:{flexGrow:1,display:"flex",gap:.5,alignItems:"center"},color:i?`${a}.main`:"error.main",component:"span",children:[(0,$.tZ)(ut.Z,{placement:"top",title:(0,$.tZ)(Y.Z,{children:e.key&&(0,$.tZ)(Rn._,{statKey:e.key})}),disableInteractive:!0,children:(0,$.tZ)(d.Z,{lineHeight:0,children:(0,$.tZ)(Ce.C,{statKey:e.key,iconProps:{fontSize:"inherit"}})})}),(0,$.tZ)("span",{children:`${(0,ve.qs)(e.value,ve.ZP.unit(e.key))}${l}`})]})})}var Ln=n(60342);function $n(){const{data:e}=(0,f.useContext)(X.R),t=(0,f.useMemo)((()=>(0,ae.U)(e).filter((([,e])=>Object.values(e).some((e=>!e.isEmpty))))),[e]);return(0,$.tZ)(d.Z,{sx:{mr:-1,mb:-1},children:(0,$.tZ)(Ln.ZP,{columns:{xs:1,sm:2,md:3,xl:4},spacing:1,children:t.map((([e,t])=>(0,$.tZ)(Nn,{displayNs:t,sectionKey:e},e)))})})}function Nn({displayNs:e,sectionKey:t}){const n=(0,f.useContext)(ft),{data:i,oldData:a}=(0,f.useContext)(X.R),{database:l}=(0,f.useContext)(O.t),r=(0,f.useMemo)((()=>(0,ae.f)(i,t,l)),[l,i,t]),s=(0,f.useMemo)((()=>(0,Bt.xh)(e,((e,n)=>(0,wt.UF)(["display",t,n])))),[e,t]);if(!r)return(0,$.tZ)(y.Z,{});const{title:c,icon:o,action:d}=r;return(0,$.BX)(y.Z,{children:[(0,$.tZ)(ee.Z,{avatar:o&&(0,$.tZ)(ne.Z,{size:2,src:o}),title:c,action:d&&(0,$.tZ)(k.Z,{children:d})}),(0,$.tZ)(F.Z,{}),(0,$.tZ)(Ge.lD,{sx:{m:0},children:Object.entries(e).map((([e,i])=>(0,$.tZ)(Ge.JW,{node:i,oldValue:a?a.get(s[e]).value:void 0,component:he.ZP,emphasize:JSON.stringify(n)===JSON.stringify([t,e])},e)))})]})}var Wn=n(51077),Vn=n(71026),qn=n(94758),Fn=n(2031);function Hn({weaponId:e,showLocation:t=!1,onClick:n,BGComponent:i=y.Z}){const{database:a}=(0,f.useContext)(O.t),l=(0,qn.Z)(e),r=(null==l?void 0:l.key)&&(0,Wn.ub)(l.key),s=(0,f.useCallback)((e=>(0,$.tZ)(jn.Z,{sx:{height:"100%"},onClick:n,children:e})),[n]),c=(0,f.useMemo)((()=>r&&l&&(0,xt.mP)([r.data,(0,xt.v0)(l)])),[r,l]);if(!l||!r||!c)return(0,$.tZ)(i,{sx:{height:"100%"},children:(0,$.tZ)(u.Z,{variant:"rectangular",sx:{width:"100%",height:"100%"}})});const{refinement:o,location:Z}=l;return(0,$.tZ)(i,{sx:{height:"100%"},children:(0,$.tZ)(Mn.Z,{condition:!!n,wrapper:s,children:(0,$.BX)(d.Z,{display:"flex",height:"100%",alignItems:"stretch",children:[(0,$.BX)(d.Z,{className:`grad-${r.rarity}star`,sx:{height:"100%",position:"relative",flexGrow:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-end"},children:[(0,$.tZ)(Fn.Z,{sheet:r,children:(0,$.tZ)(d.Z,{component:"img",src:(0,G.Aq)(l.key,l.ascension>=2),sx:{mx:-1,maxHeight:"100%",maxWidth:"100%"}})}),(0,$.BX)(d.Z,{sx:{position:"absolute",width:"100%",height:"100%",p:.5,opacity:.85,display:"flex",justifyContent:"space-between",pointerEvents:"none"},children:[(0,$.tZ)(xe.Z,{size:"small",label:(0,$.tZ)("strong",{children:Vn.Z.getLevelString(l)}),color:"primary"}),t&&(0,$.tZ)(xe.Z,{size:"small",label:Z?(0,$.tZ)(An,{characterKey:a.chars.LocationToCharacterKey(Z)}):(0,$.tZ)(Pn.Z,{}),color:"secondary",sx:{overflow:"visible",".MuiChip-label":{overflow:"visible"}}})]}),(0,$.tZ)(d.Z,{sx:{position:"absolute",width:"100%",height:"100%",p:.5,opacity:.85,display:"flex",justifyContent:"flex-end",alignItems:"flex-end"},children:r.hasRefinement&&(0,$.tZ)(xe.Z,{size:"small",color:"info",label:(0,$.BX)("strong",{children:["R",o]})})})]}),(0,$.BX)(d.Z,{display:"flex",flexDirection:"column",sx:{p:1},children:[(0,$.tZ)(Un,{node:c.get(ye.qH.weapon.main)}),(0,$.tZ)(Un,{node:c.get(ye.qH.weapon.sub)})]})]})})})}function Un({node:e}){return e.info.name?(0,$.tZ)(d.Z,{display:"flex",gap:1,alignContent:"center",children:(0,$.BX)(Y.Z,{sx:{flexGrow:1,display:"flex",gap:1},component:"span",children:[(0,$.tZ)(ut.Z,{placement:"top",title:(0,$.tZ)(Y.Z,{children:e.info.name}),disableInteractive:!0,children:(0,$.tZ)("span",{children:e.info.icon})}),(0,$.tZ)("span",{children:(0,le.p)(e)})]})}):null}var Yn=n(85563),Jn=n(85213);function Qn({artifacts:e,currentlyEquipped:t=!1}){const n=(0,f.useMemo)((()=>e.filter((e=>e)).reduce(((e,t)=>(e[t.setKey]?e[t.setKey].push(t.slotKey):e[t.setKey]=[t.slotKey],e)),{})),[e]);return(0,$.tZ)($.HY,{children:Object.entries(n).sort((([e,t],[n,i])=>i.length-t.length)).map((([e,n])=>(0,$.tZ)(ei,{setKey:e,currentlyEquipped:t,slotarr:n},e)))})}function ei({setKey:e,currentlyEquipped:t=!1,slotarr:n}){var i;const a=(0,Lt.Sk)(e),l=n.length,r=Object.keys(a.setEffects).map((e=>parseInt(e))).filter((e=>e<=l));return(0,$.tZ)(d.Z,{children:(0,$.tZ)(Jn.Z,{artifactSheet:a,numInSet:l,children:(0,$.tZ)(k.Z,{sx:{height:"100%"},color:t?"success":"primary",children:(0,$.BX)(Y.Z,{children:[n.map((e=>(0,$.tZ)(Wt.Z,{slotKey:e,iconProps:we.m},e)))," ",null!=(i=a.name)?i:"",r.map(((e,t)=>(0,$.tZ)(k.Z,{sx:{ml:.5},color:"success",children:e},""+e+t)))]})})})})}let ti,ni,ii,ai=e=>e;function li({label:e,compareBuild:t,extraButtonsRight:n,extraButtonsLeft:i,disabled:a}){const{character:{key:l,equippedArtifacts:r}}=(0,f.useContext)(S.K),{buildSetting:{mainStatAssumptionLevel:s}}=Ht(l),{database:c}=(0,f.useContext)(O.t),o=(0,f.useContext)(X.R),{data:h,oldData:p}=o,[g,x]=(0,f.useState)(void 0),b=(0,f.useCallback)((()=>x(void 0)),[x]),y=(0,f.useCallback)((()=>{if(!window.confirm("Do you want to equip this build to this character?"))return;const e=c.chars.get(l);if(!e)return;pe.Ex.forEach((t=>{const n=h.get(ye.ri.art[t].id).value;if(n)c.arts.set(n,{location:(0,pe.V7)(l)});else{const n=e.equippedArtifacts[t];n&&c.arts.get(n)&&c.arts.set(n,{location:""})}}));const t=h.get(ye.ri.weapon.id).value;t&&c.weapons.set(t,{location:(0,pe.V7)(l)})}),[l,h,c]),C=(0,f.useMemo)((()=>{const e=Object.assign({},o);return t||(e.oldData=void 0),e}),[o,t]),w=(0,f.useMemo)((()=>Object.fromEntries(pe.Ex.map((e=>[e,h.get(ye.ri.art[e].id).value])))),[h]),B=(0,f.useMemo)((()=>w&&Object.values(w).map((e=>c.arts.get(e))).filter((e=>e))),[w,c.arts]),P=(0,f.useMemo)((()=>pe.Ex.map((e=>(0,$.tZ)(ue.ZP,{item:!0,xs:1,children:(0,$.tZ)(Gn,{showLocation:!0,slotKey:e,artifactId:w[e],mainStatAssumptionLevel:s,onClick:()=>{const t=r[e],n=w[e];x({oldId:t!==n?t:void 0,newId:n})}})},e)))),[x,r,s,w]);if(!p)return null;const j=pe.Ex.every((e=>w[e]===p.get(ye.ri.art[e].id).value))&&h.get(ye.ri.weapon.id).value===p.get(ye.ri.weapon.id).value;return(0,$.tZ)(v.Z,{children:(0,$.BX)(f.Suspense,{fallback:(0,$.tZ)(u.Z,{variant:"rectangular",width:"100%",height:600}),children:[g&&(0,$.tZ)(ri,{newOld:g,mainStatAssumptionLevel:s,onClose:b}),(0,$.BX)(Z.Z,{children:[(0,$.BX)(d.Z,{display:"flex",gap:1,sx:{pb:1},flexWrap:"wrap",children:[void 0!==e&&(0,$.tZ)(k.Z,{color:"info",children:(0,$.tZ)(Y.Z,{children:(0,$.BX)("strong",{children:[e,j?" (Equipped)":""]})})}),(0,$.tZ)(Qn,{artifacts:B,currentlyEquipped:j}),(0,$.tZ)(d.Z,{sx:{flexGrow:1,display:"flex",justifyContent:"flex-end"}}),i,(0,$.tZ)(m.Z,{size:"small",color:"success",onClick:y,disabled:a||j,startIcon:(0,$.tZ)(Sn.Z,{}),children:"Equip Build"}),n]}),(0,$.BX)(ue.ZP,{container:!0,spacing:1,sx:{pb:1},columns:{xs:2,sm:3,md:4,lg:6},children:[(0,$.tZ)(ue.ZP,{item:!0,xs:1,children:(0,$.tZ)(Hn,{showLocation:!0,weaponId:h.get(ye.ri.weapon.id).value})}),P]}),(0,$.tZ)(X.R.Provider,{value:C,children:(0,$.tZ)($n,{})})]})]})})}function ri({newOld:{newId:e,oldId:t},mainStatAssumptionLevel:n,onClose:i}){var a,l;const{database:r}=(0,f.useContext)(O.t),{character:{key:s}}=(0,f.useContext)(S.K),c=(0,f.useCallback)((()=>{window.confirm("Do you want to equip this artifact to this character?")&&(r.arts.set(e,{location:(0,pe.V7)(s)}),i())}),[e,r,s,i]),o=null!=(a=null==(l=r.arts.get(e))?void 0:l.location)?a:"";return(0,$.tZ)(ie.Z,{open:!!e,onClose:i,containerProps:{maxWidth:t?"md":"xs"},children:(0,$.tZ)(y.Z,{children:(0,$.BX)(Z.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"stretch",gap:2},children:[t&&(0,$.tZ)(d.Z,{minWidth:320,children:(0,$.tZ)(Yn.Z,{artifactId:t,mainStatAssumptionLevel:n,canEquip:!0,editorProps:{disableSet:!0,disableSlot:!0},extraButtons:(0,$.tZ)(si,{id:t})})}),t&&(0,$.tZ)(d.Z,{display:"flex",flexGrow:1}),t&&(0,$.tZ)(d.Z,{display:"flex",alignItems:"center",justifyContent:"center",children:(0,$.tZ)(m.Z,{onClick:c,sx:{display:"flex"},children:(0,$.tZ)(Xn.Z,{sx:{fontSize:40}})})}),t&&(0,$.tZ)(d.Z,{display:"flex",flexGrow:1}),(0,$.BX)(d.Z,{minWidth:320,display:"flex",flexDirection:"column",gap:1,children:[(0,$.tZ)(Yn.Z,{artifactId:e,mainStatAssumptionLevel:n,canEquip:!0,editorProps:{disableSet:!0,disableSlot:!0},extraButtons:(0,$.tZ)(si,{id:e})}),o&&(0,$.tZ)(ci,{locationKey:o})]})]})})})}function si({id:e}){const{t}=(0,g.$G)("artifact"),{character:{key:n}}=(0,f.useContext)(S.K),{buildSetting:{artExclusion:i},buildSettingDispatch:a}=Ht(n),l=i.includes(e),r=(0,f.useCallback)((()=>a({artExclusion:(0,Bt.nh)(i,e)})),[e,i,a]);return(0,$.tZ)(ut.Z,{title:(0,$.BX)(d.Z,{children:[(0,$.tZ)(Y.Z,{children:t(ti||(ti=ai`excludeArtifactTip`))}),(0,$.tZ)(Y.Z,{children:(0,$.tZ)(te.Z,{color:l?"error":"success",children:t(l?"excluded":"included")})})]}),placement:"top",arrow:!0,children:(0,$.tZ)(m.Z,{onClick:r,color:l?"error":"success",size:"small",children:l?(0,$.tZ)(Rt.Z,{}):(0,$.tZ)(Gt.Z,{})})})}function ci({locationKey:e}){const{t}=(0,g.$G)("artifact"),{character:{key:n}}=(0,f.useContext)(S.K),{buildSetting:{allowLocations:i},buildSettingDispatch:a}=Ht(n),l=!i.includes(e),r=(0,f.useCallback)((()=>a({allowLocations:(0,Bt.nh)(i,e)})),[e,i,a]);return(0,$.tZ)(m.Z,{onClick:r,color:l?"error":"success",size:"small",startIcon:l?(0,$.tZ)(Rt.Z,{}):(0,$.tZ)(Gt.Z,{}),children:t(l?ni||(ni=ai`excludeEquipTip`):ii||(ii=ai`allowEquipTip`))})}var oi=n(68164),di=n(91292),ui=n(61660),Zi=n(58030),hi=n(55484),pi=n(25556),mi=n(81224),fi=n(3131),gi=n(47857),xi=n(55734),bi=n(63004),yi=n(36197),vi=n(62689);function Ci(e){const{database:t}=(0,f.useContext)(O.t),[n,i]=(0,f.useState)((()=>t.buildResult.get(e)));(0,f.useEffect)((()=>i(t.buildResult.get(e))),[t,e]),(0,f.useEffect)((()=>t.buildResult.follow(e,((e,t,n)=>"update"===t&&i(n)))),[e,i,t]);return{buildResult:n,buildResultDispatch:(0,f.useCallback)((n=>e&&t.buildResult.set(e,n)),[e,t])}}var wi=n(85090);function Bi({cx:e,cy:t,payload:n,selectedPoint:i,radiusSelected:a=6,radiusUnselected:l=3,colorSelected:r="red",colorUnselected:s,shape:c="circle"}){if(!e||!t||!n)return null;const o=i&&i.x===n.x&&i.y===n.y;return(0,$.tZ)("g",{className:"custom-dot","data-chart-x":e,"data-chart-y":t,"data-x-value":n.x,"data-y-value":n.y,"data-radius":o?l:a,children:o?(0,$.BX)($.HY,{children:[(0,$.tZ)(ki,{id:"customShapeSelected",shape:c,cx:e,cy:t,r:a/2,fill:r}),(0,$.tZ)(ki,{id:"customShapeBorder",shape:c,cx:e,cy:t,r:a,fill:"none",stroke:r})]}):(0,$.tZ)(ki,{id:"customShapeUnselected",shape:c,cx:e,cy:t,r:l,fill:s})})}function ki({shape:e,id:t,cx:n,cy:i,r:a,fill:l,stroke:r}){switch(e){case"circle":return(0,$.tZ)("circle",{id:t,cx:n,cy:i,r:a,fill:l,stroke:r});case"square":return(0,$.tZ)("rect",{id:t,x:n-a,y:i-a,width:2*a,height:2*a,fill:l,stroke:r});case"diamond":return(0,$.tZ)("polygon",{id:t,points:`${n},${i+2.5*a} ${n+1.5*a},${i} ${n},${i-2.5*a} ${n-1.5*a},${i}`,fill:l,stroke:r})}}var Si=n(99118),Xi=n(69777);const Pi=["xLabel","xUnit","yLabel","yUnit","selectedPoint","setSelectedPoint","addBuildToList"];function ji(e){let{xLabel:t,xUnit:n,yLabel:i,yUnit:a,selectedPoint:l,setSelectedPoint:r,addBuildToList:s}=e,c=(0,Be.Z)(e,Pi);const{database:o}=(0,f.useContext)(O.t),{data:d}=(0,f.useContext)(X.R),{t:h}=(0,g.$G)("page_character_optimize"),p=(0,f.useMemo)((()=>l&&l.artifactIds&&Object.fromEntries(l.artifactIds.map((e=>{const t=o.arts.get(e);return[null==t?void 0:t.slotKey,t]})).filter((e=>e)))),[o.arts,l]),x=(0,f.useCallback)((e=>{e.target.id.includes("customShape")||e.target.id.includes("chartContainer")||r(void 0)}),[r]),b=p&&R.eV.every((e=>{var t;return(null==(t=p[e])?void 0:t.id)===d.get(ye.qH.art[e].id).value})),v=(0,f.useMemo)((()=>(null==l?void 0:l.buildNumber)&&("graph"===l.highlightedType?(0,$.BX)(g.cC,{t:h,i18nKey:"graphBuildLabel",count:null==l?void 0:l.buildNumber,children:["Graph #",{count:(null==l?void 0:l.buildNumber)+1}]}):`#${null==l?void 0:l.buildNumber}`)),[l,h]);return c.active&&l?(0,$.tZ)(Si.Z,{onClickAway:x,children:(0,$.tZ)(y.Z,{sx:{minWidth:"400px",maxWidth:"400px"},onClick:e=>e.stopPropagation(),children:(0,$.tZ)(Z.Z,{children:(0,$.BX)(de.Z,{gap:1,children:[(0,$.BX)(de.Z,{direction:"row",alignItems:"start",gap:1,children:[(0,$.BX)(de.Z,{spacing:.5,flexGrow:99,children:[b&&(0,$.tZ)(k.Z,{color:"info",children:(0,$.tZ)("strong",{children:h("currentlyEquippedBuild")})}),!b&&l.highlighted&&(0,$.tZ)(k.Z,{color:"info",children:v}),(0,$.tZ)(f.Suspense,{fallback:(0,$.tZ)(u.Z,{width:300,height:50}),children:(0,$.tZ)(Qn,{artifacts:Object.values(p),currentlyEquipped:b})})]}),(0,$.tZ)(ue.ZP,{item:!0,flexGrow:1}),(0,$.tZ)(C.Z,{onClick:()=>r(void 0)})]}),(0,$.tZ)(ue.ZP,{container:!0,direction:"row",spacing:.75,columns:5,children:R.eV.map((e=>(0,$.tZ)(ue.ZP,{item:!0,xs:1,children:(0,$.tZ)(f.Suspense,{fallback:(0,$.tZ)(u.Z,{width:75,height:75}),children:(0,$.tZ)(Xi.Z,{artifactObj:p[e],slotKey:e})})},e)))}),(0,$.BX)(Y.Z,{children:[(0,$.tZ)("strong",{children:t}),": ",(0,ve.EC)("%"===n?l.x/100:l.x,n)]}),(0,$.BX)(Y.Z,{children:[(0,$.tZ)("strong",{children:i}),": ",(0,ve.EC)("%"===a?l.y/100:l.y,a)]}),(0,$.tZ)(ut.Z,{title:l.highlighted?h("tcGraph.buildAlreadyInList"):"",placement:"top",children:(0,$.tZ)("span",{children:(0,$.tZ)(m.Z,{sx:{width:"100%"},disabled:!!l.highlighted,color:"info",onClick:()=>s(l.artifactIds),children:h("addBuildToList")})})})]})})})}):null}class Ki{constructor(e,t,n){this.x=void 0,this.trueY=void 0,this.artifactIds=void 0,this.min=void 0,this.current=void 0,this.highlighted=void 0,this.buildNumber=void 0,this.highlightedType=void 0,this.x=e,this.trueY=t,this.artifactIds=n}get y(){return this.trueY||this.current||this.highlighted}set y(e){this.trueY=e}}let Oi,Ei,Di,Ti,Ii,Ai,Mi,Ri=e=>e;function _i({plotBase:e,setPlotBase:t,disabled:n=!1,showTooltip:i=!1}){const{t:a}=(0,g.$G)(["page_character_optimize","ui"]),{data:l}=(0,f.useContext)(X.R),{chartData:r}=(0,f.useContext)(j),[s,c]=(0,f.useState)(!1),[o,d]=(0,f.useState)(!0),{graphBuilds:u}=(0,f.useContext)(j),{character:{key:h}}=(0,f.useContext)(S.K),{buildResult:{builds:p}}=Ci(h),[x,b]=(0,f.useState)(-1/0),[C,w]=(0,f.useState)(1/0),B=(0,f.useCallback)(((e,t)=>{if("number"==typeof t)throw new TypeError;const[n,i]=t;b(n),w(i)}),[b,w]);(0,f.useEffect)((()=>{b(-1/0),w(1/0)}),[r]);const{displayData:k,downloadData:P,sliderMin:K,sliderMax:O}=(0,f.useMemo)((()=>{var e,t;if(!r)return{displayData:null,downloadData:null};let n=1/0,i=-1/0;const a=pe.Ex.map((e=>{var t;return null!=(t=null==l?void 0:l.get(ye.qH.art[e].id).value)?t:""})),s=r.data.map((({value:e,plot:t,artifactIds:l})=>{if(void 0===t)return null;t<n&&(n=t),t>i&&(i=t);const r=new Ki(t,e,l),s=(0,Bt.O)(l,(e=>!0));if(a.every((e=>s[e])))return r.current=e,r.y=void 0,r;const c=p.findIndex((e=>e.every((e=>s[e]))));if(-1!==c)return r.highlighted=e,r.buildNumber=c+1,r.highlightedType="generated",r.y=void 0,r;const o=null==u?void 0:u.findIndex((e=>e.every((e=>s[e]))));return void 0!==o&&-1!==o&&(r.highlighted=e,r.buildNumber=o+1,r.highlightedType="graph",r.y=void 0),r})).filter((e=>null!==e)).sort(((e,t)=>e.x-t.x)),c=[];for(const l of s){let e;for(;e=c.pop();)if(e.y>l.y){c.push(e);break}c.push(l)}(null==(e=c[0])?void 0:e.x)!==(null==(t=s[0])?void 0:t.x)&&(s[0].min=c[0].y),c.forEach((e=>{e.min=e.y}));const o={minimum:c.map((e=>[e.x,e.y])),allData:s.map((e=>[e.x,e.y]))};return{displayData:s.filter((e=>e&&e.x>=x&&e.x<=C)),downloadData:o,sliderMin:n,sliderMax:i}}),[r,p,l,u,x,C]),E=e&&(0,Bt.Hm)(null==l?void 0:l.getDisplay(),e),D=a(e&&(!E||E.isEmpty)?"page_character_optimize:targetSelector.invalidTarget":"page_character_optimize:targetSelector.selectGraphTarget");return(0,$.BX)(v.Z,{children:[(0,$.tZ)(Z.Z,{children:(0,$.BX)(ue.ZP,{container:!0,spacing:1,alignItems:"center",children:[(0,$.tZ)(ue.ZP,{item:!0,children:(0,$.tZ)(Y.Z,{children:a(Oi||(Oi=Ri`tcGraph.vs`))})}),(0,$.tZ)(ue.ZP,{item:!0,children:(0,$.tZ)(ut.Z,{placement:"top",title:i?a("page_character_optimize:selectTargetFirst"):"",children:(0,$.tZ)("span",{children:(0,$.tZ)(wi.Z,{optimizationTarget:e,setTarget:e=>t(e),defaultText:D,disabled:n})})})}),(0,$.tZ)(ue.ZP,{item:!0,children:(0,$.tZ)(ut.Z,{title:e?a("ui:reset"):"",placement:"top",children:(0,$.tZ)("span",{children:(0,$.tZ)(m.Z,{color:"error",onClick:()=>t(void 0),disabled:!e||n,children:(0,$.tZ)(me.Z,{})})})})}),(0,$.tZ)(ue.ZP,{item:!0,flexGrow:1,children:(0,$.tZ)(pt.Z,{placement:"top",title:a("page_character_optimize:tcGraph.desc")})}),!!P&&(0,$.tZ)(ue.ZP,{item:!0,children:(0,$.tZ)(m.Z,{size:"small",startIcon:o?(0,$.tZ)(fe.Z,{}):(0,$.tZ)(ge.Z,{}),color:o?"success":"secondary",onClick:()=>d(!o),children:a(Ei||(Ei=Ri`tcGraph.showStatThr`))})}),!!P&&(0,$.tZ)(ue.ZP,{item:!0,children:(0,$.tZ)(m.Z,{size:"small",color:"info",startIcon:(0,$.tZ)(oi.Z,{}),onClick:()=>c(!s),children:a(Di||(Di=Ri`tcGraph.downloadData`))})})]})}),k&&k.length&&(0,$.tZ)(F.Z,{}),r&&k&&k.length&&(0,$.BX)(Z.Z,{children:[(0,$.tZ)(be.Z,{in:!!P&&s,children:(0,$.tZ)(y.Z,{sx:{mb:2},children:(0,$.BX)(Z.Z,{children:[(0,$.tZ)(Y.Z,{children:"Min Data"}),(0,$.tZ)(vi.Z,{value:JSON.stringify(null==P?void 0:P.minimum)}),(0,$.tZ)(Y.Z,{children:"All Data"}),(0,$.tZ)(vi.Z,{value:JSON.stringify(null==P?void 0:P.allData)})]})})}),(0,$.tZ)(Ni,{displayData:k,plotNode:r.plotNode,valueNode:r.valueNode,showMin:o}),k.length>1&&(0,$.tZ)(di.ZP,{marks:!0,value:[x,C],onChange:B,onChangeCommitted:B,min:K,max:O,step:(O-K)/20,valueLabelDisplay:"auto",valueLabelFormat:e=>{var t,n;return(0,ve.EC)("%"===(null==(t=r.plotNode.info)?void 0:t.unit)?e/100:e,null==(n=r.plotNode.info)?void 0:n.unit)},sx:{ml:"6%",width:"93%"}})]})]})}const Gi="#8884d8",zi="cyan",Li="#46a046",$i="#ff7300";function Ni({displayData:e,plotNode:t,valueNode:n,showMin:i}){var a,l,r,s;const{graphBuilds:c,setGraphBuilds:o}=(0,f.useContext)(j),{t:d}=(0,g.$G)("page_character_optimize"),[u,Z]=(0,f.useState)(),h=(0,f.useCallback)((e=>{o([...null!=c?c:[],e]),Z(void 0)}),[o,c]),p=(0,f.useCallback)((t=>{t&&t.chartX&&t.chartY&&Z(function(e,t,n,i){const a=Array.from(document.querySelectorAll(".custom-dot")).reduce(((n,i)=>{const{chartX:a,chartY:l}=n.dataset,r=Math.sqrt((e-a)**2+(t-l)**2),{chartX:s,chartY:c}=i.dataset;return r<=Math.sqrt((e-s)**2+(t-c)**2)?n:i})).dataset;return Math.sqrt((e-a.chartX)**2+(t-a.chartY)**2)<n?i.find((e=>e.x===+a.xValue&&e.y===+a.yValue)):void 0}(t.chartX,t.chartY,20,e))}),[Z,e]),m=Wi(t,d),x=Wi(n,d);return(0,$.tZ)(ui.h,{width:"100%",height:600,children:(0,$.BX)(Zi.c,{id:"chartContainer",data:e,onClick:p,style:{cursor:"pointer"},children:[(0,$.tZ)(hi.q,{strokeDasharray:"3 3"}),(0,$.tZ)(pi.K,{dataKey:"x",scale:"linear",unit:null==(a=t.info)?void 0:a.unit,domain:["auto","auto"],tick:{fill:"white"},type:"number",tickFormatter:e=>e>1e4?e.toFixed():e.toFixed(1),label:(0,$.tZ)(mi._,{fill:"white",dy:10,children:m}),height:50}),(0,$.tZ)(fi.B,{name:"DMG",domain:["auto","auto"],unit:null==(l=n.info)?void 0:l.unit,allowDecimals:!1,tick:{fill:"white"},type:"number",label:(0,$.tZ)(mi._,{fill:"white",angle:-90,dx:-40,children:x}),width:100}),(0,$.tZ)(gi.u,{content:(0,$.tZ)(ji,{xLabel:m,xUnit:null==(r=t.info)?void 0:r.unit,yLabel:x,yUnit:null==(s=n.info)?void 0:s.unit,selectedPoint:u,setSelectedPoint:Z,addBuildToList:h}),trigger:"click",wrapperStyle:{pointerEvents:"auto",cursor:"auto"},cursor:!1}),(0,$.tZ)(xi.D,{payload:[...i?[{id:"min",value:d(Ti||(Ti=Ri`tcGraph.statReqThr`)),type:"line",color:$i}]:[],{id:"trueY",value:d(Ii||(Ii=Ri`tcGraph.generatedBuilds`)),type:"circle",color:Gi},{id:"highlighted",value:d(Ai||(Ai=Ri`tcGraph.highlightedBuilds`)),type:"square",color:zi},{id:"current",value:d(Mi||(Mi=Ri`tcGraph.currentBuild`)),type:"diamond",color:Li}]}),i&&(0,$.tZ)(bi.x,{dataKey:"min",stroke:$i,type:"stepBefore",connectNulls:!0,strokeWidth:2,isAnimationActive:!1,dot:!1,activeDot:!1}),(0,$.tZ)(yi.b,{dataKey:"trueY",isAnimationActive:!1,shape:(0,$.tZ)(Bi,{selectedPoint:u,colorUnselected:Gi})}),(0,$.tZ)(yi.b,{dataKey:"highlighted",isAnimationActive:!1,shape:(0,$.tZ)(Bi,{shape:"square",selectedPoint:u,colorUnselected:zi})}),(0,$.tZ)(yi.b,{dataKey:"current",isAnimationActive:!1,shape:(0,$.tZ)(Bi,{shape:"diamond",selectedPoint:u,colorUnselected:Li})})]})})}function Wi(e,t){var n,i,a,l,r,s,c;return"string"==typeof(null==(n=e.info)?void 0:n.name)?e.info.name:`${t(`${null==(i=e.info)||null==(a=i.name)?void 0:a.props.ns}:${null==(l=e.info)||null==(r=l.name)?void 0:r.props.key18}`)}${null!=(s=e.info)&&s.textSuffix?` ${null==(c=e.info)?void 0:c.textSuffix}`:""}`}var Vi=n(93553),qi=n(19157),Fi=n(71957),Hi=n(1661);let Ui,Yi,Ji,Qi,ea,ta=e=>e;function na({disabled:e=!1}){const{t}=(0,g.$G)("page_character_optimize"),{character:{key:n}}=(0,f.useContext)(S.K),{buildSetting:{artExclusion:i},buildSettingDispatch:a}=Ht(n),[l,r,s]=(0,E.Z)(!1),c=i.length,[o,u,h]=(0,E.Z)(!1),p=(0,f.useCallback)((e=>{a({artExclusion:[...i,e]})}),[a,i]),x=(0,f.useCallback)((e=>{a({artExclusion:i.filter((t=>t!==e))})}),[a,i]);return(0,$.BX)($.HY,{children:[(0,$.tZ)(ie.Z,{open:l,onClose:s,containerProps:{maxWidth:"xl"},children:(0,$.BX)(y.Z,{children:[(0,$.tZ)(Z.Z,{children:(0,$.BX)(d.Z,{display:"flex",gap:1,alignItems:"center",children:[(0,$.tZ)(Y.Z,{variant:"h6",children:t(Ui||(Ui=ta`useExcluded.title_exclude`))}),(0,$.tZ)(pt.Z,{title:(0,$.tZ)(Y.Z,{children:t(Yi||(Yi=ta`useExcluded.title_tooltip`))})}),(0,$.tZ)(d.Z,{flexGrow:1}),(0,$.tZ)(C.Z,{onClick:s,size:"small"})]})}),(0,$.tZ)(F.Z,{}),(0,$.BX)(Z.Z,{children:[(0,$.tZ)(la,{show:o,onClose:h,onSelect:p,artExclusion:i}),(0,$.tZ)(m.Z,{fullWidth:!0,onClick:u,color:"info",sx:{mb:1},startIcon:(0,$.tZ)(Vi.Z,{}),children:t(Ji||(Ji=ta`useExcluded.addExc`))}),!!c&&(0,$.tZ)(v.Z,{sx:{mb:1},children:(0,$.tZ)(Y.Z,{textAlign:"center",children:t(Qi||(Qi=ta`useExcluded.deSelectExc`))})}),(0,$.tZ)(ue.ZP,{container:!0,columns:{xs:3,md:5,lg:6,xl:8},spacing:1,children:i.map((e=>(0,$.tZ)(ue.ZP,{item:!0,xs:1,children:(0,$.tZ)(Gn,{artifactId:e,slotKey:"flower",BGComponent:v.Z,onClick:()=>x(e),showLocation:!0})},e)))})]})]})}),(0,$.tZ)(m.Z,{fullWidth:!0,onClick:r,disabled:e,startIcon:(0,$.tZ)(Rt.Z,{}),color:"info",children:(0,$.BX)(d.Z,{sx:{display:"flex",gap:1},children:[(0,$.tZ)(d.Z,{children:t("useExcluded.title_exclude")}),(0,$.tZ)(k.Z,{children:(0,$.BX)(g.cC,{t,i18nKey:"useExcluded.excNum",count:c,children:["Excluded ",(0,$.tZ)("strong",{children:{count:c}})," artifacts"]})})]})})]})}const ia={xs:6,sm:6,md:9,lg:12,xl:12},aa=(e,t)=>Object.assign({},e,t);function la({onSelect:e,show:t,onClose:n,artExclusion:i}){const{t:a}=(0,g.$G)("page_character_optimize"),{database:l}=(0,f.useContext)(O.t),r=(0,f.useCallback)((t=>{e(t),n(),console.log({id:t})}),[e,n]),[s,c]=(0,f.useReducer)(aa,(0,Fi.Af)()),[o,h]=(0,yt.Z)();(0,f.useEffect)((()=>l.arts.followAny(h)),[l,h]);const p=(0,vt.Z)(),m=(0,f.useMemo)((()=>(0,Fi.EM)()),[]),x=(0,f.useMemo)((()=>{const e=(0,Hi.C)(s,m);return o&&l.arts.values.filter(e).map((e=>e.id)).filter((e=>!i.includes(e))).slice(0,ia[p])}),[o,l,m,s,p,i]);return(0,$.tZ)(ie.Z,{open:t,onClose:n,containerProps:{maxWidth:"xl"},children:(0,$.BX)(y.Z,{children:[(0,$.BX)(Z.Z,{sx:{py:1,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,$.tZ)(Y.Z,{variant:"h6",children:a(ea||(ea=ta`useExcluded.selExc`))}),(0,$.tZ)(C.Z,{onClick:n})]}),(0,$.tZ)(F.Z,{}),(0,$.BX)(Z.Z,{children:[(0,$.tZ)(f.Suspense,{fallback:(0,$.tZ)(u.Z,{variant:"rectangular",width:"100%",height:200}),children:(0,$.tZ)(qi.default,{filterOption:s,filterOptionDispatch:c,filteredIds:x})}),(0,$.tZ)(d.Z,{mt:1,children:(0,$.tZ)(f.Suspense,{fallback:(0,$.tZ)(u.Z,{variant:"rectangular",width:"100%",height:300}),children:(0,$.tZ)(ue.ZP,{container:!0,spacing:1,columns:{xs:2,md:3,lg:4},children:x.map((e=>(0,$.tZ)(ue.ZP,{item:!0,xs:1,children:(0,$.tZ)(Yn.Z,{artifactId:e,onClick:r})},e)))})})})]})]})})}var ra=n(16230),sa=n(51704);let ca,oa,da,ua,Za=e=>e;function ha({disabled:e=!1,numArtsEquippedUsed:t}){const{t:n}=(0,g.$G)("page_character_optimize"),{character:{key:i}}=(0,f.useContext)(S.K),{buildSetting:{allowLocations:a},buildSettingDispatch:l}=Ht(i),{database:r}=(0,f.useContext)(O.t),[s,c,o]=(0,E.Z)(!1),[u,h]=(0,yt.Z)(),p=(0,f.useDeferredValue)(u);(0,f.useEffect)((()=>r.charMeta.followAny((e=>h()))),[h,r]),(0,f.useEffect)((()=>r.chars.followAny((e=>h()))),[h,r]);const x=(0,f.useMemo)((()=>p&&Array.from(new Set(Object.entries(r.chars.data).filter((([e])=>e!==i)).sort((([e,t],[n,i])=>{const[a,l]=[-1,1],s=r.charMeta.get(e).favorite,c=r.charMeta.get(n).favorite;if(s&&!c)return a;if(c&&!s)return l;const o=Object.values(t.equippedArtifacts).filter((e=>e)).length,d=Object.values(i.equippedArtifacts).filter((e=>e)).length;return o>d?a:d>o?l:e.localeCompare(n)})).map((([e])=>(0,pe.V7)(e)))))),[p,i,r]),b=(0,f.useCallback)((()=>l({allowLocations:[...x]})),[l,x]),v=(0,f.useCallback)((()=>l({allowLocations:[]})),[l]),w=(0,f.useCallback)((e=>l({allowLocations:(0,Bt.nh)(a,e)})),[a,l]),B=x.length,X=a.length;return(0,$.BX)(d.Z,{display:"flex",gap:1,children:[(0,$.tZ)(ie.Z,{open:s,onClose:o,containerProps:{maxWidth:"xl"},children:(0,$.BX)(y.Z,{children:[(0,$.tZ)(Z.Z,{children:(0,$.BX)(d.Z,{display:"flex",gap:1,children:[(0,$.tZ)(Y.Z,{variant:"h6",flexGrow:1,children:n(ca||(ca=Za`ExcludeChar.modal.title_sel`))}),(0,$.tZ)(C.Z,{onClick:o,size:"small"})]})}),(0,$.tZ)(F.Z,{}),(0,$.BX)(Z.Z,{children:[(0,$.BX)(d.Z,{pb:1,display:"flex",gap:1,flexWrap:"wrap",children:[(0,$.BX)(m.Z,{color:"success",sx:{flexGrow:1},onClick:b,children:[n(oa||(oa=Za`ExcludeChar.modal.allow_all`)),(0,$.tZ)(k.Z,{sx:{ml:1},children:(0,$.tZ)("strong",{children:`${X}/${B}`})})]}),(0,$.BX)(m.Z,{color:"error",sx:{flexGrow:1},onClick:v,children:[n(da||(da=Za`ExcludeChar.modal.disallow_All`)),(0,$.tZ)(k.Z,{sx:{ml:1},children:(0,$.tZ)("strong",{children:`${B-X}/${B}`})})]})]}),(0,$.tZ)(ue.ZP,{container:!0,spacing:1,columns:{xs:6,sm:7,md:10,lg:12,xl:16},children:x.map(((e,t)=>(0,$.tZ)(ue.ZP,{item:!0,xs:1,children:(0,$.tZ)(pa,{locKey:e,onClick:()=>w(e),selected:a.includes(e)})},e)))})]})]})}),(0,$.tZ)(m.Z,{sx:{flexGrow:1},color:"info",onClick:c,disabled:e,startIcon:(0,$.tZ)(ra.Z,{}),children:(0,$.BX)(d.Z,{sx:{display:"flex",gap:1,alignItems:"center"},children:[(0,$.tZ)("span",{children:n(ua||(ua=Za`ExcludeChar.title`))}),(0,$.tZ)(k.Z,{sx:{whiteSpace:"normal"},children:(0,$.BX)(g.cC,{t:n,i18nKey:"ExcludeChar.usingNumTot",count:X,arts:t,children:["Using ",(0,$.tZ)("strong",{children:{arts:t}})," artifacts from ",(0,$.tZ)("strong",{children:{count:X}})," characters"]})})]})})]})}function pa({locKey:e,selected:t,onClick:n}){const{database:i}=(0,f.useContext)(O.t),a=i.chars.get(i.chars.LocationToCharacterKey(e));return(0,$.tZ)(jn.Z,{onClick:n,sx:{},children:(0,$.BX)(v.Z,{sx:{opacity:t?void 0:.6,borderColor:t?"rgb(100,200,100)":"rgb(200,100,100)",borderWidth:"3px",borderStyle:"solid",borderRadius:"8px"},children:[(0,$.tZ)(sa.Z,{characterKey:i.chars.LocationToCharacterKey(e)}),(0,$.tZ)(d.Z,{fontSize:"0.85em",display:"flex",justifyContent:"space-between",p:.3,children:pe.Ex.map((e=>(0,$.tZ)(Wt.Z,{slotKey:e,iconProps:{fontSize:"inherit",sx:{opacity:null!=a&&a.equippedArtifacts[e]?void 0:.5}}},e)))})]})})}var ma=n(11716),fa=n(92658),ga=n(56),xa=n(12777),ba=n(10618),ya=n(40775);const va=["sands","goblet","circlet"];function Ca({disabled:e=!1,filteredArtIdMap:t}){const{t:n}=(0,g.$G)("artifact"),{character:{key:i}}=(0,f.useContext)(S.K),{buildSetting:{mainStatKeys:a},buildSettingDispatch:l}=Ht(i),{database:r}=(0,f.useContext)(O.t),{mainStatSlotTots:s,slotTots:c}=(0,f.useMemo)((()=>{const e={flowerMainStatTots:Dn.ZP.slotMainStats("flower"),plumeMainStatTots:Dn.ZP.slotMainStats("plume"),sandsMainStatTots:Dn.ZP.slotMainStats("sands"),gobletMainStatTots:Dn.ZP.slotMainStats("goblet"),circletMainStatTots:Dn.ZP.slotMainStats("circlet"),slotTots:va},n=(0,ya.A)(e,(e=>Object.entries(r.arts.data).forEach((([n,i])=>{const{slotKey:a,mainStatKey:l}=i;va.includes(a)&&(e.slotTots[a].total++,t[n]&&e.slotTots[a].current++),e[`${a}MainStatTots`][l].total++,t[n]&&e[`${a}MainStatTots`][l].current++}))));return{mainStatSlotTots:{flower:n.flowerMainStatTots,plume:n.plumeMainStatTots,sands:n.sandsMainStatTots,goblet:n.gobletMainStatTots,circlet:n.circletMainStatTots},slotTots:n.slotTots}}),[r,t]);return(0,$.BX)(d.Z,{display:"flex",flexDirection:"column",children:[(0,$.tZ)(F.Z,{}),(0,$.BX)(d.Z,{display:"flex",children:[(0,$.tZ)(Z.Z,{sx:{flexGrow:1},children:(0,$.BX)(d.Z,{sx:{display:"flex",gap:1,alignItems:"center"},children:[(0,$.tZ)(ut.Z,{placement:"top",title:(0,$.tZ)(Y.Z,{children:n("slotName.flower")}),children:(0,$.tZ)(ma.Z,{fontSize:"inherit"})}),(0,$.tZ)(d.Z,{flexGrow:1,children:(0,$.BX)(k.Z,{color:"info",children:[(0,$.tZ)(xa.Z,Object.assign({},we.m))," ",s.flower.hp]})})]})}),(0,$.tZ)(F.Z,{orientation:"vertical",flexItem:!0}),(0,$.tZ)(Z.Z,{sx:{flexGrow:1},children:(0,$.BX)(d.Z,{sx:{display:"flex",gap:1,alignItems:"center"},children:[(0,$.tZ)(ut.Z,{placement:"top",title:(0,$.tZ)(Y.Z,{children:n("slotName.plume")}),children:(0,$.tZ)(fa.Z,{fontSize:"inherit"})}),(0,$.tZ)(d.Z,{flexGrow:1,children:(0,$.BX)(k.Z,{color:"info",children:[(0,$.tZ)(ga.Z,Object.assign({},we.m))," ",s.plume.atk]})})]})})]}),va.map((t=>{const i=a[t],r=Dn.ZP.slotMainStats(t),o=(0,ba.X)([...r]);return(0,$.BX)(d.Z,{children:[(0,$.tZ)(F.Z,{}),(0,$.BX)(Z.Z,{sx:{pt:1,pb:1},children:[(0,$.BX)(d.Z,{sx:{display:"flex",gap:1,alignItems:"center",pb:1},children:[(0,$.tZ)(ut.Z,{placement:"top",title:(0,$.tZ)(Y.Z,{children:n(`slotName.${t}`)}),children:(0,$.tZ)(d.Z,{lineHeight:0,children:(0,$.tZ)(Wt.Z,{slotKey:t,iconProps:{fontSize:"inherit"}})})}),(0,$.tZ)(d.Z,{flexGrow:1,children:(0,$.tZ)(k.Z,{color:"info",children:c[t]})})]}),(0,$.tZ)(ue.ZP,{container:!0,spacing:1,children:r.map(((n,r)=>{const c=pe.fR.find((e=>n.includes(e))),d=i.includes(n)?null!=c?c:"success":"secondary";return(0,$.tZ)(ue.ZP,{item:!0,flexGrow:1,xs:r<3&&"goblet"!==t||"goblet"===t?4:void 0,children:(0,$.tZ)(ut.Z,{placement:"top",title:(0,$.tZ)(Y.Z,{children:(0,$.tZ)("strong",{children:(0,$.tZ)(Rn._,{statKey:n})})}),disableInteractive:!0,children:(0,$.tZ)(m.Z,{fullWidth:!0,size:"small",color:d,sx:{height:"100%",pointerEvents:e?"none":void 0,cursor:e?"none":void 0},startIcon:(0,$.tZ)(Ce.C,{statKey:n}),onClick:()=>l({mainStatKeys:Object.assign({},a,{[t]:o(i,n)})}),children:s[t][n]})})},n)}))})]})]},t)}))]})}function wa({statFilters:e,setStatFilters:t,disabled:n=!1}){const i=(0,f.useCallback)(((n,i,a)=>{var l;const r=Object.assign({},e),s=JSON.stringify(i),c=i?[...e[s]]:void 0,o=JSON.stringify(n),d=[...null!=(l=e[o])?l:[]];void 0!==a&&c?d.push(c[a]):d.push({value:0,disabled:!1}),r[o]=d,void 0!==a&&c&&(c.splice(a,1),c.length?r[s]=c:delete r[s]),t(Object.assign({},r))}),[t,e]),a=(0,f.useCallback)(((n,i)=>{const a=Object.assign({},e),l=JSON.stringify(n),r=[...e[l]];r.splice(i,1),r.length?a[l]=r:delete a[l],t(Object.assign({},a))}),[t,e]),l=(0,f.useCallback)(((n,i,a)=>{const l=Object.assign({},e),r=JSON.stringify(n),s=[...e[r]];s[i]=Object.assign({},s[i],{value:a}),l[r]=s,t(Object.assign({},l))}),[t,e]),r=(0,f.useCallback)(((n,i,a)=>{const l=Object.assign({},e),r=JSON.stringify(n),s=[...e[r]];s[i]=Object.assign({},s[i],{disabled:a}),l[r]=s,t(Object.assign({},l))}),[t,e]);return(0,$.BX)($.HY,{children:[Object.entries(e).flatMap((([e,t])=>null==t?void 0:t.map(((t,s)=>(0,$.tZ)(Ba,{path:JSON.parse(e),setting:t,index:s,setTarget:i,delTarget:a,setValue:l,setDisabled:r,disabled:n},e+s))))),(0,$.tZ)(Ba,{setTarget:i,delTarget:a,setValue:l,setDisabled:r,disabled:n})]})}function Ba({path:e,setting:t,index:n,setTarget:i,delTarget:a,setValue:l,setDisabled:r,disabled:s}){var c;const{t:o}=(0,g.$G)("page_character_optimize"),{data:d}=(0,f.useContext)(X.R),u=(0,f.useCallback)((t=>e&&void 0!==n&&l(e,n,null!=t?t:0)),[l,e,n]),Z={p:1,flexBasis:30,flexGrow:0,flexShrink:0},h=(0,Bt.Hm)(d.getDisplay(),null!=e?e:[]),p="%"===(null==h||null==(c=h.info)?void 0:c.unit);return(0,$.BX)(je.Z,{sx:{"& .MuiButtonGroup-grouped":{minWidth:24},width:"100%"},children:[!!t&&!!e&&void 0!==n&&(0,$.tZ)(m.Z,{sx:Z,color:t.disabled?"secondary":"success",onClick:()=>r(e,n,!t.disabled),disabled:s,children:t.disabled?(0,$.tZ)(ge.Z,{}):(0,$.tZ)(fe.Z,{})}),(0,$.tZ)(wi.Z,{showEmptyTargets:!0,optimizationTarget:e,setTarget:t=>i(t,e,n),defaultText:o("targetSelector.selectBuildTarget")}),(0,$.tZ)(Ke.CC,{sx:{flexBasis:150,flexGrow:1},children:(0,$.tZ)(Ke.ZP,{float:!0,disabled:!e||s,value:null==t?void 0:t.value,placeholder:"Stat Value",onChange:u,sx:{px:1},inputProps:{sx:{textAlign:"right"}},endAdornment:p?"%":void 0})}),!!e&&void 0!==n&&(0,$.tZ)(m.Z,{sx:Z,color:"error",onClick:()=>a(e,n),disabled:s,children:(0,$.tZ)(at.Z,{fontSize:"small"})})]})}let ka,Sa,Xa=e=>e;function Pa({disabled:e=!1}){const{t}=(0,g.$G)("page_character_optimize"),{character:{key:n}}=(0,f.useContext)(S.K),{buildSetting:{statFilters:i},buildSettingDispatch:a}=Ht(n),l=(0,f.useCallback)((e=>a({statFilters:e})),[a]);return(0,$.BX)(d.Z,{children:[(0,$.tZ)(v.Z,{children:(0,$.BX)(Z.Z,{sx:{display:"flex",gap:1,justifyContent:"space-between"},children:[(0,$.tZ)(Y.Z,{children:t(ka||(ka=Xa`constraintFilter.title`))}),(0,$.tZ)(pt.Z,{title:(0,$.tZ)(Y.Z,{children:t(Sa||(Sa=Xa`constraintFilter.tooltip`))})})]})}),(0,$.tZ)(d.Z,{display:"flex",flexDirection:"column",gap:.5,children:(0,$.tZ)(wa,{statFilters:i,setStatFilters:l,disabled:e})})]})}let ja,Ka=e=>e;function Oa(){const{t:e}=(0,g.$G)("page_character_optimize");return(0,$.tZ)(Ze.Z,{severity:"error",variant:"filled",onClick:()=>window.location.reload(),sx:{"& .MuiAlert-message":{flexGrow:1,cursor:"pointer"}},children:e(ja||(ja=Ka`workerLoadFailed`))})}var Ea=n(69190);const Da=(0,wt.yY)((0,Bt.I8)({dyn:Object.assign({},ye.qH.art,ye.qH.artSet)})),Ta={art:(0,Bt.O)([...Ea.rW,...Ea._m],(e=>Da.dyn[e])),artSet:(0,Bt.xh)(ye.qH.artSet,((e,t)=>Da.dyn[t]))};let Ia,Aa,Ma,Ra,_a,Ga,za=e=>e;const La=new Audio("notification.mp3");function $a(){var e,t;const{t:n}=(0,g.$G)("page_character_optimize"),{character:{key:i,compareData:a}}=(0,f.useContext)(S.K),{database:l}=(0,f.useContext)(O.t),{setChartData:s,graphBuilds:c,setGraphBuilds:o}=(0,f.useContext)(j),{gender:u}=(0,I.Z)(),[h,p]=(0,f.useState)(!1),x=(0,f.useRef)(!1);(0,f.useEffect)((()=>{x.current=h}),[h]);const[y,C]=(0,f.useState)({type:"inactive",tested:0,failed:0,skipped:0,total:0}),B="inactive"!==y.type,[P,K]=(0,yt.Z)(),[{threads:E=gt.g},D]=(0,f.useState)(l.displayOptimize.get());(0,f.useEffect)((()=>l.displayOptimize.follow(((e,t)=>D(t)))),[l,D]);const M=E>gt.g?gt.g:E,R=(0,f.useCallback)((e=>l.displayOptimize.set({threads:e})),[l]),_=(0,T.Z)(i),G=(0,L.Z)();(0,f.useEffect)((()=>{C({type:"inactive",tested:0,failed:0,skipped:0,total:0})}),[i]);const z=(0,f.useMemo)((()=>!l.arts.values.length),[l]),{buildSetting:N,buildSettingDispatch:W}=Ht(i),{plotBase:V,optimizationTarget:q,mainStatAssumptionLevel:H,allowPartial:U,maxBuildsToShow:J,levelLow:Q,levelHigh:ee}=N,{buildResult:{builds:te,buildDate:ne},buildResultDispatch:ie}=Ci(i),ae=(0,A.Z)(i,H),{characterSheet:le,target:re}=null!=(e=null==ae?void 0:ae[i])?e:{},se=q&&(0,Bt.Hm)(null==re?void 0:re.getDisplay(),q),ce=["xs","sm"].includes((0,vt.Z)());(0,f.useEffect)((()=>l.arts.followAny(K)),[K,l]);const oe=(0,f.useDeferredValue)(P),de=(0,f.useDeferredValue)(N),{filteredArts:he,numEquippedUsed:me}=(0,f.useMemo)((()=>{const{mainStatKeys:e,allowLocations:t,levelLow:n,levelHigh:a}=oe&&de;let r=0;return{filteredArts:l.arts.values.filter((l=>{if(l.level<n)return!1;if(l.level>a)return!1;const s=e[l.slotKey];if(null!=s&&s.length&&!s.includes(l.mainStatKey))return!1;const c=(0,pe.V7)(i);if(l.location&&l.location!==c){if(!t.includes(l.location))return!1;r++}return!0})),numEquippedUsed:r}}),[l,i,oe,de]),xe=(0,f.useMemo)((()=>(0,Bt.O)(he.map((({id:e})=>e)),(e=>!0))),[he]),be=(0,f.useMemo)((()=>{const{levelLow:e,levelHigh:t}=de;let n=0,i=0;return Object.entries(l.arts.data).forEach((([a,l])=>{l.level>=e&&l.level<=t&&(n++,xe[a]&&i++)})),`${i}/${n}`}),[de,xe,l]),ye=(0,f.useRef)(!0);(0,f.useEffect)((()=>{const e=()=>ye.current=!0,t=()=>ye.current=!1;return window.addEventListener("focus",e),window.addEventListener("blur",t),()=>{window.removeEventListener("focus",e),window.removeEventListener("blur",t)}}),[ye]);const ve=(0,f.useRef)((()=>{}));(0,f.useEffect)((()=>()=>ve.current()),[]);const[Ce,we]=(0,f.useState)(!1),Be=(0,f.useCallback)((async()=>{var e,t,a;const{artSetExclusion:r,plotBase:c,statFilters:o,optimizationTarget:d,mainStatAssumptionLevel:Z,allowPartial:h,maxBuildsToShow:p}=N;if(!i||!d)return;const m=function(e,t,n){const i={base:{},values:{flower:[],plume:[],goblet:[],circlet:[],sands:[]}},a=new Set;for(const l of e){const e=Dn.ZP.mainStatValue(l.mainStatKey,l.rarity,Math.max(Math.min(t,4*l.rarity),l.level)),n={id:l.id,set:l.setKey,values:Object.assign({[l.setKey]:1,[l.mainStatKey]:l.mainStatKey.endsWith("_")?e/100:e},Object.fromEntries(l.substats.map((e=>[e.key,e.key.endsWith("_")?e.accurateValue/100:e.accurateValue]))))};delete n.values[""],i.values[l.slotKey].push(n),Object.keys(n.values).forEach((e=>a.add(e)))}if(i.base=(0,Bt.O)([...a],(e=>0)),n)for(const l of Object.values(i.values))l.push({id:"",values:{}});return i}(he,Z,h),f=(0,A.V)(l,i,Z,[]);if(!f)return;const g=null==(e=(0,xt.Qo)(f.teamData,u,i)[i])?void 0:e.target.data[0];if(!g)return;Object.assign(g,(0,xt.b3)([g,Ta]));const b=(0,Bt.Hm)(null!=(t=g.display)?t:{},d);if(!b)return;const y=b,v=Object.entries(o).flatMap((([e,t])=>t.filter((e=>!e.disabled)).map((t=>{var n,i;const a=(0,Bt.Hm)(null!=(n=g.display)?n:{},JSON.parse(e));return{value:a,minimum:"%"===(null==(i=a.info)?void 0:i.unit)?t.value/100:t.value}})))).filter((e=>e.value&&e.minimum>-1/0));s(void 0);const w=new Promise((e=>ve.current=e));we(!1);const B=[...v.map((e=>e.value)),b],k=[...v.map((e=>e.minimum)),-1/0],S=c&&(0,Bt.Hm)(null!=(a=g.display)?a:{},c);S&&(B.push(S),k.push(-1/0));const X=(0,bt.tL)(B,g,(({path:[e]})=>"dyn"!==e)),P=S?X.pop():void 0,j={arts:m,optimizationTarget:X.pop(),exclusion:r,constraints:X.map(((e,t)=>({value:e,min:k[t]}))),topN:p,plotBase:P},K={tested:0,failed:0,skipped:0,total:0,startTime:performance.now()},O=setInterval((()=>C(Object.assign({type:"active"},K))),100),E=new Error;try{const e=new At(j,K,M);w.then((()=>e.cancel(E)));const t=await e.solve();if(e.cancel(),ve.current=()=>{},S){var D,T;const e=function(e){let t=.01,n=new Set(e.flatMap((e=>Object.values(e).map((e=>Math.round(e.plot/t))))));for(;n.size>1500;)t*=2,n=new Set([...n].map((e=>Math.round(e/2))));const i={};for(const a of e)for(const e of Object.values(a)){const n=Math.round(e.plot/t)*t;(!i[n]||i[n].value<e.value)&&(i[n]=e)}return i}(t.map((e=>e.plotData)));let n=Object.values(e);"%"===(null==(D=y.info)?void 0:D.unit)&&(n=n.map((({value:e,plot:t,artifactIds:n})=>({value:100*e,plot:t,artifactIds:n})))),"%"===(null==(T=S.info)?void 0:T.unit)&&(n=n.map((({value:e,plot:t,artifactIds:n})=>({value:e,plot:100*(null!=t?t:0),artifactIds:n})))),s({valueNode:y,plotNode:S,data:n})}const i=function(e,t){return e.flatMap((e=>e)).sort(((e,t)=>t.value-e.value)).slice(0,t)}(t.map((e=>e.builds)),p);0,ie({builds:i.map((e=>e.artifactIds)),buildDate:Date.now()}),setTimeout((()=>{t&&x.current&&(La.play(),ye.current||setTimeout((()=>window.alert(n(Ia||(Ia=za`buildCompleted`)))),1))}),100)}catch(I){I!==E&&(console.log("Failed to load worker"),console.log(I),we(!0)),ve.current(),K.tested=0,K.failed=0,K.skipped=0,K.total=0}finally{clearInterval(O),C(Object.assign({type:"inactive"},K,{finishTime:performance.now()}))}}),[n,i,he,l,ie,M,N,x,s,u]),ke=null!=(t=null==le?void 0:le.name)?t:"Character Name",Se=(0,f.useCallback)((e=>{W({plotBase:e}),s(void 0)}),[W,s]),Xe=(0,f.useMemo)((()=>re&&ae&&{data:re,teamData:ae}),[re,ae]),Pe=(0,$.tZ)(wi.Z,{optimizationTarget:q,setTarget:e=>W({optimizationTarget:e}),disabled:!!B}),Ke=(0,f.useCallback)((e=>(0,$.BX)(g.cC,{t:n,i18nKey:"graphBuildLabel",count:e+1,children:["Graph #",{count:e+1}]})),[n]),Oe=(0,f.useCallback)((e=>`#${e+1}`),[]);return(0,$.BX)(d.Z,{display:"flex",flexDirection:"column",gap:1,children:[z&&(0,$.tZ)(Ze.Z,{severity:"warning",variant:"filled",children:(0,$.BX)(g.cC,{t:n,i18nKey:"noArtis",children:["Oops! It looks like you haven't added any artifacts to GO yet! You should go to the ",(0,$.tZ)(st.Z,{component:b.rU,to:"/artifacts",children:"Artifacts"})," page and add some!"]})}),Xe&&(0,$.BX)(X.R.Provider,{value:Xe,children:[(0,$.BX)(ue.ZP,{container:!0,spacing:1,children:[(0,$.tZ)(ue.ZP,{item:!0,xs:12,sm:6,lg:3,display:"flex",flexDirection:"column",gap:1,children:(0,$.tZ)(d.Z,{children:(0,$.tZ)(Zt.Z,{characterKey:i,onClickTeammate:G})})}),(0,$.BX)(ue.ZP,{item:!0,xs:12,sm:6,lg:4,display:"flex",flexDirection:"column",gap:1,children:[(0,$.BX)(v.Z,{children:[(0,$.tZ)(Z.Z,{children:(0,$.BX)(d.Z,{display:"flex",alignItems:"center",gap:1,children:[(0,$.tZ)(bn,{mainStatAssumptionLevel:H,setmainStatAssumptionLevel:e=>W({mainStatAssumptionLevel:e}),disabled:B}),(0,$.tZ)(pt.Z,{title:(0,$.BX)(d.Z,{children:[(0,$.tZ)(Y.Z,{variant:"h6",children:n(Aa||(Aa=za`mainStat.levelAssTooltip.title`))}),(0,$.tZ)(Y.Z,{children:n(Ma||(Ma=za`mainStat.levelAssTooltip.desc`))})]})})]})}),(0,$.tZ)(Ca,{disabled:B,filteredArtIdMap:xe})]}),(0,$.tZ)(yn,{})]}),(0,$.BX)(ue.ZP,{item:!0,xs:12,sm:6,lg:5,display:"flex",flexDirection:"column",gap:1,children:[(0,$.BX)(v.Z,{children:[(0,$.BX)(Z.Z,{children:[n(Ra||(Ra=za`levelFilter`))," ",(0,$.tZ)(k.Z,{color:"info",children:be})]}),(0,$.tZ)(dt.Z,{levelLow:Q,levelHigh:ee,setLow:e=>W({levelLow:e}),setHigh:e=>W({levelHigh:e}),setBoth:(e,t)=>W({levelLow:e,levelHigh:t}),disabled:B})]}),(0,$.tZ)(pn,{disabled:B}),(0,$.tZ)(na,{disabled:B}),(0,$.tZ)(m.Z,{fullWidth:!0,startIcon:U?(0,$.tZ)(fe.Z,{}):(0,$.tZ)(ge.Z,{}),color:U?"success":"secondary",onClick:()=>W({allowPartial:!U}),disabled:B,children:n(_a||(_a=za`allowPartial`))}),(0,$.tZ)(ha,{disabled:B,numArtsEquippedUsed:me}),(0,$.tZ)(Pa,{disabled:B})]})]}),ce&&Pe,(0,$.BX)(je.Z,{children:[!ce&&Pe,(0,$.BX)(ht.Z,{disabled:B||!i,title:(0,$.BX)(g.cC,{t:n,i18nKey:"build",count:J,children:[{count:J}," Builds"]}),children:[(0,$.tZ)(ct.Z,{children:(0,$.tZ)(Y.Z,{variant:"caption",color:"info.main",children:n("buildDropdownDesc")})}),(0,$.tZ)(F.Z,{}),Mt.s.map((e=>(0,$.tZ)(ct.Z,{onClick:()=>W({maxBuildsToShow:e}),children:(0,$.BX)(g.cC,{t:n,i18nKey:"build",count:e,children:[{count:e}," Builds"]})},e)))]}),(0,$.BX)(ht.Z,{disabled:B||!i,sx:{borderRadius:"4px 0px 0px 4px"},title:(0,$.BX)(g.cC,{t:n,i18nKey:"thread",count:M,children:[{count:M}," Threads"]}),children:[(0,$.tZ)(ct.Z,{children:(0,$.tZ)(Y.Z,{variant:"caption",color:"info.main",children:n("threadDropdownDesc")})}),(0,$.tZ)(F.Z,{}),(0,Bt.w6)(1,gt.g).reverse().map((e=>(0,$.tZ)(ct.Z,{onClick:()=>R(e),children:(0,$.BX)(g.cC,{t:n,i18nKey:"thread",count:e,children:[{count:e}," Threads"]})},e)))]}),(0,$.tZ)(ut.Z,{placement:"top",title:n(Ga||(Ga=za`notifyTooltip`)),children:(0,$.tZ)(m.Z,{sx:{borderRadius:0},color:"warning",onClick:()=>p((e=>!e)),children:h?(0,$.tZ)(lt.Z,{}):(0,$.tZ)(rt.Z,{})})}),(0,$.tZ)(ut.Z,{placement:"top",title:q?"":n("selectTargetFirst"),children:(0,$.tZ)("span",{children:(0,$.tZ)(m.Z,{disabled:!i||!q||!se||se.isEmpty,color:B?"error":"success",onClick:B?()=>ve.current():Be,startIcon:B?(0,$.tZ)(it.Z,{}):(0,$.tZ)(r.Z,{}),sx:{borderRadius:"0px 4px 4px 0px"},children:n(B?"generateButton.cancel":"generateButton.generateBuilds")})})})]}),Ce&&(0,$.tZ)(Oa,{}),!!i&&(0,$.tZ)(kn,{status:y,characterName:ke,maxBuildsToShow:J}),(0,$.tZ)(d.Z,{children:(0,$.tZ)(_i,{disabled:B||!q,plotBase:V,setPlotBase:Se,showTooltip:!q})}),(0,$.tZ)(v.Z,{children:(0,$.BX)(Z.Z,{children:[(0,$.BX)(d.Z,{display:"flex",alignItems:"center",gap:1,mb:1,children:[(0,$.tZ)(Y.Z,{sx:{flexGrow:1},children:te?(0,$.BX)("span",{children:["Showing ",(0,$.tZ)("strong",{children:te.length+(c?c.length:0)})," build generated for ",ke,". ",!!ne&&(0,$.BX)("span",{children:["Build generated on: ",(0,$.tZ)("strong",{children:new Date(ne).toLocaleString()})]})]}):(0,$.tZ)("span",{children:"Select a character to generate builds."})}),(0,$.tZ)(m.Z,{disabled:!te.length,color:"error",onClick:()=>{o(void 0),ie({builds:[],buildDate:0})},children:"Clear Builds"})]}),(0,$.BX)(ue.ZP,{container:!0,display:"flex",spacing:1,children:[(0,$.tZ)(ue.ZP,{item:!0,children:(0,$.tZ)(w.Hn,{size:"small"})}),(0,$.tZ)(ue.ZP,{item:!0,children:(0,$.tZ)(w.oX,{size:"small"})}),(0,$.tZ)(ue.ZP,{item:!0,flexGrow:1}),(0,$.tZ)(ue.ZP,{item:!0,children:(0,$.BX)(mt.Z,{exclusive:!0,value:a,onChange:(e,t)=>_({compareData:t}),size:"small",children:[(0,$.tZ)(ot.Z,{value:!1,disabled:!a,children:"Show new builds"}),(0,$.tZ)(ot.Z,{value:!0,disabled:a,children:"Compare vs. equipped"})]})})]})]})}),(0,$.BX)(ft.Provider,{value:q,children:[c&&(0,$.tZ)(Na,{builds:c,characterKey:i,data:re,compareData:a,disabled:!!B,getLabel:Ke,setBuilds:o}),(0,$.tZ)(Na,{builds:te,characterKey:i,data:re,compareData:a,disabled:!!B,getLabel:Oe})]})]})]})}function Na({builds:e,setBuilds:t,characterKey:n,data:i,compareData:a,disabled:l,getLabel:r}){const s=(0,f.useCallback)((n=>{if(t){const i=[...e];i.splice(n,1),t(i)}}),[e,t]);return(0,f.useMemo)((()=>(0,$.tZ)(f.Suspense,{fallback:(0,$.tZ)(u.Z,{variant:"rectangular",width:"100%",height:600}),children:null==e?void 0:e.map(((e,c)=>n&&i&&(0,$.tZ)(Va,{characterKey:n,build:e,oldData:i,children:(0,$.tZ)(Wa,{index:c,label:r(c),build:e,compareData:a,disabled:l,deleteBuild:t?s:void 0})},c+e.join())))})),[e,n,i,a,l,r,s,t])}function Wa({index:e,label:t,build:n,compareData:i,disabled:a,deleteBuild:l}){const{t:r}=(0,g.$G)("page_character_optimize"),c=(0,x.TH)(),o=(0,x.s0)(),d=(0,f.useCallback)((()=>{const e=c.pathname.split("/");e.pop(),o(`${e.join("/")}/theorycraft`,{state:{build:n}})}),[o,n,c.pathname]);return(0,$.tZ)(li,{label:t,compareBuild:i,disabled:a,extraButtonsLeft:(0,$.BX)($.HY,{children:[(0,$.tZ)(m.Z,{color:"info",size:"small",startIcon:(0,$.tZ)(s.Z,{}),onClick:d,children:r("theorycraftButton")}),l&&(0,$.tZ)(m.Z,{color:"error",size:"small",startIcon:(0,$.tZ)(at.Z,{}),onClick:()=>l(e),children:r("removeBuildButton")})]})})}function Va({children:e,characterKey:t,build:n,oldData:i}){const{database:a}=(0,f.useContext)(O.t),{buildSetting:{mainStatAssumptionLevel:l}}=Ht(t),[r,s]=(0,yt.Z)();(0,f.useEffect)((()=>a.arts.followAny((e=>n.includes(e)&&s()))),[a,n,s]);const c=(0,f.useMemo)((()=>r&&n.map((e=>a.arts.get(e)))),[r,n,a]),o=(0,A.Z)(t,l,c),d=(0,f.useMemo)((()=>o&&{data:o[t].target,teamData:o,oldData:i}),[o,i,t]);return d?(0,$.tZ)(X.R.Provider,{value:d,children:e}):null}const qa=n.p+"15731a768398a57e.png",Fa=n.p+"0fed6a3afab0c533.jpg",Ha=n.p+"61a5640f751600e1.png",Ua=n.p+"ce51de36a8e43a46.jpg",Ya=n.p+"8d39035d9f8614cd.jpg",Ja=n.p+"03950cac18f6da00.jpg",Qa=n.p+"bff1d02a7fef0ed9.jpg",el=n.p+"c23c84fd28ada02c.jpg",tl=n.p+"62bb1380c1e57b84.jpg",nl=n.p+"f86213b0746bd99d.jpg",il=n.p+"afffd1f2dc02443e.jpg",al=n.p+"cdb521f6a838e658.jpg",ll=n.p+"b0362ff4125a96d8.jpg",rl=n.p+"dff0cc8f4764d2f3.png",sl=n.p+"2befecc0c8c94a76.jpg",cl=n.p+"5026e1c4ba0cb717.png",ol=n.p+"b27e5b74d0c7c191.jpg",dl=n.p+"894754f456931c37.jpg",ul=n.p+"830426ef046d7898.png",Zl=n.p+"56e9a3ed2b3be54e.jpg",hl=n.p+"6ed95b88664afc8e.jpg",pl=n.p+"756ca7526e578133.jpg",ml=n.p+"045cbd1ba67661b8.jpg",fl=n.p+"344da155ff4c5613.png",gl=n.p+"7db731763e0df4dc.png",xl=n.p+"7f982d3ef2ddf9d9.png",bl=n.p+"2eb0ba92488c98b7.jpg",yl=n.p+"260308d190782c6f.jpg",vl=n.p+"bfaa8d9850b1f2ec.jpg",Cl=n.p+"7b83f3d4ce23cd76.jpg",wl=n.p+"b27d8af3c869a1a0.jpeg",Bl=n.p+"5837a1c676f3b4d7.jpg",kl=n.p+"02739935c8cfb7bb.jpg",Sl=n.p+"039230426b6241f2.jpeg",Xl=n.p+"5397f2a3bbb43d1b.jpg",Pl=n.p+"9290b22752cf79dc.jpg",jl=n.p+"42e700d9b6d504d4.jpg",Kl=n.p+"17e62e2453f554a2.jpg",Ol=n.p+"8f0d15486e1be7ba.png",El=n.p+"7116f607f2362463.jpg",Dl=n.p+"00dcb0e6012dac62.png",Tl=n.p+"ab2ebc668cf83833.jpg",Il=n.p+"6c8e2c7a860a418d.png",Al=n.p+"088c2740c3fe8bf8.jpg",Ml=n.p+"ce1932b7ece6c6df.png",Rl=n.p+"564bdccbb6ac20f9.jpg",_l=n.p+"bb8785c8713ea800.png",Gl=n.p+"251b9f48307a4f3e.jpg",zl=n.p+"71221c1c02aa0661.jpg",Ll=n.p+"3cfba9c31ee32640.jpg",$l=n.p+"1a9914f68115ede0.jpg",Nl=n.p+"f3a9d7d3de0a0130.jpg",Wl=n.p+"3b87be8b38a43f4e.jpg",Vl=n.p+"1b6e0a76cd1eccb5.jpg",ql=n.p+"c156614a2e2fed0b.jpg",Fl=n.p+"34a60135c4d82e74.png",Hl=n.p+"67678cb6b96761c8.png",Ul=n.p+"6478b1dbbf4f06c4.jpg",Yl=n.p+"67298f967451eb85.jpg",Jl=n.p+"438d1ff1bb2ea9e1.png",Ql=n.p+"ea43f4d145785ce6.jpg",er=n.p+"717bda16cbde243f.png",tr={Albedo:qa,Alhaitham:Fa,Aloy:Ha,Amber:Ua,AratakiItto:Ya,Barbara:Ja,Beidou:Qa,Bennett:el,Candace:tl,Chongyun:nl,Collei:il,Cyno:al,Diluc:ll,Diona:rl,Dori:sl,Eula:cl,Faruzan:ol,Fischl:dl,Ganyu:ul,Gorou:Zl,HuTao:hl,Jean:pl,KaedeharaKazuha:xl,Kaeya:ml,KamisatoAyaka:fl,KamisatoAyato:gl,Keqing:bl,Klee:yl,KujouSara:vl,KukiShinobu:Cl,Layla:wl,Lisa:Bl,Mona:kl,Nahida:Sl,Nilou:Xl,Ningguang:Pl,Noelle:jl,Qiqi:Kl,RaidenShogun:Ol,Razor:El,Rosaria:Dl,SangonomiyaKokomi:Tl,Sayu:Il,Shenhe:Al,ShikanoinHeizou:Ml,Sucrose:Rl,Tartaglia:_l,Thoma:Gl,Tighnari:zl,TravelerF:n.p+"36f4033351c727ee.jpg",TravelerM:n.p+"19ab4b10d5dc0e38.jpg",Venti:Ll,Wanderer:$l,Xiangling:Nl,Xiao:Wl,Xingqiu:Vl,Xinyan:ql,YaeMiko:Fl,Yanfei:Hl,Yaoyao:Ul,Yelan:Yl,Yoimiya:Jl,YunJin:Ql,Zhongli:er};function nr(e,t){var n,i;switch(e){case"TravelerAnemo":case"TravelerDendro":case"TravelerElectro":case"TravelerGeo":return null!=(n=tr[`Traveler${t}`])?n:"";default:return null!=(i=tr[e])?i:""}}var ir=n(16068),ar=n(66147),lr=n(35862),rr=n(71765),sr=n(21626),cr=n(32560),or=n(85469),dr=n(49810),ur=n(86432),Zr=n(23883),hr=n(12121),pr=n(45220),mr=n(3694),fr=n(29687);let gr,xr=e=>e;function br({artId:e,weaponId:t}){const{t:n}=(0,g.$G)("page_character"),[i,a,l]=(0,E.Z)(!1);return(0,$.BX)($.HY,{children:[(0,$.tZ)(ie.Z,{open:i,onClose:l,containerProps:{maxWidth:"xl"},children:(0,$.tZ)(yr,{artId:e,weaponId:t,onHide:l})}),(0,$.tZ)(Zr.Z,{title:(0,$.tZ)(Y.Z,{children:n(gr||(gr=xr`tabEquip.compare`))}),placement:"top",arrow:!0,children:(0,$.tZ)(m.Z,{color:"info",size:"small",onClick:a,children:(0,$.tZ)(fr.Z,{})})})]})}function yr({artId:e,weaponId:t,onHide:n}){const{database:i}=(0,f.useContext)(O.t),{character:{key:a,equippedArtifacts:l}}=(0,f.useContext)(S.K),{buildSetting:{mainStatAssumptionLevel:r}}=Ht(a),{data:s}=(0,f.useContext)(X.R),c=(0,f.useMemo)((()=>{const t=i.arts.get(null!=e?e:""),n=(0,Bt.xh)(l,((e,n)=>n===(null==t?void 0:t.slotKey)?t:i.arts.get(e)));return Object.values(n).filter((e=>e))}),[i,l,e]),o=(0,A.Z)(a,r,c,t?i.weapons.get(t):void 0),d=(0,f.useMemo)((()=>o&&{data:o[a].target,teamData:o,oldData:s}),[a,o,s]);return(0,$.tZ)(f.Suspense,{fallback:(0,$.tZ)(u.Z,{variant:"rectangular",width:"100%",height:600}),children:d&&(0,$.tZ)(X.R.Provider,{value:d,children:(0,$.tZ)(li,{compareBuild:!0,extraButtonsLeft:(0,$.BX)($.HY,{children:[(0,$.tZ)(w.Hn,{size:"small"}),(0,$.tZ)(w.oX,{size:"small"})]}),extraButtonsRight:(0,$.tZ)(m.Z,{size:"small",color:"error",onClick:n,children:(0,$.tZ)(it.Z,{})})})})})}let vr,Cr=e=>e;const wr={xs:6,sm:6,md:9,lg:12,xl:12},Br=(0,f.lazy)((()=>Promise.resolve().then(n.bind(n,19157))));function kr({onChangeId:e,slotKey:t,show:n,onClose:i}){const{t:a}=(0,g.$G)("page_character"),{database:l}=(0,f.useContext)(O.t),r=(0,f.useCallback)((t=>{e(t),i()}),[e,i]),s=(0,f.useCallback)(((e,n)=>Object.assign({},e,n,{slotKeys:[t]})),[t]),[c,o]=(0,f.useReducer)(s,Object.assign({},(0,Fi.Af)(),{slotKeys:[t]})),[h,p]=(0,yt.Z)();(0,f.useEffect)((()=>l.arts.followAny(p)),[l,p]);const m=(0,vt.Z)(),x=(0,f.useMemo)((()=>(0,Fi.EM)()),[]),b=(0,f.useMemo)((()=>{const e=(0,Hi.C)(c,x);return h&&l.arts.values.filter(e).map((e=>e.id)).slice(0,wr[m])}),[h,l,x,c,m]);return(0,$.tZ)(ie.Z,{open:n,onClose:i,containerProps:{maxWidth:"xl"},children:(0,$.BX)(y.Z,{children:[(0,$.BX)(Z.Z,{sx:{py:1,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,$.BX)(Y.Z,{variant:"h6",children:[t?(0,$.tZ)(ne.Z,{src:En.Z.slot[t]}):null," ",a(vr||(vr=Cr`tabEquip.swapArt`))]}),(0,$.tZ)(C.Z,{onClick:i})]}),(0,$.tZ)(F.Z,{}),(0,$.BX)(Z.Z,{children:[(0,$.tZ)(f.Suspense,{fallback:(0,$.tZ)(u.Z,{variant:"rectangular",width:"100%",height:200}),children:(0,$.tZ)(Br,{filterOption:c,filterOptionDispatch:o,filteredIds:b,disableSlotFilter:!0})}),(0,$.tZ)(d.Z,{mt:1,children:(0,$.tZ)(f.Suspense,{fallback:(0,$.tZ)(u.Z,{variant:"rectangular",width:"100%",height:300}),children:(0,$.tZ)(ue.ZP,{container:!0,spacing:1,columns:{xs:2,md:3,lg:4},children:b.map((e=>(0,$.tZ)(ue.ZP,{item:!0,xs:1,children:(0,$.tZ)(Yn.Z,{artifactId:e,extraButtons:(0,$.tZ)(br,{artId:e}),onClick:r})},e)))})})})]})]})})}var Sr=n(92252),Xr=n(13780),Pr=n(89431),jr=n(15878),Kr=n(77712),Or=n(64120);let Er,Dr=e=>e;const Tr=(0,ba.X)([...pe.U1]);function Ir({onChangeId:e,weaponTypeKey:t,show:n,onClose:i}){const{t:a}=(0,g.$G)(["page_character","page_weapon","weaponNames_gen"]),{database:l}=(0,f.useContext)(O.t),[r,s]=(0,f.useState)(!1),c=(0,f.useCallback)((t=>{e(t),i()}),[e,i]),[o,u]=(0,f.useState)(""),h=(0,f.useCallback)((e=>{u(l.weapons.new((0,Or.xg)(e)))}),[l,u]),p=(0,f.useCallback)((()=>u("")),[]),[x,b]=(0,yt.Z)();(0,f.useEffect)((()=>l.weapons.followAny(b)),[b,l]);const[v,w]=(0,f.useState)([5,4,3]),[B,k]=(0,f.useState)(""),S=(0,f.useDeferredValue)(B),X=(0,f.useMemo)((()=>{var e,n;return null!=(e=x&&l.weapons.values.filter((0,Hi.C)({weaponType:t,rarity:v,name:S},(0,Kr.Xg)())).sort((0,Hi.e)(null!=(n=Kr.gd.level)?n:[],!1,(0,Kr.Sn)())).map((e=>e.id)))?e:[]}),[x,l,v,t,S]);return(0,$.tZ)(ie.Z,{open:n,onClose:i,children:(0,$.BX)(y.Z,{children:[(0,$.tZ)(f.Suspense,{fallback:!1,children:(0,$.tZ)(Pr.default,{show:r,onHide:()=>s(!1),onSelect:h,weaponTypeFilter:t})}),(0,$.tZ)(f.Suspense,{fallback:!1,children:(0,$.tZ)(jr.default,{weaponId:o,footer:!0,onClose:p})}),(0,$.tZ)(Z.Z,{sx:{py:1},children:(0,$.BX)(ue.ZP,{container:!0,children:[(0,$.tZ)(ue.ZP,{item:!0,flexGrow:1,children:(0,$.BX)(Y.Z,{variant:"h6",children:[t?(0,$.tZ)(ne.Z,{src:En.Z.weaponTypes[t]}):null," ",a(Er||(Er=Dr`page_character:tabEquip.swapWeapon`))]})}),(0,$.tZ)(ue.ZP,{item:!0,children:(0,$.tZ)(C.Z,{onClick:i})})]})}),(0,$.tZ)(F.Z,{}),(0,$.BX)(Z.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,$.BX)(ue.ZP,{container:!0,spacing:1,children:[(0,$.tZ)(ue.ZP,{item:!0,children:(0,$.tZ)(mt.Z,{sx:{height:"100%"},value:v,size:"small",children:pe.U1.map((e=>(0,$.tZ)(ot.Z,{value:e,onClick:()=>w(Tr(v,e)),children:(0,$.BX)(d.Z,{display:"flex",children:[(0,$.tZ)("strong",{children:e}),(0,$.tZ)(zt.Z,{})]})},e)))})}),(0,$.tZ)(ue.ZP,{item:!0,flexGrow:1,children:(0,$.tZ)(Xr.Z,{autoFocus:!0,size:"small",value:B,onChange:e=>k(e.target.value),label:a("page_weapon:weaponName"),sx:{height:"100%"},InputProps:{sx:{height:"100%"}}})})]}),(0,$.tZ)(m.Z,{fullWidth:!0,onClick:()=>s(!0),color:"info",startIcon:(0,$.tZ)(Sr.Z,{}),children:a("page_weapon:addWeapon")}),(0,$.tZ)(ue.ZP,{container:!0,spacing:1,children:X.map((e=>(0,$.tZ)(ue.ZP,{item:!0,xs:6,sm:6,md:4,lg:3,children:(0,$.tZ)(mr.Z,{weaponId:e,onClick:c,extraButtons:(0,$.tZ)(br,{weaponId:e})})},e)))})]})]})})}let Ar,Mr,Rr,_r,Gr,zr,Lr,$r=e=>e;const Nr=(0,f.lazy)((()=>Promise.resolve().then(n.bind(n,15878))));function Wr(){var e;const{character:{equippedWeapon:t,key:n},characterSheet:i}=(0,f.useContext)(S.K),{teamData:a,data:l}=(0,f.useContext)(X.R),r=null==(e=a[n])?void 0:e.weaponSheet,[s,c]=(0,f.useState)(""),o=(0,f.useCallback)((()=>c(t)),[t]),u=(0,f.useCallback)((()=>c("")),[]);(0,f.useEffect)((()=>{s&&s!==t&&c(t)}),[s,t]);const Z=(0,Kn.Z)(),h=(0,ur.Z)(Z.breakpoints.up("lg")),p=(0,f.useMemo)((()=>r&&r.document.length>0&&(0,$.tZ)(v.Z,{children:(0,$.tZ)(d.Z,{p:1,children:(0,$.tZ)($t.Z,{sections:r.document})})})),[r]),{rvFilter:m}=(0,cr.Z)(n),g=(0,f.useDeferredValue)(m),x=(0,f.useMemo)((()=>new Set(g)),[g]);return(0,$.BX)(d.Z,{children:[(0,$.tZ)(f.Suspense,{fallback:!1,children:(0,$.tZ)(Nr,{weaponId:s,footer:!0,onClose:u,extraButtons:(0,$.tZ)(Fr,{weaponTypeKey:i.weaponTypeKey})})}),(0,$.BX)(ue.ZP,{container:!0,spacing:1,children:[h&&(0,$.BX)(ue.ZP,{item:!0,xs:12,md:12,lg:3,xl:3,sx:{display:"flex",flexDirection:"column",gap:1},children:[p&&p,(0,$.tZ)(Ur,{})]}),(0,$.BX)(ue.ZP,{item:!0,xs:12,md:12,lg:9,xl:9,container:!0,spacing:1,children:[(0,$.tZ)(ue.ZP,{item:!0,xs:12,sm:6,md:4,display:"flex",flexDirection:"column",gap:1,children:(0,$.tZ)(mr.Z,{weaponId:t,onEdit:o,canEquip:!0,extraButtons:(0,$.tZ)(qr,{weaponTypeKey:i.weaponTypeKey})})}),pe.Ex.map((e=>(0,$.tZ)(ue.ZP,{item:!0,xs:12,sm:6,md:4,children:l.get(ye.ri.art[e].id).value?(0,$.tZ)(Yn.Z,{artifactId:l.get(ye.ri.art[e].id).value,effFilter:x,extraButtons:(0,$.tZ)(Hr,{slotKey:e}),editorProps:{},canEquip:!0}):(0,$.tZ)(Vr,{slotKey:e})},e)))]}),!h&&(0,$.BX)(ue.ZP,{item:!0,xs:12,md:12,xl:3,container:!0,spacing:1,children:[p&&(0,$.tZ)(ue.ZP,{item:!0,xs:12,md:6,lg:4,children:p}),(0,$.tZ)(ue.ZP,{item:!0,xs:12,md:6,lg:4,sx:{display:"flex",flexDirection:"column",gap:1},children:(0,$.tZ)(Ur,{})})]})]})]})}function Vr({slotKey:e}){const{character:{key:t}}=(0,f.useContext)(S.K),{database:n}=(0,f.useContext)(O.t),[i,a,l]=(0,E.Z)(),{t:r}=(0,g.$G)("artifact");return(0,$.BX)(v.Z,{sx:{height:"100%",width:"100%",minHeight:300,display:"flex",flexDirection:"column"},children:[(0,$.tZ)(Z.Z,{children:(0,$.BX)(Y.Z,{children:[(0,$.tZ)(Wt.Z,{iconProps:we.m,slotKey:e})," ",r(`slotName.${e}`)]})}),(0,$.tZ)(F.Z,{}),(0,$.BX)(d.Z,{sx:{flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center"},children:[(0,$.tZ)(kr,{slotKey:e,show:i,onClose:l,onChangeId:e=>n.arts.set(e,{location:(0,R.V7)(t)})}),(0,$.tZ)(m.Z,{onClick:a,color:"info",sx:{borderRadius:"1em"},children:(0,$.tZ)(or.Z,{sx:{height:100,width:100}})})]})]})}function qr({weaponTypeKey:e}){const{t}=(0,g.$G)("page_character"),{character:{key:n}}=(0,f.useContext)(S.K),{database:i}=(0,f.useContext)(O.t),[a,l,r]=(0,E.Z)();return(0,$.BX)($.HY,{children:[(0,$.tZ)(Zr.Z,{title:(0,$.tZ)(Y.Z,{children:t(Ar||(Ar=$r`tabEquip.swapWeapon`))}),placement:"top",arrow:!0,children:(0,$.tZ)(m.Z,{color:"info",size:"small",onClick:l,children:(0,$.tZ)(or.Z,{})})}),(0,$.tZ)(Ir,{weaponTypeKey:e,onChangeId:e=>i.weapons.set(e,{location:(0,R.V7)(n)}),show:a,onClose:r})]})}function Fr({weaponTypeKey:e}){const{t}=(0,g.$G)("page_character"),{character:{key:n}}=(0,f.useContext)(S.K),{database:i}=(0,f.useContext)(O.t),[a,l,r]=(0,E.Z)();return(0,$.BX)($.HY,{children:[(0,$.tZ)(m.Z,{color:"info",onClick:l,startIcon:(0,$.tZ)(or.Z,{}),children:t(Mr||(Mr=$r`tabEquip.swapWeapon`))}),(0,$.tZ)(Ir,{weaponTypeKey:e,onChangeId:e=>i.weapons.set(e,{location:(0,R.V7)(n)}),show:a,onClose:r})]})}function Hr({slotKey:e}){const{t}=(0,g.$G)("page_character"),{character:{key:n}}=(0,f.useContext)(S.K),{database:i}=(0,f.useContext)(O.t),[a,l,r]=(0,E.Z)();return(0,$.BX)($.HY,{children:[(0,$.tZ)(Zr.Z,{title:(0,$.tZ)(Y.Z,{children:t(Rr||(Rr=$r`tabEquip.swapArt`))}),placement:"top",arrow:!0,children:(0,$.tZ)(m.Z,{color:"info",size:"small",onClick:l,children:(0,$.tZ)(or.Z,{})})}),(0,$.tZ)(kr,{slotKey:e,show:a,onClose:r,onChangeId:e=>i.arts.set(e,{location:(0,R.V7)(n)})})]})}function Ur(){const{t:e}=(0,g.$G)(["page_character","artifact"]),{database:t}=(0,f.useContext)(O.t),{character:n,character:{key:i,equippedArtifacts:a}}=(0,f.useContext)(S.K),{data:l}=(0,f.useContext)(X.R),r=(0,f.useMemo)((()=>!!Object.values(a).filter((e=>e)).length),[a]),s=(0,f.useCallback)((()=>{n&&window.confirm("Do you want to move all currently equipped artifacts to inventory?")&&Object.values(a).forEach((e=>t.arts.set(e,{location:""})))}),[n,t,a]),c=(0,f.useMemo)((()=>(0,Lt.ND)(l)),[l]),{rvFilter:o}=(0,cr.Z)(i),u=(0,f.useCallback)((e=>t.charMeta.set(i,{rvFilter:e})),[t,i]),[h,p,x]=(0,E.Z)(),b=(0,f.useDeferredValue)(o),{rvField:C,rvmField:w}=(0,f.useMemo)((()=>{const{currentEfficiency:n,currentEfficiency_:i,maxEfficiency:l,maxEfficiency_:r}=Object.values(a).reduce(((e,n)=>{const i=t.arts.get(n);if(i){const{currentEfficiency:t,maxEfficiency:n}=Dn.ZP.getArtifactEfficiency(i,new Set(b)),{currentEfficiency:a,maxEfficiency:l}=Dn.ZP.getArtifactEfficiency(i,new Set(Ea._m));e.currentEfficiency=e.currentEfficiency+t,e.maxEfficiency=e.maxEfficiency+n,e.currentEfficiency_=e.currentEfficiency_+a,e.maxEfficiency_=e.maxEfficiency_+l}return e}),{currentEfficiency:0,currentEfficiency_:0,maxEfficiency:0,maxEfficiency_:0});return{rvField:{text:e(_r||(_r=$r`artifact:editor.curSubEff`)),value:n-i?(0,$.BX)("span",{children:[(0,$.tZ)(pr.Z,{value:n,max:4500,valid:!0})," / ",(0,$.tZ)(pr.Z,{value:i,max:4500,valid:!0})]}):(0,$.tZ)(pr.Z,{value:n,max:4500,valid:!0})},rvmField:{text:e(Gr||(Gr=$r`artifact:editor.maxSubEff`)),canShow:()=>!!(i-r),value:l-r?(0,$.BX)("span",{children:[(0,$.tZ)(pr.Z,{value:l,max:4500,valid:!0})," / ",(0,$.tZ)(pr.Z,{value:r,max:4500,valid:!0})]}):(0,$.tZ)(pr.Z,{value:l,max:4500,valid:!0})}}}),[e,b,a,t]);return(0,$.BX)(v.Z,{children:[r&&(0,$.tZ)(m.Z,{color:"error",onClick:s,fullWidth:!0,sx:{borderBottomRightRadius:0,borderBottomLeftRadius:0},children:e(zr||(zr=$r`tabEquip.unequipArts`))}),(0,$.tZ)(d.Z,{p:1,children:(0,$.BX)(de.Z,{spacing:1,children:[(0,$.BX)(y.Z,{children:[(0,$.tZ)(m.Z,{fullWidth:!0,color:"info",startIcon:(0,$.tZ)(dr.Z,{}),sx:{borderBottomLeftRadius:0,borderBottomRightRadius:0},onClick:p,children:"RV Filter"}),(0,$.tZ)(ie.Z,{open:h,onClose:x,children:(0,$.tZ)(y.Z,{children:(0,$.BX)(Z.Z,{children:[(0,$.tZ)(Y.Z,{textAlign:"center",gutterBottom:!0,variant:"h6",children:e(Lr||(Lr=$r`artifact:efficiencyFilter.title`))}),(0,$.tZ)(hr.Z,{selectedKeys:o,onChange:u})]})})}),(0,$.BX)(Ge.lD,{children:[(0,$.tZ)(Ge.ms,{field:C,component:he.ZP}),(null==w||null==w.canShow?void 0:w.canShow(l))&&(0,$.tZ)(Ge.ms,{field:w,component:he.ZP})]})]}),c&&Object.entries(c).flatMap((([e,t])=>t.map((t=>(0,$.tZ)(y.Z,{sx:{display:"flex",flexDirection:"column",gap:2},children:(0,$.tZ)(Nt,{setKey:e,setNumKey:t},e+t)},e+t)))))]})})]})}function Yr(){const e=(0,f.useRef)(),t=(0,f.useCallback)((()=>{var t;return null==e||null==(t=e.current)||null==t.scrollIntoView?void 0:t.scrollIntoView({behavior:"smooth"})}),[e]);return(0,$.BX)(de.Z,{spacing:1,children:[(0,$.BX)(ue.ZP,{container:!0,spacing:1,sx:{justifyContent:"center"},children:[(0,$.tZ)(ue.ZP,{item:!0,xs:8,sm:5,md:4,lg:2.3,children:(0,$.tZ)(Qr,{})}),(0,$.BX)(ue.ZP,{item:!0,xs:12,sm:7,md:8,lg:9.7,sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,$.tZ)(Jr,{onClick:t}),(0,$.tZ)(v.Z,{sx:{flexGrow:1,p:1},children:(0,$.tZ)($n,{})})]})]}),(0,$.tZ)(d.Z,{ref:e,children:(0,$.tZ)(Wr,{})})]})}function Jr({onClick:e}){const{character:{equippedWeapon:t}}=(0,f.useContext)(S.K),{data:n}=(0,f.useContext)(X.R);return(0,$.BX)(ue.ZP,{container:!0,spacing:1,columns:{xs:2,sm:2,md:3,lg:6,xl:6},children:[(0,$.tZ)(ue.ZP,{item:!0,xs:1,children:(0,$.tZ)(Hn,{weaponId:t,BGComponent:v.Z,onClick:e})}),pe.Ex.map((t=>(0,$.tZ)(ue.ZP,{item:!0,xs:1,children:(0,$.tZ)(Gn,{artifactId:n.get(ye.ri.art[t].id).value,slotKey:t,BGComponent:v.Z,onClick:e})},t)))]})}function Qr(){var e;const{database:t}=(0,f.useContext)(O.t),{characterSheet:n,character:{key:i,team:a}}=(0,f.useContext)(S.K),{gender:l}=(0,I.Z)(),{data:r}=(0,f.useContext)(X.R),s=(0,T.Z)(i),c=(0,x.s0)(),o=r.get(ye.ri.charEle).value,u=n.weaponTypeKey,Z=r.get(ye.ri.lvl).value,h=r.get(ye.ri.asc).value,p=r.get(ye.ri.constellation).value,m={auto:r.get(ye.ri.total.auto).value,skill:r.get(ye.ri.total.skill).value,burst:r.get(ye.ri.total.burst).value},g={auto:r.get(ye.ri.total.autoBoost).value,skill:r.get(ye.ri.total.skillBoost).value,burst:r.get(ye.ri.total.burstBoost).value},{favorite:b}=(0,cr.Z)(i);return(0,$.BX)(v.Z,{sx:{height:"100%"},children:[(0,$.BX)(d.Z,{sx:{position:"relative"},children:[(0,$.BX)(d.Z,{sx:{position:"absolute",width:"100%",height:"100%"},children:[(0,$.tZ)(Y.Z,{variant:"h6",sx:{position:"absolute",width:"100%",left:"50%",bottom:0,transform:"translate(-50%, -50%)",opacity:.75,textAlign:"center"},children:(0,$.tZ)(rr.q,{stars:n.rarity,colored:!0})}),(0,$.tZ)(d.Z,{sx:{position:"absolute",left:"50%",bottom:"7%",transform:"translate(-50%, -50%)",opacity:.85,width:"100%",display:"flex",justifyContent:"center",px:1},children:(0,$.tZ)(xe.Z,{color:o,sx:{height:"auto"},label:(0,$.BX)(Y.Z,{variant:"h6",sx:{display:"flex",gap:1,alignItems:"center"},children:[(0,$.tZ)(Ce.Z,{ele:o}),(0,$.tZ)(d.Z,{sx:{whiteSpace:"normal",textAlign:"center"},children:n.name}),(0,$.tZ)(ne.Z,{src:null==(e=En.Z.weaponTypes)?void 0:e[u]})]})})}),(0,$.tZ)(d.Z,{sx:{position:"absolute",left:0,top:0},children:(0,$.tZ)(Se.Z,{sx:{p:1},color:"error",onClick:()=>t.charMeta.set(i,{favorite:!b}),children:b?(0,$.tZ)(ir.Z,{}):(0,$.tZ)(ar.Z,{})})}),(0,$.tZ)(Y.Z,{sx:{p:1,position:"absolute",right:0,top:0,opacity:.8},children:(0,$.tZ)(k.Z,{children:(0,sr.wQ)(Z,h)})})]}),(0,$.tZ)(d.Z,{src:nr(i,l),component:"img",width:"100%",height:"auto"})]}),(0,$.BX)(d.Z,{children:[(0,$.tZ)(jn.Z,{sx:{p:1},onClick:()=>c("talent"),children:(0,$.tZ)(ue.ZP,{container:!0,spacing:1,mt:-1,children:["auto","skill","burst"].map((e=>{var t;return(0,$.tZ)(ue.ZP,{item:!0,xs:4,children:(0,$.tZ)(lr.Z,{badgeContent:m[e],color:g[e]?"info":"secondary",overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},sx:{width:"100%",height:"100%","& > .MuiBadge-badge":{fontSize:"1.25em",padding:".25em .4em",borderRadius:".5em",lineHeight:1,height:"1.25em"}},children:(0,$.tZ)(d.Z,{component:"img",src:null==(t=n.getTalentOfKey(e))?void 0:t.img,width:"100%",height:"auto"})})},e)}))})}),(0,$.tZ)(Y.Z,{sx:{textAlign:"center",mt:1},variant:"h6",children:n.constellationName}),(0,$.tZ)(ue.ZP,{container:!0,spacing:1,children:(0,Bt.w6)(1,6).map((e=>{var t;return(0,$.tZ)(ue.ZP,{item:!0,xs:4,children:(0,$.tZ)(jn.Z,{onClick:()=>s({constellation:e===p?e-1:e}),children:(0,$.tZ)(d.Z,{component:"img",src:null==(t=n.getTalentOfKey(`constellation${e}`))?void 0:t.img,sx:Object.assign({},p>=e?{}:{filter:"brightness(50%)"}),width:"100%",height:"auto"})})},e)}))}),(0,$.tZ)(jn.Z,{sx:{p:1},onClick:()=>c("teambuffs"),children:(0,$.tZ)(ue.ZP,{container:!0,columns:3,spacing:1,children:(0,Bt.w6)(0,2).map((e=>(0,$.tZ)(ue.ZP,{item:!0,xs:1,height:"100%",children:(0,$.tZ)(sa.Z,{characterKey:a[e],index:e})},e)))})})]})]})}const es={xs:12,sm:6,md:4};function ts(){const{character:e,characterSheet:t}=(0,f.useContext)(S.K),{data:n}=(0,f.useContext)(X.R),i=(0,T.Z)(e.key),a=n.get(ye.ri.asc).value,l=n.get(ye.ri.constellation).value,r=(0,Kn.Z)(),s=(0,ur.Z)(r.breakpoints.up("lg")),c=(0,f.useMemo)((()=>(0,Bt.w6)(1,6).map((e=>(0,$.tZ)(as,{talentKey:`constellation${e}`,subtitle:`Constellation Lv. ${e}`,onClickTitle:()=>i({constellation:e===l?e-1:e})})))),[l,i]);return(0,$.BX)($.HY,{children:[(0,$.tZ)(ns,{}),(0,$.BX)(ue.ZP,{container:!0,spacing:1,children:[s&&(0,$.BX)(ue.ZP,{item:!0,xs:12,md:12,lg:3,sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,$.tZ)(v.Z,{children:(0,$.tZ)(Z.Z,{children:(0,$.BX)(Y.Z,{variant:"h6",sx:{textAlign:"center"},children:["Constellation Lv. ",l]})})}),c.map(((e,t)=>(0,$.tZ)(d.Z,{sx:{opacity:l>=t+1?1:.5},children:e},t)))]}),(0,$.BX)(ue.ZP,{item:!0,xs:12,md:12,lg:9,container:!0,spacing:1,children:[[["auto","Normal/Charged Attack"],["skill","Elemental Skill"],["burst","Elemental Burst"]].map((([e,t])=>(0,$.tZ)(ue.ZP,Object.assign({item:!0},es,{children:(0,$.tZ)(as,{talentKey:e,subtitle:t})}),e))),!!t.getTalentOfKey("sprint")&&(0,$.tZ)(ue.ZP,Object.assign({item:!0},es,{children:(0,$.tZ)(as,{talentKey:"sprint",subtitle:"Alternative Sprint"})})),!!t.getTalentOfKey("passive")&&(0,$.tZ)(ue.ZP,Object.assign({item:!0},es,{children:(0,$.tZ)(as,{talentKey:"passive",subtitle:"Passive"})})),[["passive1","Unlocked at Ascension 1",1],["passive2","Unlocked at Ascension 4",4],["passive3","Unlocked by Default",0]].map((([e,n,i])=>{const l=a>=i;return t.getTalentOfKey(e)?(0,$.tZ)(ue.ZP,Object.assign({item:!0,style:{opacity:l?1:.5}},es,{children:(0,$.tZ)(as,{talentKey:e,subtitle:n})}),e):null}))]}),!s&&(0,$.BX)(ue.ZP,{item:!0,xs:12,md:12,lg:3,container:!0,spacing:1,children:[(0,$.tZ)(ue.ZP,{item:!0,xs:12,children:(0,$.tZ)(v.Z,{children:(0,$.tZ)(Z.Z,{children:(0,$.BX)(Y.Z,{variant:"h6",sx:{textAlign:"center"},children:["Constellation Lv. ",l]})})})}),c.map(((e,t)=>(0,$.tZ)(ue.ZP,Object.assign({item:!0,sx:{opacity:l>=t+1?1:.5}},es,{children:e}),t)))]})]})]})}function ns(){const{data:e}=(0,f.useContext)(X.R),t=e.getDisplay().reaction;return(0,$.tZ)(v.Z,{children:(0,$.tZ)(Z.Z,{children:(0,$.tZ)(ue.ZP,{container:!0,spacing:1,children:Object.entries(t).filter((([e,t])=>!t.isEmpty)).map((([e,t])=>(0,$.tZ)(ue.ZP,{item:!0,children:(0,$.tZ)(y.Z,{children:(0,$.tZ)(Z.Z,{sx:{p:1,"&:last-child":{pb:1}},children:(0,$.tZ)(Ge.JW,{node:t})})})},e)))})})})}const is=[1,1,2,4,6,8,10];function as({talentKey:e,subtitle:t,onClickTitle:n}){const{character:{talent:i},characterSheet:a,characterDispatch:l}=(0,f.useContext)(S.K),{data:r}=(0,f.useContext)(X.R),s=(0,f.useCallback)((e=>(0,$.tZ)(jn.Z,{onClick:n,children:e})),[n]),c=(0,f.useCallback)(((e,t)=>l({talent:Object.assign({},i,{[e]:t})})),[i,l]);let o=null;if(e in i){const t=r.get(ye.ri.total[`${e}Boost`]).value,n=r.get(ye.ri.total[e]).value,a=r.get(ye.ri.asc).value;o=(0,$.tZ)(ht.Z,{fullWidth:!0,title:`Talent Lv. ${n}`,color:t?"info":"primary",sx:{borderRadius:0},children:(0,Bt.w6)(1,is[a]).map((n=>(0,$.BX)(ct.Z,{selected:i[e]===n,disabled:i[e]===n,onClick:()=>c(e,n),children:["Talent Lv. ",n+t]},n)))})}const u=a.getTalentOfKey(e);return(0,$.BX)(v.Z,{sx:{height:"100%"},children:[o,(0,$.BX)(Z.Z,{children:[(0,$.tZ)(Mn.Z,{condition:!!n,wrapper:s,children:(0,$.BX)(ue.ZP,{container:!0,sx:{flexWrap:"nowrap"},children:[(0,$.tZ)(ue.ZP,{item:!0,children:(0,$.tZ)(d.Z,{component:"img",src:null==u?void 0:u.img,sx:{width:60,height:"auto"}})}),(0,$.BX)(ue.ZP,{item:!0,flexGrow:1,sx:{pl:1},children:[(0,$.tZ)(Y.Z,{variant:"h6",children:null==u?void 0:u.name}),(0,$.tZ)(Y.Z,{variant:"subtitle1",children:t})]})]})}),null!=u&&u.sections?(0,$.tZ)($t.Z,{sections:u.sections,hideDesc:!0,hideHeader:t=>{var n;const i=null==(n=t.header)?void 0:n.action;if(i&&"string"!=typeof i){return i.props.children.props.key18.includes(e)}return!1}}):null]})]})}var ls=n(88819),rs=n(86482),ss=n(43210);let cs,os=e=>e;function ds(){return(0,$.tZ)(d.Z,{display:"flex",flexDirection:"column",gap:1,alignItems:"stretch",children:(0,$.BX)(ue.ZP,{container:!0,spacing:1,children:[(0,$.BX)(ue.ZP,{item:!0,xs:12,md:6,lg:3,sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,$.tZ)(us,{}),(0,$.tZ)(Zs,{})]}),(0,Bt.w6)(0,2).map((e=>(0,$.tZ)(ue.ZP,{item:!0,xs:12,md:6,lg:3,children:(0,$.tZ)(hs,{index:e})},e)))]})})}function us(){var e,t,n;const{data:i,oldData:a}=(0,f.useContext)(X.R),l=i.getTeamBuff(),r=[];return Object.entries(null!=(e=l.total)?e:{}).forEach((([e,t])=>!t.isEmpty&&0!==t.value&&r.push([["total",e],t]))),Object.entries(null!=(t=l.premod)?t:{}).forEach((([e,t])=>!t.isEmpty&&0!==t.value&&r.push([["premod",e],t]))),Object.entries(null!=(n=l.enemy)?n:{}).forEach((([e,t])=>!t.isEmpty&&"number"==typeof t.value&&0!==t.value&&r.push([["enemy",e],t]))),r.length?(0,$.BX)(v.Z,{children:[(0,$.tZ)(Z.Z,{children:(0,$.tZ)(Y.Z,{children:"Team Buffs"})}),(0,$.tZ)(F.Z,{}),(0,$.tZ)(Z.Z,{children:(0,$.tZ)(ue.ZP,{container:!0,children:r.map((([e,t])=>{var n;return t&&(0,$.tZ)(ue.ZP,{item:!0,xs:12,children:(0,$.tZ)(Ge.JW,{node:t,oldValue:null==(n=(0,Bt.Hm)(null==a?void 0:a.getTeamBuff(),e))?void 0:n.value})},JSON.stringify(t.info))}))})})]}):null}function Zs(){const{t:e}=(0,g.$G)("page_character"),{data:t}=(0,f.useContext)(X.R),{character:{team:n}}=(0,f.useContext)(S.K),i=n.reduce(((e,t)=>e+(t?1:0)),1);return(0,$.BX)($.HY,{children:[(0,$.tZ)(v.Z,{children:(0,$.tZ)(q.Z,{title:(0,$.BX)("span",{children:[e("tabTeambuff.team_reso")," ",(0,$.tZ)("strong",{children:(0,$.BX)(te.Z,{color:i>=4?"success":"warning",children:["(",i,"/4)"]})})," ",(0,$.tZ)(pt.L,{title:(0,$.tZ)(Y.Z,{children:e(cs||(cs=os`tabTeambuff.resonance_tip`))})})]}),titleTypographyProps:{variant:"subtitle2"}})}),ss.J.map(((e,n)=>(0,$.BX)(v.Z,{sx:{opacity:e.canShow(t)?1:.5},children:[(0,$.tZ)(q.Z,{title:(0,$.BX)("span",{children:[e.name," ",(0,$.tZ)(pt.L,{title:(0,$.tZ)(Y.Z,{children:e.desc})})]}),action:e.icon,titleTypographyProps:{variant:"subtitle2"}}),e.canShow(t)&&(0,$.tZ)(F.Z,{}),e.canShow(t)&&(0,$.tZ)(Z.Z,{children:(0,$.tZ)($t.Z,{sections:e.sections,teamBuffOnly:!0,hideDesc:!0})})]},n)))]})}function hs({index:e}){const{teamData:t}=(0,f.useContext)(X.R),{t:n}=(0,g.$G)("page_character"),{character:i,character:{key:a},characterDispatch:l}=(0,f.useContext)(S.K),r=i.team[e],s=(0,f.useMemo)((()=>[a,...i.team].filter(((t,n)=>n-1!==e))),[i.team,a,e]),c=(0,L.Z)(),o=(0,f.useCallback)((t=>l({type:"team",index:e,charKey:t})),[e,l]),d=t[r],u=(0,f.useMemo)((()=>{var e;return d&&{character:Object.assign({},d.character,{conditional:null!=(e=i.teamConditional[r])?e:{}}),characterSheet:d.characterSheet,characterDispatch:e=>{if(!r)return;if(!("conditional"in e))return;const{conditional:t}=e;t&&l({type:"teamConditional",teamMateKey:r,conditional:t})}}}),[i,r,d,l]),Z=(0,f.useMemo)((()=>d&&{data:d.target,teamData:t}),[d,t]);return(0,$.BX)(v.Z,{sx:{overflow:"visible"},children:[(0,$.tZ)(gs,{characterKey:r,team:s,setChar:o,label:n("teammate",{count:e+1})}),r&&u&&(0,$.tZ)(S.K.Provider,{value:u,children:Z&&(0,$.tZ)(X.R.Provider,{value:Z,children:(0,$.tZ)(Zt.Z,{characterKey:r,onClickHeader:c,artifactChildren:(0,$.tZ)(S.K.Provider,{value:u,children:(0,$.tZ)(X.R.Provider,{value:Z,children:(0,$.tZ)(ps,{})})}),weaponChildren:(0,$.tZ)(S.K.Provider,{value:u,children:(0,$.tZ)(X.R.Provider,{value:Z,children:(0,$.tZ)(ms,{})})}),characterChildren:(0,$.tZ)(S.K.Provider,{value:u,children:(0,$.tZ)(X.R.Provider,{value:Z,children:(0,$.tZ)(fs,{})})}),isTeammateCard:!0})})})]})}function ps(){const{data:e}=(0,f.useContext)(X.R),t=(0,f.useMemo)((()=>Object.entries((0,Lt.ND)(e)).flatMap((([e,t])=>t.flatMap((t=>{var n;return null!=(n=(0,Lt.Sk)(e).setEffectDocument(t))?n:[]}))))),[e]);return t?(0,$.tZ)($t.Z,{sections:t,teamBuffOnly:!0}):null}function ms(){const{character:{key:e}}=(0,f.useContext)(S.K),{teamData:t}=(0,f.useContext)(X.R),n=t[e].weaponSheet;return n.document?(0,$.tZ)($t.Z,{sections:n.document,teamBuffOnly:!0}):null}function fs(){const{character:{key:e}}=(0,f.useContext)(S.K),{teamData:t}=(0,f.useContext)(X.R),n=t[e].characterSheet,i=Object.values(n.talent).flatMap((e=>e.sections));return i?(0,$.tZ)($t.Z,{sections:i,teamBuffOnly:!0}):null}function gs({characterKey:e,team:t,label:n,setChar:i,autoCompleteProps:a={}}){const{t:l}=(0,g.$G)(["charNames_gen","page_character","sheet_gen"]),{database:r}=(0,f.useContext)(O.t),{gender:s}=(0,I.Z)(),c=(0,f.useCallback)((e=>{var t;return e.startsWith("Traveler")?`${l(`charNames_gen:${(0,R.LP)(e,s)}`)} (${l(`sheet_gen:element.${null==(t=(0,K.m)(e,s))?void 0:t.elementKey}`)})`:l(`charNames_gen:${e}`)}),[l,s]),o=(0,f.useCallback)((e=>e?(0,$.tZ)(z.Z,{src:(0,G.Li)(e,"iconSide",s),sx:{pr:1}}):(0,$.tZ)(ls.Z,{})),[s]),d=(0,f.useCallback)((e=>r.charMeta.get(e).favorite),[r]),Z=(0,f.useCallback)((({key:n})=>t.filter((t=>t&&t!==e)).includes(n)||n.startsWith("Traveler")&&t.some(((e,t)=>e.startsWith("Traveler")))),[t,e]),h=(0,f.useMemo)((()=>r.chars.keys.map((e=>({key:e,label:c(e),favorite:d(e)}))).sort(((e,t)=>e.favorite&&!t.favorite?-1:!e.favorite&&t.favorite?1:e.label.localeCompare(t.label)))),[c,d,r]);return(0,$.tZ)(f.Suspense,{fallback:(0,$.tZ)(u.Z,{variant:"text",width:100}),children:(0,$.tZ)(rs._,Object.assign({size:"small",label:n,options:h,valueKey:e,onChange:e=>i(null!=e?e:""),getOptionDisabled:Z,toImg:o},a))})}var xs=n(71076),bs=n(97183),ys=n(31114),vs=n(17206),Cs=n(14520),ws=n(69278);let Bs,ks=e=>e;function Ss(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}const Xs=f.lazy((()=>Promise.resolve().then(n.bind(n,89431))));function Ps(){var e,t;const{database:n}=(0,f.useContext)(O.t),{data:i}=(0,f.useContext)(X.R),{character:a,character:{key:l,compareData:r},characterSheet:s,characterDispatch:c}=(0,f.useContext)(S.K),o=function(e,t){const{database:n}=(0,f.useContext)(O.t),[i,a]=(0,f.useState)((()=>n.charTCs.getWithInit(e,t)));return(0,f.useEffect)((()=>a(n.charTCs.getWithInit(e,t))),[n,e,t]),(0,f.useEffect)((()=>e?n.charTCs.follow(e,((e,t,n)=>"update"===t&&a(n))):void 0),[e,a,n]),i}(l,(0,Or.mT)(s.weaponTypeKey)),Z=(0,f.useCallback)((e=>n.charTCs.set(l,e)),[l,n]),h=(0,f.useCallback)((()=>{Z((0,ws.O)((0,Or.mT)(s.weaponTypeKey)))}),[Z,s]),p=(0,f.useCallback)((e=>{Z(Object.assign({},o,{weapon:Object.assign({},o.weapon,e)}))}),[Z,o]),g=(0,f.useCallback)(((e,t)=>{const n=(0,ws.O)(e.key);n.artifact.substats.type=o.artifact.substats.type,n.weapon.level=e.level,n.weapon.ascension=e.ascension,n.weapon.refinement=e.refinement;const i={};t.forEach((e=>{var t;if(!e)return;const{slotKey:a,setKey:l,substats:r,mainStatKey:s,level:c,rarity:o}=e;n.artifact.slots[a].level=c,n.artifact.slots[a].statKey=s,n.artifact.slots[a].rarity=o,i[l]=(null!=(t=i[l])?t:0)+1,r.forEach((e=>{var t;e.key&&(n.artifact.substats.stats[e.key]=(null!=(t=n.artifact.substats.stats[e.key])?t:0)+e.accurateValue)}))})),n.artifact.sets=Object.fromEntries(Object.entries(i).map((([e,t])=>[e,3===t?2:5===t?4:1!==t||e.startsWith("PrayersFor")?t:0])).filter((([e,t])=>t))),Z(n)}),[o,Z]),b=(0,x.TH)(),{build:y}=null!=(e=b.state)?e:{build:void 0};(0,f.useEffect)((()=>{if(!y)return;const e=n.weapons.get(a.equippedWeapon);g(e,y.map((e=>n.arts.get(e))))}),[y,n]);const C=(0,f.useCallback)((()=>{const e=n.weapons.get(a.equippedWeapon);g(e,Object.values(a.equippedArtifacts).map((e=>n.arts.get(e))).filter((e=>e)))}),[n,a.equippedArtifacts,a.equippedWeapon,g]),w=(0,f.useMemo)((()=>Object.assign({},o.weapon,{location:"",lock:!1,id:""})),[o]),B=(0,f.useCallback)((e=>{const t=(0,Bt.I8)(o);t.artifact=e,Z(t)}),[o,Z]),k=(0,f.useCallback)((e=>{const t=(0,Bt.I8)(o);t.artifact.substats.type=e,Z(t)}),[o,Z]),P=(0,f.useCallback)((e=>{const t=(0,Bt.I8)(o);t.artifact.substats.stats=e,Z(t)}),[o,Z]),j=(0,f.useDeferredValue)(o),K=(0,f.useMemo)((()=>{const e=Object.assign({},j.artifact.substats.stats);return Object.values(j.artifact.slots).forEach((({statKey:t,rarity:n,level:i})=>{var a;return e[t]=(null!=(a=e[t])?a:0)+Dn.ZP.mainStatValue(t,n,i)})),{art:(0,Bt.xh)(e,((e,t)=>t.endsWith("_")?(0,wt.aQ)(e/100):(0,wt.a9)(e))),artSet:(0,Bt.xh)(j.artifact.sets,(e=>(0,wt.a9)(e)))}}),[j]),E=(0,f.useMemo)((()=>({id:"",location:"",key:o.weapon.key,level:o.weapon.level,ascension:o.weapon.ascension,refinement:o.weapon.refinement,lock:!1})),[o]),D=(0,A.Z)(l,0,K,E),{target:T}=null!=(t=null==D?void 0:D[l])?t:{},I=(0,f.useMemo)((()=>{if(D&&T)return{data:T,teamData:D}}),[T,D]),M=(0,f.useMemo)((()=>{if(I)return Object.assign({},I,{oldData:r?i:void 0})}),[I,r,i]);return(0,$.BX)(de.Z,{spacing:1,children:[(0,$.tZ)(v.Z,{children:(0,$.BX)(d.Z,{sx:{display:"flex",gap:1,p:1},children:[(0,$.BX)(d.Z,{sx:{flexGrow:1,display:"flex",gap:1},children:[(0,$.tZ)(m.Z,{color:"info",onClick:C,startIcon:(0,$.tZ)(xs.Z,{}),children:"Copy from equipped"}),(0,$.tZ)(m.Z,{color:"error",onClick:h,startIcon:(0,$.tZ)(bs.Z,{}),children:"Reset"})]}),(0,$.BX)(mt.Z,{exclusive:!0,value:r,onChange:(e,t)=>c({compareData:t}),size:"small",children:[(0,$.tZ)(ot.Z,{value:!1,disabled:!r,children:"Show TC stats"}),(0,$.tZ)(ot.Z,{value:!0,disabled:r,children:"Compare vs. equipped"})]})]})}),I?(0,$.tZ)(X.R.Provider,{value:I,children:(0,$.BX)(ue.ZP,{container:!0,spacing:1,sx:{justifyContent:"center"},children:[(0,$.BX)(ue.ZP,{item:!0,sx:{flexGrow:-1},children:[(0,$.tZ)(js,{weapon:w,setWeapon:p,weaponTypeKey:s.weaponTypeKey}),(0,$.tZ)(Ks,{artifactData:o.artifact,setArtifactData:B})]}),(0,$.tZ)(ue.ZP,{item:!0,sx:{flexGrow:1},children:(0,$.tZ)(Ts,{substats:o.artifact.substats.stats,setSubstats:P,substatsType:o.artifact.substats.type,setSubstatsType:k,mainStatKeys:Object.values(o.artifact.slots).map((e=>e.statKey))})})]})}):(0,$.tZ)(u.Z,{variant:"rectangular",width:"100%",height:500}),(0,$.tZ)(v.Z,{sx:{flexGrow:1,p:1},children:M?(0,$.tZ)(X.R.Provider,{value:M,children:(0,$.tZ)($n,{})}):(0,$.tZ)(u.Z,{variant:"rectangular",width:"100%",height:500})})]})}function js({weapon:e,setWeapon:t,weaponTypeKey:n}){const{key:i,level:a=0,refinement:l=1,ascension:r=0}=e,s=(0,Wn.ub)(i),[c,o,u]=(0,E.Z)(),{data:Z}=(0,f.useContext)(X.R),h=(0,f.useMemo)((()=>e&&(0,xt.mP)([s.data,(0,xt.v0)(e)])),[s,e]);return(0,$.BX)(v.Z,{sx:{p:1,mb:1},children:[(0,$.tZ)(Xs,{ascension:r,show:c,onHide:u,onSelect:e=>t({key:e}),weaponTypeFilter:n}),(0,$.BX)(d.Z,{display:"flex",flexDirection:"column",gap:1,children:[(0,$.BX)(d.Z,{display:"flex",gap:1,children:[(0,$.tZ)(d.Z,{className:`grad-${s.rarity}star`,component:"img",src:(0,G.Aq)(e.key,r>=2),sx:{flexshrink:1,flexBasis:0,maxWidth:"30%",borderRadius:1}}),(0,$.BX)(de.Z,{spacing:1,flexGrow:1,children:[(0,$.tZ)(m.Z,{fullWidth:!0,color:"info",sx:{flexGrow:1},onClick:o,children:(0,$.tZ)(d.Z,{sx:{maxWidth:"10em"},children:null==s?void 0:s.name})}),s.hasRefinement&&(0,$.tZ)(Cs.Z,{refinement:l,setRefinement:e=>t({refinement:e})})]})]}),(0,$.tZ)(B.Z,{level:a,ascension:r,setBoth:t,useLow:!s.hasRefinement}),(0,$.BX)(y.Z,{children:[(0,$.tZ)(q.Z,{title:"Main Stats",titleTypographyProps:{variant:"subtitle2"}}),(0,$.tZ)(F.Z,{}),h&&(0,$.tZ)(Ge.lD,{children:[ye.ri.weapon.main,ye.ri.weapon.sub,ye.ri.weapon.sub2].map(((e,t)=>{const n=h.get(e);return n.isEmpty||!n.value?null:(0,$.tZ)(Ge.JW,{node:n,component:he.ZP},JSON.stringify(n.info))}))})]}),Z&&(null==s?void 0:s.document)&&(0,$.tZ)($t.Z,{sections:s.document})]})]})}function Ks({artifactData:e,setArtifactData:t}){const n=(0,f.useCallback)((n=>i=>{const a=(0,Bt.I8)(e);a.slots[n]=i,t(a)}),[e,t]),i=(0,f.useCallback)((n=>{const i=(0,Bt.I8)(e);i.sets=n,t(i)}),[e,t]);return(0,$.BX)(de.Z,{spacing:1,children:[(0,$.tZ)(v.Z,{sx:{p:1},children:(0,$.tZ)(de.Z,{spacing:1,children:pe.Ex.map((t=>(0,$.tZ)(Os,{slotKey:t,slot:e.slots[t],setSlot:n(t)},t)))})}),(0,$.tZ)(f.Suspense,{fallback:(0,$.tZ)(u.Z,{variant:"rectangular",width:"100%",height:200}),children:(0,$.tZ)(Es,{artSet:e.sets,setArtSet:i})})]})}function Os({slotKey:e,slot:t,setSlot:n}){var i;const{level:a,statKey:l,rarity:r}=t,s=Dn.ZP.slotMainStats(e),c=(0,f.useCallback)((e=>{n(Object.assign({},t,e))}),[t,n]),o=(0,f.useCallback)((e=>{var t;const n=null!=(t=Dn.P4[e])?t:0;c(a>n?{rarity:e,level:n}:{rarity:e})}),[a,c]);return(0,$.BX)(d.Z,{display:"flex",gap:1,justifyContent:"space-between",alignItems:"center",children:[(0,$.tZ)(Wt.Z,{slotKey:e}),(0,$.tZ)(y.Z,{sx:{height:"100%",minWidth:"5em",flexGrow:1,display:"flex"},children:1===s.length?(0,$.BX)(d.Z,{p:1,justifyContent:"center",alignItems:"center",width:"100%",display:"flex",gap:1,children:[(0,$.tZ)(Ce.C,{statKey:s[0],iconProps:we.m})," ",ve.ZP.getStr(s[0])]}):(0,$.tZ)(ht.Z,{sx:{px:0},fullWidth:!0,title:(0,$.tZ)(Rn.x,{statKey:l}),color:null!=(i=ve.ZP.getVariant(l))?i:"success",children:s.map((e=>(0,$.tZ)(ct.Z,{disabled:l===e,onClick:()=>c({statKey:e}),children:(0,$.tZ)(Rn._,{statKey:e})},e)))})}),(0,$.tZ)(ht.Z,{sx:{px:0},title:(0,$.BX)(d.Z,{sx:{display:"flex",alignItems:"center"},children:[r," ",(0,$.tZ)(zt.Z,{fontSize:"inherit"})]}),children:[5,4,3].map((e=>(0,$.tZ)(ct.Z,{disabled:r===e,onClick:()=>o(e),children:(0,$.BX)(d.Z,{sx:{display:"flex",alignItems:"center"},children:[e," ",(0,$.tZ)(zt.Z,{fontSize:"inherit"})]})},e)))}),(0,$.tZ)(Ke.ZP,{startAdornment:"+",value:a,color:Dn.ZP.levelVariant(a),onChange:e=>void 0!==e&&c({level:e}),sx:{borderRadius:1,pl:1,my:0,height:"100%"},inputProps:{sx:{pl:.5,width:"2em"},max:20,min:0}}),(0,$.tZ)(y.Z,{sx:{height:"100%",minWidth:"4em"},children:(0,$.tZ)(d.Z,{p:1,textAlign:"center",children:`${(0,ve.qs)(Dn.ZP.mainStatValue(l,r,a),ve.ZP.unit(l))}${ve.ZP.unit(l)}`})})]})}function Es({artSet:e,setArtSet:t}){const n=(0,f.useCallback)((n=>{n&&t(Object.assign({},e,{[n]:parseInt(Object.keys((0,Lt.Sk)(n).setEffects)[0])}))}),[e,t]),i=(0,f.useCallback)((n=>i=>t(Object.assign({},e,{[n]:i}))),[e,t]),a=(0,f.useCallback)((n=>()=>{const i=(0,Be.Z)(e,[n].map(Ss));t(Object.assign({},i))}),[e,t]),l=5-Object.values(e).reduce(((e,t)=>e+t),0);return(0,$.BX)(de.Z,{spacing:1,sx:{flexGrow:1},children:[Object.entries(e).map((([e,t])=>(0,$.tZ)(Ds,{setKey:e,value:t,setValue:i(e),deleteValue:a(e),remaining:l},e))),(0,$.tZ)(v.Z,{sx:{flexGrow:1,overflow:"visible"},children:(0,$.tZ)(vs.Z,{artSetKey:"",setArtSetKey:n,label:"New Artifact Set",getOptionDisabled:({key:t})=>Object.keys(e).includes(t)||!t||Object.keys((0,Lt.Sk)(t).setEffects).every((e=>parseInt(e)>l))})})]})}function Ds({setKey:e,value:t,setValue:n,deleteValue:i,remaining:a}){const l=(0,Lt.Sk)(e),r=(0,f.useMemo)((()=>t<4?[]:Object.keys(l.setEffects).filter((e=>{var t;return null==(t=l.setEffects[e])?void 0:t.document.some((e=>"states"in e))}))),[l,t]);return(0,$.BX)(v.Z,{children:[(0,$.BX)(d.Z,{display:"flex",children:[(0,$.tZ)(Jn.Z,{artifactSheet:l,numInSet:t,children:(0,$.BX)(d.Z,{flexGrow:1,p:1,display:"flex",gap:1,alignItems:"center",children:[(0,$.tZ)(ne.Z,{size:2,src:(0,qt.jU)(e)}),(0,$.tZ)(d.Z,{children:l.setName}),(0,$.tZ)(ys.Z,{})]})}),(0,$.BX)(je.Z,{children:[(0,$.tZ)(ht.Z,{size:"small",title:(0,$.BX)(d.Z,{whiteSpace:"nowrap",children:[t,"-set"]}),children:Object.keys(l.setEffects).map((e=>parseInt(e))).map((e=>(0,$.BX)(ct.Z,{disabled:t===e||e>a+t,onClick:()=>n(e),children:[e,"-set"]},e)))}),(0,$.tZ)(m.Z,{color:"error",size:"small",onClick:i,children:(0,$.tZ)(at.Z,{})})]})]}),!!r.length&&(0,$.tZ)(de.Z,{spacing:1,sx:{p:1},children:r.map((t=>(0,$.tZ)(Nt,{setKey:e,setNumKey:parseInt(t),hideHeader:!0,conditionalsOnly:!0},t)))})]})}function Ts({substats:e,setSubstats:t,substatsType:n,setSubstatsType:i,mainStatKeys:a}){const l=(0,f.useCallback)((n=>i=>t(Object.assign({},e,{[n]:i}))),[e,t]),{t:r}=(0,g.$G)("page_character"),s=100*Object.entries(e).reduce(((e,[t,n])=>e+n/Dn.ZP.substatValue(t)),0),c=Object.entries(e).reduce(((e,[t,i])=>e+i/Dn.ZP.substatValue(t,void 0,n)),0);return(0,$.BX)(v.Z,{sx:{p:1,height:"100%"},children:[(0,$.BX)(d.Z,{sx:{mb:1,display:"flex",gap:1},children:[(0,$.tZ)(ht.Z,{fullWidth:!0,title:r(`tabTheorycraft.substatType.${n}`),children:R.Q7.map((e=>(0,$.tZ)(ct.Z,{disabled:n===e,onClick:()=>i(e),children:r(`tabTheorycraft.substatType.${e}`)},e)))}),(0,$.tZ)(ut.Z,{title:(0,$.tZ)(Y.Z,{children:r(Bs||(Bs=ks`tabTheorycraft.maxTotalRolls`))}),placement:"top",children:(0,$.BX)(y.Z,{sx:{textAlign:"center",py:.5,px:1,minWidth:"15em",whiteSpace:"nowrap",display:"flex",gap:2,justifyContent:"flex-end",alignItems:"center"},children:[(0,$.BX)(te.Z,{color:c>45?"warning":void 0,children:["Rolls: ",(0,$.tZ)("strong",{children:c.toFixed(0)})]}),(0,$.BX)(te.Z,{color:c>45?"warning":void 0,children:["RV: ",(0,$.BX)("strong",{children:[s.toFixed(1),"%"]})]})]})})]}),(0,$.tZ)(de.Z,{spacing:1,children:Object.entries(e).map((([e,t])=>(0,$.tZ)(Is,{statKey:e,value:t,setValue:l(e),substatsType:n,mainStatKeys:a},e)))})]})}function Is({statKey:e,value:t,setValue:n,substatsType:i,mainStatKeys:a}){const{t:l}=(0,g.$G)("page_character"),r=Dn.ZP.substatValue(e,5,i),[s,c]=(0,f.useState)((()=>t/r));(0,f.useEffect)((()=>c(t/r)),[t,r]);const o=ve.ZP.unit(e),u=s*r,Z=s*r/Dn.ZP.substatValue(e)*100,h=a.reduce(((t,n)=>t+(n===e?1:0)),0),p=6*(5-h),m=s-1e-4>p,x=(0,f.useCallback)((e=>n(e*r)),[n,r]);return(0,$.BX)(de.Z,{spacing:.5,children:[(0,$.BX)(d.Z,{display:"flex",gap:1,justifyContent:"space-between",alignItems:"center",children:[(0,$.BX)(y.Z,{sx:{p:.5,minWidth:"11em",flexGrow:1,display:"flex",gap:1,alignItems:"center",justifyContent:"center"},children:[(0,$.tZ)(Ce.C,{statKey:e,iconProps:{fontSize:"inherit"}}),ve.ZP.getStr(e),ve.ZP.unit(e)]}),(0,$.tZ)(ut.Z,{title:(0,$.tZ)(Y.Z,{children:l(h?"tabTheorycraft.maxRollsMain":"tabTheorycraft.maxRolls",{value:p})}),placement:"top",children:(0,$.tZ)(y.Z,{sx:{textAlign:"center",p:.5,minWidth:"8em"},children:(0,$.BX)(te.Z,{color:m?"warning":void 0,children:["RV: ",(0,$.BX)("strong",{children:[Z.toFixed(1),"%"]})]})})})]}),(0,$.BX)(d.Z,{display:"flex",gap:1,justifyContent:"space-between",alignItems:"center",children:[(0,$.tZ)(Ke.ZP,{color:u?"success":"primary",float:"%"===ve.ZP.unit(e),endAdornment:ve.ZP.unit(e)||(0,$.tZ)(d.Z,{width:"1em",component:"span"}),value:parseFloat(u.toFixed(2)),onChange:e=>void 0!==e&&n(e),sx:{borderRadius:1,px:1,height:"100%",width:"6em"},inputProps:{sx:{textAlign:"right"},min:0}}),(0,$.tZ)(y.Z,{sx:{px:2,flexGrow:1,display:"flex",gap:1,alignItems:"center",justifyContent:"center",overflow:"visible"},children:(0,$.tZ)(di.ZP,{size:"small",value:s,max:p,min:0,step:1,marks:!0,valueLabelDisplay:"auto",onChange:(e,t)=>c(t),onChangeCommitted:(e,t)=>x(t)})}),(0,$.tZ)(Ke.ZP,{color:t?m?"warning":"success":"primary",float:!0,startAdornment:(0,$.BX)(d.Z,{sx:{whiteSpace:"nowrap",width:"7em",display:"flex",justifyContent:"space-between"},children:[(0,$.BX)("span",{children:[(0,ve.qs)(r,o),o]}),(0,$.tZ)("span",{children:"x"})]}),value:parseFloat(s.toFixed(2)),onChange:e=>void 0!==e&&n(e*r),sx:{borderRadius:1,px:1,my:0,height:"100%",width:"7em"},inputProps:{sx:{textAlign:"right",pr:.5},min:0,step:1}})]})]})}var As=n(62173);function Ms(){const{character:e}=(0,f.useContext)(S.K),{key:t}=e,n=(0,L.Z)();if(!t.startsWith("Traveler"))return null;const i=pe.UB.find((e=>t.toLowerCase().includes(e)));return i?(0,$.tZ)(ht.Z,{color:i,title:(0,$.tZ)("strong",{children:(0,As.el)(`element.${i}`)}),children:R.DZ.map((e=>(0,$.tZ)(ct.Z,{selected:i===e,disabled:i===e,onClick:()=>n((0,R.rq)(t,e)),children:(0,$.tZ)("strong",{children:(0,$.tZ)(te.Z,{color:e,children:(0,As.el)(`element.${e}`)})})},e)))}):null}var Rs=n(2247),_s=n(96608);function Gs(){const{t:e}=(0,g.$G)("ui"),{database:t}=(0,f.useContext)(O.t),{character:n}=(0,f.useContext)(S.K),{key:i}=n,{gender:a}=(0,I.Z)(),l=(0,f.useCallback)((()=>t.dbMeta.set({gender:"F"===a?"M":"F"})),[a,t]);return i.startsWith("Traveler")?(0,$.BX)(m.Z,{onClick:l,startIcon:"F"===a?(0,$.tZ)(Rs.Z,{}):(0,$.tZ)(_s.Z,{}),children:[(0,$.tZ)("strong",{children:e(`gender.${a}`)}),"  "]}):null}let zs,Ls=e=>e;function $s(){const e=(0,x.s0)(),{database:t}=(0,f.useContext)(O.t),n=(0,f.useCallback)((()=>e("/characters")),[e]),{characterKey:i}=(0,x.UO)();return!t.chars.keys.includes(i)?(0,$.tZ)(x.Fg,{to:"/characters"}):(0,$.tZ)(d.Z,{my:1,display:"flex",flexDirection:"column",gap:1,children:(0,$.tZ)(f.Suspense,{fallback:(0,$.tZ)(u.Z,{variant:"rectangular",width:"100%",height:1e3}),children:i&&(0,$.tZ)(Ns,{characterKey:i,onClose:n})})})}function Ns({characterKey:e,onClose:t}){var n,i,a;const l=(0,D.Z)(e),{gender:r}=(0,I.Z)(),s=(0,K.m)(e,r),c=(0,A.Z)(e),{target:o}=null!=(n=null==c?void 0:c[e])?n:{},{params:{tab:h="overview"}}=null!=(i=(0,x.bS)({path:"/characters/:charKey/:tab",end:!1}))?i:{params:{tab:"overview"}},{t:p}=(0,g.$G)(["charNames_gen","page_character"]);(0,M.Z)((0,f.useMemo)((()=>`${p(`charNames_gen:${(0,R.LP)(e,r)}`)} - ${p(`page_character:tabs.${h}`)}`),[p,e,r,h]));const m=(0,T.Z)(null!=(a=null==l?void 0:l.key)?a:""),b=(0,f.useMemo)((()=>{if(c&&o)return{data:o,teamData:c,oldData:void 0}}),[o,c]),k=(0,f.useMemo)((()=>{if(l&&s)return{character:l,characterSheet:s,characterDispatch:m}}),[l,s,m]),[O,E]=(0,f.useState)(void 0),[G,z]=(0,f.useState)(),L=(0,f.useMemo)((()=>({chartData:O,setChartData:E,graphBuilds:G,setGraphBuilds:z})),[O,G]);return(0,f.useEffect)((()=>{E(void 0),z(void 0)}),[e]),(0,$.tZ)(y.Z,{children:b&&k&&L?(0,$.tZ)(S.K.Provider,{value:k,children:(0,$.tZ)(X.R.Provider,{value:b,children:(0,$.tZ)(j.Provider,{value:L,children:(0,$.tZ)(P.B,{children:(0,$.BX)(Z.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,$.BX)(d.Z,{display:"flex",children:[(0,$.BX)(d.Z,{display:"flex",gap:1,flexWrap:"wrap",flexGrow:1,children:[(0,$.tZ)(W,{}),(0,$.tZ)(Ms,{}),(0,$.tZ)(Gs,{}),(0,$.tZ)(qs,{}),(0,$.tZ)(_.J,{}),(0,$.tZ)(Fs,{})]}),!!t&&(0,$.tZ)(C.Z,{onClick:t})]}),(0,$.BX)(d.Z,{display:"flex",gap:1,flexWrap:"wrap",children:[l&&(0,$.tZ)(B.Z,{level:l.level,ascension:l.ascension,setBoth:m}),(0,$.tZ)(w.Hn,{size:"small"}),(0,$.tZ)(w.pg,{}),(0,$.tZ)(w.oX,{size:"small"})]}),(0,$.tZ)(v.Z,{children:(0,$.tZ)(Vs,{tab:h})}),(0,$.tZ)(Ws,{}),(0,$.tZ)(v.Z,{children:(0,$.tZ)(Vs,{tab:h})})]})})})})}):(0,$.tZ)(u.Z,{variant:"rectangular",width:"100%",height:1e3})})}function Ws(){return(0,$.tZ)(f.Suspense,{fallback:(0,$.tZ)(u.Z,{variant:"rectangular",width:"100%",height:500}),children:(0,$.BX)(x.Z5,{children:[(0,$.tZ)(x.AW,{index:!0,element:(0,$.tZ)(Yr,{})}),(0,$.tZ)(x.AW,{path:"/talent",element:(0,$.tZ)(ts,{})}),(0,$.tZ)(x.AW,{path:"/teambuffs",element:(0,$.tZ)(ds,{})}),(0,$.tZ)(x.AW,{path:"/optimize",element:(0,$.tZ)($a,{})}),(0,$.tZ)(x.AW,{path:"/theorycraft",element:(0,$.tZ)(Ps,{})})]})})}function Vs({tab:e}){const{t}=(0,g.$G)("page_character");return(0,$.BX)(h.Z,{value:e,variant:"scrollable",allowScrollButtonsMobile:!0,sx:{"& .MuiTab-root:hover":{transition:"background-color 0.25s ease",backgroundColor:"rgba(255,255,255,0.1)"}},children:[(0,$.tZ)(p.Z,{sx:{minWidth:"20%"},value:"overview",label:t("tabs.overview"),icon:(0,$.tZ)(i.Z,{}),component:b.rU,to:""}),(0,$.tZ)(p.Z,{sx:{minWidth:"20%"},value:"talent",label:t("tabs.talent"),icon:(0,$.tZ)(a.Z,{}),component:b.rU,to:"talent"}),(0,$.tZ)(p.Z,{sx:{minWidth:"20%"},value:"teambuffs",label:t("tabs.teambuffs"),icon:(0,$.tZ)(l.Z,{}),component:b.rU,to:"teambuffs"}),(0,$.tZ)(p.Z,{sx:{minWidth:"20%"},value:"optimize",label:t("tabs.optimize"),icon:(0,$.tZ)(r.Z,{}),component:b.rU,to:"optimize"}),(0,$.tZ)(p.Z,{sx:{minWidth:"20%"},value:"theorycraft",label:t("tabs.theorycraft"),icon:(0,$.tZ)(s.Z,{}),component:b.rU,to:"theorycraft"})]})}function qs(){const{t:e}=(0,g.$G)("page_character"),[t,n,i]=(0,E.Z)(),{character:{bonusStats:a}}=(0,f.useContext)(S.K),l=Object.keys(a).length;return(0,$.BX)($.HY,{children:[(0,$.BX)(m.Z,{color:"info",startIcon:(0,$.tZ)(c.Z,{}),onClick:n,children:[e(zs||(zs=Ls`addStats.title`)),!!l&&(0,$.tZ)(k.Z,{sx:{ml:1},color:"success",children:l})]}),(0,$.tZ)(We,{open:t,onClose:i})]})}function Fs(){const{onModalOpen:e}=(0,f.useContext)(P.M);return(0,$.BX)($.HY,{children:[(0,$.BX)(m.Z,{color:"info",startIcon:(0,$.tZ)(o.Z,{}),onClick:e,children:["Formulas ","&"," Calcs"]}),(0,$.tZ)(re,{})]})}},82716:(e,t,n)=>{n.d(t,{Z:()=>l});var i=n(47746),a=n(86432);function l(){const e=(0,i.Z)(),t=(0,a.Z)(e.breakpoints.up("sm")),n=(0,a.Z)(e.breakpoints.up("md")),l=(0,a.Z)(e.breakpoints.up("lg"));return(0,a.Z)(e.breakpoints.up("xl"))?"xl":l?"lg":n?"md":t?"sm":"xs"}},10618:(e,t,n)=>{n.d(t,{X:()=>a});var i=n(41015);function a(e){return(t,n)=>{const a=t.length;return a===e.length?[n]:1===a&&t[0]===n?[...e]:[...new Set((0,i.nh)(t,n))]}}},1661:(e,t,n)=>{function i(e,t,n,i=[]){return(a,l)=>{for(const r of e){let e=0;const s=n[r],c=s(a),o=s(l);if(e="string"==typeof c&&"string"==typeof o?c.localeCompare(o):o-c,0!==e)return i.includes(r)?e:(t?-1:1)*e}return 0}}function a(e,t){return n=>Object.entries(e).every((([i,a])=>t[i]&&t[i](n,a,e)))}n.d(t,{C:()=>a,e:()=>i})}}]);